import{k as q,m as W,n as B}from"./chunk-XEFO2OX5.js";import{a as J}from"./chunk-WRZZAQTV.js";import{c as z,f as j,k as G,z as X}from"./chunk-AHXSH3AS.js";import{Ab as R,Bb as w,Ca as a,Da as _,E,Eb as N,Fb as V,Gb as y,Gf as te,H as M,Ib as x,Kb as D,Oa as g,Sa as m,Zc as H,ab as s,ad as U,ba as T,bb as p,c as b,cb as f,db as C,eb as I,gb as A,kg as Q,la as d,ma as h,ob as v,pb as S,pc as k,qc as $,rc as L,sa as O,yb as P,zb as F}from"./chunk-4A7FW7VV.js";import{g as ee,j as r}from"./chunk-K6ICEIKK.js";var Z=ee(te());var ie=o=>({"no-visible":o});function ne(o,t){if(o&1){let e=A();s(0,"button",11),v("click",function(){let n=d(e).$implicit,c=S(3);return h(c.onFilterClick(n));}),f(1,"my-global-icon",12),F(2),p();}if(o&2){let e=t.$implicit,i=S(3);a(),m("ngClass",D(2,ie,!i.isFilterEnabled(e))),a(),w(" ",e.label," ");}}function re(o,t){if(o&1&&(C(0),s(1,"h6",9),F(2),p(),g(3,ne,3,4,"button",10),I()),o&2){let e=t.$implicit;a(2),R(e.title),a(),m("ngForOf",e.children);}}function oe(o,t){if(o&1&&(C(0),f(1,"button",6),s(2,"div",7),g(3,re,4,2,"ng-container",8),p(),I()),o&2){let e=S();a(3),m("ngForOf",e.filters);}}var K=(0,Z.default)("peertube:AdvancedInputFilterComponent"),u=class u{constructor(t,e,i){this.route=t;this.restService=e;this.router=i;r(this,"filters",[]);r(this,"emitOnInit",!0);r(this,"search",new O());r(this,"searchValue");r(this,"enabledFilters",new Set());r(this,"searchStream");r(this,"viewInitialized",!1);r(this,"emitSearchAfterViewInit",!1);}ngOnInit(){this.initSearchStream(),this.listenToRouteSearchChange();}ngAfterViewInit(){this.viewInitialized=!0,this.emitOnInit&&this.emitSearchAfterViewInit&&this.emitSearch();}onInputSearch(t){this.scheduleSearchUpdate(t.target.value);}onResetTableFilter(){this.immediateSearchUpdate("");}hasFilters(){return this.filters&&this.filters.length!==0;}isFilterEnabled(t){return this.enabledFilters.has(t.value);}onFilterClick(t){let e=this.isFilterEnabled(t)?this.removeFilterToSearch(this.searchValue,t):this.addFilterToSearch(this.searchValue,t);this.router.navigate(["."],{relativeTo:this.route,queryParams:{search:e.trim()}});}scheduleSearchUpdate(t){this.searchValue=t,this.searchStream.next(this.searchValue);}immediateSearchUpdate(t){this.searchValue=t,this.setQueryParams(this.searchValue),this.parseFilters(this.searchValue),this.emitSearch();}listenToRouteSearchChange(){this.route.queryParams.subscribe(t=>{let e=t.search||"";K('On route search change "%s".',e),this.searchValue!==e&&(this.searchValue=e,this.parseFilters(this.searchValue),this.emitSearch());});}initSearchStream(){this.searchStream=new b(),this.searchStream.pipe(E(300),M()).subscribe(()=>{this.setQueryParams(this.searchValue),this.parseFilters(this.searchValue),this.emitSearch();});}emitSearch(){if(!this.viewInitialized){this.emitSearchAfterViewInit=!0;return;}K('On search "%s".',this.searchValue),this.search.emit(this.searchValue);}setQueryParams(t){let e={};t&&Object.assign(e,{search:t}),this.router.navigate([],{queryParams:e});}removeFilterToSearch(t,e){return t.replace(e.value,"");}addFilterToSearch(t,e){let i=e.value.split(":").shift(),n=this.restService.tokenizeString(t).filter(c=>!c.startsWith(i));return n.push(e.value),n.join(" ");}parseFilters(t){let e=this.restService.tokenizeString(t);this.enabledFilters=new Set();for(let i of this.filters)for(let n of i.children)e.includes(n.value)&&this.enabledFilters.add(n.value);}};r(u,"\u0275fac",function(e){return new(e||u)(_(H),_(Q),_(U));}),r(u,"\u0275cmp",T({type:u,selectors:[["my-advanced-input-filter"]],inputs:{filters:"filters",emitOnInit:"emitOnInit"},outputs:{search:"search"},standalone:!0,features:[x],decls:6,vars:2,consts:()=>{let t;t="Filter...";let e;e="Clear filter";let i;return i="Open quick filters",[["input",""],["ngbDropdown","","placement","bottom-left auto","container","body",1,"input-group","has-clear","flex-nowrap"],[4,"ngIf"],["type","text","name","table-filter","id","table-filter","placeholder",t,1,"last-in-group",3,"ngModelChange","keyup","ngModel"],["title",e,1,"p-0","border-0","form-control-clear",3,"click"],["iconName","cross"],["title",i,"ngbDropdownToggle","",1,"input-group-text","c-hand"],["role","menu","ngbDropdownMenu",""],[4,"ngFor","ngForOf"],[1,"dropdown-header"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],["iconName","tick",3,"ngClass"]];},template:function(e,i){if(e&1){let n=A();s(0,"div",1),g(1,oe,4,1,"ng-container",2),s(2,"input",3,0),y("ngModelChange",function(l){return d(n),V(i.searchValue,l)||(i.searchValue=l),h(l);}),v("keyup",function(l){return d(n),h(i.onInputSearch(l));}),p(),s(4,"button",4),v("click",function(){d(n);let l=P(3);return i.onResetTableFilter(),h(l.focus());}),f(5,"my-global-icon",5),p()();}e&2&&(a(),m("ngIf",i.hasFilters()),a(),N("ngModel",i.searchValue));},dependencies:[B,L,W,q,$,J,k,X,z,j,G],styles:[".input-group[_ngcontent-%COMP%]{width:fit-content}.dropdown-item[_ngcontent-%COMP%]{font-size:14px}input[_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:250px;max-width:250px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 290px){input[_ngcontent-%COMP%]{width:100%}}.input-group-text[_ngcontent-%COMP%]{background-color:transparent}.form-control-clear[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{display:block}.form-control-clear[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     svg{vertical-align:inherit}my-global-icon[_ngcontent-%COMP%]{opacity:1;width:19px;height:19px;margin-inline-end:.125rem}my-global-icon.no-visible[_ngcontent-%COMP%]{width:0;height:0;margin-inline-end:calc(1.25625rem + .075vw)}@media (min-width: 1200px){my-global-icon.no-visible[_ngcontent-%COMP%]{margin-inline-end:1.3125rem}}div[role=menu][_ngcontent-%COMP%]{max-height:50vh;overflow:auto}"]}));var Y=u;export{Y as a};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/