import{a as g,b as ae}from"./chunk-LRNUW7WF.js";import{d as _e}from"./chunk-5CNYD3QV.js";import{b as te,c as oe}from"./chunk-RZGVOE4L.js";import{A as ie,c as j,f as H,g as B,l as J,o as Q,r as W,w as Z,z as ee}from"./chunk-AHXSH3AS.js";import{Ab as q,Ca as m,Da as u,Ib as C,Kb as k,La as V,Oa as E,Qf as T,Sa as a,Vf as ne,Wb as X,Zc as z,ab as _,ba as p,bb as r,bd as w,cb as f,db as U,eb as F,fg as M,gb as $,hg as re,ib as G,jb as Y,kb as l,la as h,ma as L,ob as b,pb as d,pc as K,rc as A,yb as D,zb as x}from"./chunk-4A7FW7VV.js";import"./chunk-BERSDMCF.js";import"./chunk-ONF7AOBQ.js";import{j as o}from"./chunk-K6ICEIKK.js";var ue=t=>({"input-error":t});function Se(t,i){if(t&1&&(_(0,"div",13),x(1),r()),t&2){let e=d(2);m(),q(e.formErrors["verify-email-email"]);}}function Ee(t,i){if(t&1){let e=$();_(0,"form",7),b("ngSubmit",function(){h(e);let s=d();return L(s.askSendVerifyEmail());}),_(1,"div",8)(2,"label",9),l(3,2),r(),f(4,"input",10),E(5,Se,2,1,"div",11),r(),f(6,"input",12),r();}if(t&2){let e=d();a("formGroup",e.form),m(4),a("ngClass",k(4,ue,e.formErrors["verify-email-email"])),m(),a("ngIf",e.formErrors["verify-email-email"]),m(),a("disabled",!e.form.valid);}}function fe(t,i){t&1&&(_(0,"div"),l(1,3),r());}var I=class I extends oe{constructor(e,n,s,c,S){super();this.formReactiveService=e;this.signupService=n;this.serverService=s;this.notifier=c;this.redirectService=S;o(this,"requiresEmailVerification",!1);}ngOnInit(){this.serverService.getConfig().subscribe(e=>this.requiresEmailVerification=e.signup.requiresEmailVerification),this.buildForm({"verify-email-email":_e});}askSendVerifyEmail(){let e=this.form.value["verify-email-email"];this.signupService.askSendVerifyEmail(e).subscribe({next:()=>{this.notifier.success("\u8A8D\u8A3C\u30EA\u30F3\u30AF\u3092\u8A18\u8F09\u3057\u305F\u30E1\u30FC\u30EB\u304C"+e+"\u306B\u9001\u4FE1\u3055\u308C\u307E\u3059\u3002"),this.redirectService.redirectToHomepage();},error:n=>this.notifier.error(n.message)});}};o(I,"\u0275fac",function(n){return new(n||I)(u(te),u(g),u(T),u(M),u(ne));}),o(I,"\u0275cmp",p({type:I,selectors:[["my-verify-account-ask-send-email"]],standalone:!0,features:[V,C],decls:6,vars:2,consts:()=>{let e;e="\u30A2\u30AB\u30A6\u30F3\u30C8\u8A8D\u8A3C\u306E\u305F\u3081\u306E\u30E1\u30FC\u30EB\u3092\u30EA\u30AF\u30A8\u30B9\u30C8\u3059\u308B";let n;n="\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9";let s;s="\u8A8D\u8A3C\u30E1\u30FC\u30EB\u3092\u9001\u4FE1";let c;c="\u30E1\u30FC\u30EB";let S;return S="\u3053\u306E\u30A4\u30F3\u30B9\u30BF\u30F3\u30B9\u306FE\u30E1\u30FC\u30EB\u306B\u3088\u308B\u8A8D\u8A3C\u3092\u5FC5\u8981\u3068\u3057\u307E\u305B\u3093\u3002",[["emailVerificationNotRequired",""],e,c,S,[1,"margin-content"],[1,"title-page"],["role","form",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["role","form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","verify-email-email"],["type","email","id","verify-email-email","placeholder",n,"required","","formControlName","verify-email-email",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["type","submit","value",s,1,"peertube-button","orange-button",3,"disabled"],["role","alert",1,"form-error"]];},template:function(n,s){if(n&1&&(_(0,"div",4)(1,"h1",5),l(2,1),r(),E(3,Ee,7,6,"form",6)(4,fe,2,0,"ng-template",null,0,X),r()),n&2){let c=D(5);m(3),a("ngIf",s.requiresEmailVerification)("ngIfElse",c);}},dependencies:[A,ee,J,j,H,B,Z,ie,Q,W,K],styles:["input[type=email][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=email][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=email][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=email][_ngcontent-%COMP%]{width:100%}}"]}));var P=I;function de(t,i){t&1&&(U(0),_(1,"p"),l(2,1),r(),_(3,"p"),l(4,2),r(),F());}function pe(t,i){t&1&&(U(0),_(1,"p"),l(2,3),r(),_(3,"p"),G(4,4),f(5,"a",8),Y(),r(),F());}var N=class N{constructor(){o(this,"requiresApproval");}};o(N,"\u0275fac",function(e){return new(e||N)();}),o(N,"\u0275cmp",p({type:N,selectors:[["my-signup-success-after-email"]],inputs:{requiresApproval:"requiresApproval"},standalone:!0,features:[C],decls:6,vars:2,consts:()=>{let i;i="\u30E1\u30FC\u30EB\u304C\u8A8D\u8A3C\u3055\u308C\u307E\u3057\u305F!";let e;e="\u3042\u306A\u305F\u306E\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u304C\u8A8D\u8A3C\u3055\u308C\u3001\u30A2\u30AB\u30A6\u30F3\u30C8\u30EA\u30AF\u30A8\u30B9\u30C8\u304C\u9001\u4FE1\u3055\u308C\u307E\u3057\u305F!";let n;n="\u307E\u3082\u306A\u304F\u3001\u30E2\u30C7\u30EC\u30FC\u30BF\u30FC\u304C\u3042\u306A\u305F\u306E\u30A2\u30AB\u30A6\u30F3\u30C8\u767B\u9332\u30EA\u30AF\u30A8\u30B9\u30C8\u3092\u30C1\u30A7\u30C3\u30AF\u3057\u3001\u627F\u8A8D\u307E\u305F\u306F\u62D2\u5426\u3055\u308C\u305F\u5834\u5408\u306B\u306F\u30E1\u30FC\u30EB\u304C\u9001\u4FE1\u3055\u308C\u307E\u3059\u3002";let s;s="\u3042\u306A\u305F\u306E\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u304C\u8A8D\u8A3C\u3055\u308C\u3001\u30A2\u30AB\u30A6\u30F3\u30C8\u304C\u4F5C\u6210\u3055\u308C\u307E\u3057\u305F!";let c;return c="PeerTube\u3092\u5229\u7528\u3059\u308B\u969B\u306B\u30D8\u30EB\u30D7\u304C\u5FC5\u8981\u306A\u5834\u5408\u306F\u3001"+"\uFFFD#5\uFFFD"+"\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8"+"\uFFFD/#5\uFFFD"+"\u3092\u3054\u89A7\u304F\u3060\u3055\u3044\u3002 ",[i,e,n,s,c,["mascotImageName","success"],[1,"alert","pt-alert-primary"],[4,"ngIf"],["href","https://docs.joinpeertube.org/use/setup-account","target","_blank","rel","noopener noreferrer",1,"link-orange"]];},template:function(e,n){e&1&&(_(0,"my-signup-step-title",5)(1,"strong"),l(2,0),r()(),_(3,"div",6),E(4,de,5,0,"ng-container",7)(5,pe,6,0,"ng-container",7),r()),e&2&&(m(4),a("ngIf",n.requiresApproval),m(),a("ngIf",!n.requiresApproval));},dependencies:[ae,A],styles:[".alert[_ngcontent-%COMP%]{font-size:18px;max-width:900px;text-align:center;margin:auto}"]}));var O=N;function Ce(t,i){if(t&1&&f(0,"my-signup-success-after-email",10),t&2){let e=d(2);a("requiresApproval",e.isRegistrationRequest()&&e.requiresApproval);}}function Ae(t,i){t&1&&(_(0,"div",11),l(1,1),r());}function ge(t,i){t&1&&(_(0,"div",12)(1,"span"),l(2,2),r(),_(3,"a",13),l(4,3),r()());}function Ie(t,i){if(t&1&&(_(0,"div",5)(1,"h1",6),l(2,0),r(),E(3,Ce,1,1,"my-signup-success-after-email",7)(4,Ae,2,0,"div",8)(5,ge,5,0,"div",9),r()),t&2){let e=d();m(3),a("ngIf",e.displaySignupSuccess()),m(),a("ngIf",!e.isRegistrationRequest()&&e.isPendingEmail&&e.success),m(),a("ngIf",e.failed);}}var v=class v{constructor(i,e,n,s,c){this.signupService=i;this.server=e;this.authService=n;this.notifier=s;this.route=c;o(this,"success",!1);o(this,"failed",!1);o(this,"isPendingEmail",!1);o(this,"requiresApproval");o(this,"loaded",!1);o(this,"userId");o(this,"registrationId");o(this,"verificationString");}get instanceName(){return this.server.getHTMLConfig().instance.name;}ngOnInit(){let i=this.route.snapshot.queryParams;if(this.server.getConfig().subscribe(e=>{this.requiresApproval=e.signup.requiresApproval,this.loaded=!0;}),this.userId=i.userId,this.registrationId=i.registrationId,this.verificationString=i.verificationString,this.isPendingEmail=i.isPendingEmail==="true",!this.verificationString){this.notifier.error("URL\u30AF\u30A8\u30EA\u5185\u306B\u8A8D\u8A3C\u6587\u5B57\u5217\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F\u3002");return;}if(!this.userId&&!this.registrationId){this.notifier.error("URL\u30AF\u30A8\u30EA\u5185\u306B\u30E6\u30FC\u30B6\u30FCID\u307E\u305F\u306F\u767B\u9332ID\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F\u3002");return;}this.verifyEmail();}isRegistrationRequest(){return!!this.registrationId;}displaySignupSuccess(){return!(!this.success||!this.isRegistrationRequest()&&this.isPendingEmail);}verifyEmail(){return this.isRegistrationRequest()?this.verifyRegistrationEmail():this.verifyUserEmail();}verifyUserEmail(){let i={userId:this.userId,verificationString:this.verificationString,isPendingEmail:this.isPendingEmail};this.signupService.verifyUserEmail(i).subscribe({next:()=>{this.authService.isLoggedIn()&&this.authService.refreshUserInformation(),this.success=!0;},error:e=>{this.failed=!0,this.notifier.error(e.message);}});}verifyRegistrationEmail(){let i={registrationId:this.registrationId,verificationString:this.verificationString};this.signupService.verifyRegistrationEmail(i).subscribe({next:()=>{this.success=!0;},error:e=>{this.failed=!0,this.notifier.error(e.message);}});}};o(v,"\u0275fac",function(e){return new(e||v)(u(g),u(T),u(re),u(M),u(z));}),o(v,"\u0275cmp",p({type:v,selectors:[["my-verify-account-email"]],standalone:!0,features:[C],decls:1,vars:1,consts:()=>{let i;i="\u30E1\u30FC\u30EB\u3092\u8A8D\u8A3C\u3059\u308B";let e;e="\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u3092\u66F4\u65B0\u3057\u307E\u3057\u305F\u3002";let n;n="\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F\u3002";let s;return s="\u65B0\u3057\u3044\u8A8D\u8A3C\u30E1\u30FC\u30EB\u3092\u30EA\u30AF\u30A8\u30B9\u30C8",[i,e,n,s,["class","margin-content",4,"ngIf"],[1,"margin-content"],[1,"title-page"],[3,"requiresApproval",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[3,"requiresApproval"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["routerLink","/verify-account/ask-send-email",1,"ms-1","link-orange"]];},template:function(e,n){e&1&&E(0,Ie,6,3,"div",4),e&2&&a("ngIf",n.loaded);},dependencies:[A,O,w],encapsulation:2}));var y=v;var Ke=[{path:"",providers:[g],children:[{path:"email",component:y,data:{meta:{title:"\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u306B\u3088\u308B\u30A2\u30AB\u30A6\u30F3\u30C8\u306E\u8A8D\u8A3C"}}},{path:"ask-send-email",component:P,data:{meta:{title:"\u30A2\u30AB\u30A6\u30F3\u30C8\u3092\u8A8D\u8A3C\u3059\u308B\u305F\u3081\u306E\u30E1\u30FC\u30EB\u9001\u4FE1\u3092\u30EA\u30AF\u30A8\u30B9\u30C8"}}}]}];export{Ke as default};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/