import{a as to}from"./chunk-X5HB26GE.js";import"./chunk-SPKU4WOP.js";import{a as Z}from"./chunk-EBTUWTIZ.js";import{a as oo}from"./chunk-FAZZDQFH.js";import"./chunk-UDQ7P63C.js";import"./chunk-6C7DPHTS.js";import"./chunk-7HXKHM3O.js";import"./chunk-4XL6BJ7M.js";import"./chunk-DPQ4XGHN.js";import{A as B,z as Q}from"./chunk-XEFO2OX5.js";import{a as Y}from"./chunk-WRZZAQTV.js";import"./chunk-AHXSH3AS.js";import{Ab as L,Ca as p,Cc as X,Da as C,Ib as $,Kb as V,Lb as U,Oa as _,Sa as c,Vc as z,Wb as h,Xf as J,ab as r,ad as D,ba as E,bb as s,bd as q,c as T,cb as g,cd as H,fb as M,fg as K,gb as b,kb as O,la as d,ma as m,ob as u,og as W,pb as f,pc as F,rc as j,sa as k,vb as w,wb as A,wc as G,x as I,xb as R,yb as v,zb as P}from"./chunk-4A7FW7VV.js";import"./chunk-BERSDMCF.js";import"./chunk-ONF7AOBQ.js";import{j as l,k as y}from"./chunk-K6ICEIKK.js";var eo=["popover"],io=(t,n)=>({"notification-inbox-popover":!0,shown:t,hidden:n}),ro=t=>({loaded:t});function ao(t,n){if(t&1&&(r(0,"div",13),P(1),s()),t&2){let o=f(2);p(),L(o.unreadNotifications);}}function co(t,n){t&1&&(r(0,"div",13),P(1,"99+"),s());}function po(t,n){if(t&1&&_(0,ao,2,1,"div",12)(1,co,2,0,"div",12),t&2){let o=f();c("ngIf",o.unreadNotifications>0&&o.unreadNotifications<100),p(),c("ngIf",o.unreadNotifications>=100);}}function so(t,n){t&1&&M(0);}function lo(t,n){t&1&&M(0);}function fo(t,n){if(t&1){let o=b();r(0,"div",14),_(1,lo,1,0,"ng-container",9),r(2,"a",15,3),u("click",function(){d(o);let e=v(3),a=f();return m(a.onNavigate(e));}),g(4,"my-global-icon",10),s()();}if(t&2){f();let o=v(1);p(),c("ngTemplateOutlet",o);}}function _o(t,n){if(t&1){let o=b();r(0,"button",24),u("click",function(){d(o);let e=f(2);return m(e.markAllAsRead());}),g(1,"my-global-icon",25),s();}}function mo(t,n){if(t&1&&(r(0,"div",26),g(1,"my-loader",27),s()),t&2){let o=f(2);p(),c("loading",!o.loaded);}}function go(t,n){if(t&1){let o=b();r(0,"a",28,5),u("click",function(){d(o);let e=v(1),a=f(2);return m(a.onNavigate(e));}),g(2,"my-global-icon",29),r(3,"span"),O(4,7),s()();}}function uo(t,n){if(t&1){let o=b();r(0,"div",16)(1,"div",17)(2,"div"),O(3,6),s(),r(4,"div"),_(5,_o,2,0,"button",18),r(6,"a",19,4),u("click",function(){d(o);let e=v(7),a=f();return m(a.onNavigate(e));}),g(8,"my-global-icon",20),s()()(),_(9,mo,2,1,"div",21),r(10,"my-user-notifications",22),u("notificationsLoaded",function(){d(o);let e=f();return m(e.onNotificationLoaded());}),s(),_(11,go,5,0,"a",23),s();}if(t&2){let o=f();c("ngClass",V(8,ro,o.loaded)),p(5),c("ngIf",o.unreadNotifications),p(4),c("ngIf",!o.loaded),p(),c("ignoreLoadingBar",!0)("infiniteScroll",!1)("itemsPerPage",10)("markAllAsReadSubject",o.markAllAsReadSubject),p(),c("ngIf",o.loaded);}}var x=class x{constructor(n,o,i,e,a){this.userNotificationService=n;this.screenService=o;this.peertubeSocket=i;this.notifier=e;this.router=a;l(this,"popover");l(this,"navigate",new k());l(this,"unreadNotifications",0);l(this,"loaded",!1);l(this,"opened",!1);l(this,"markAllAsReadSubject",new T());l(this,"notificationSub");l(this,"routeSub");}ngOnInit(){this.userNotificationService.countUnreadNotifications().subscribe({next:n=>{this.unreadNotifications=n,this.subscribeToNotifications();},error:n=>this.notifier.error(n.message)}),this.routeSub=this.router.events.pipe(I(n=>n instanceof z)).subscribe(()=>this.closePopover());}ngOnDestroy(){this.notificationSub&&this.notificationSub.unsubscribe(),this.routeSub&&this.routeSub.unsubscribe();}get isInMobileView(){return this.screenService.isInMobileView();}closePopover(){this.popover.close();}onPopoverShown(){this.opened=!0,document.querySelector("nav").scrollTo(0,0),document.querySelector("nav").addEventListener("scroll",this.onMenuScrollEvent);}onPopoverHidden(){this.loaded=!1,this.opened=!1,document.querySelector("nav").removeEventListener("scroll",this.onMenuScrollEvent);}onMenuScrollEvent(){document.querySelector("nav").scrollTo(0,0);}onNotificationLoaded(){this.loaded=!0;}onNavigate(n){this.closePopover(),this.navigate.emit(n);}markAllAsRead(){this.markAllAsReadSubject.next(!0);}subscribeToNotifications(){return y(this,null,function*(){let n=yield this.peertubeSocket.getMyNotificationsSocket();this.notificationSub=n.subscribe(o=>{if(o.type==="new")return this.unreadNotifications++;if(o.type==="read")return this.unreadNotifications--;if(o.type==="read-all")return this.unreadNotifications=0;});});}};l(x,"\u0275fac",function(o){return new(o||x)(C(oo),C(J),C(W),C(K),C(D));}),l(x,"\u0275cmp",E({type:x,selectors:[["my-notification"]],viewQuery:function(o,i){if(o&1&&w(eo,7),o&2){let e;A(e=R())&&(i.popover=e.first);}},outputs:{navigate:"navigate"},standalone:!0,features:[$],decls:9,vars:7,consts:()=>{let n;n="Zeige ihre Benachrichtigungen";let o;o="Zeige ihre Benachrichtigungen";let i;i="Als gelesen markieren";let e;e="Aktualisiere deine Benachrichtigungseinstellungen";let a;a="Benachrichtigungen";let S;return S="Alle deine Benachrichtigungen anzeigen",[["notificationNumber",""],["popover","ngbPopover"],["popContent",""],["link",""],["settingsNotifications",""],["notifications",""],a,S,["autoClose","outside","placement","bottom","container","body","popoverClass","popover-notifications","title",n,1,"border-0","text-start",3,"shown","hidden","ngbPopover","ngClass"],[4,"ngTemplateOutlet"],["iconName","bell"],["title",o,"class","notification-inbox-link",4,"ngIf"],["class","unread-notifications",4,"ngIf"],[1,"unread-notifications"],["title",o,1,"notification-inbox-link"],["routerLink","/my-account/notifications","routerLinkActive","active",3,"click"],[1,"content",3,"ngClass"],[1,"notifications-header"],["title",i,"class","me-2",3,"click",4,"ngIf"],["title",e,"routerLink","/my-account/settings","fragment","notifications",3,"click"],["iconName","cog"],["class","loader mt-4",4,"ngIf"],[3,"notificationsLoaded","ignoreLoadingBar","infiniteScroll","itemsPerPage","markAllAsReadSubject"],["class","all-notifications","routerLink","/my-account/notifications",3,"click",4,"ngIf"],["title",i,1,"me-2",3,"click"],["iconName","tick"],[1,"loader","mt-4"],["size","xl",3,"loading"],["routerLink","/my-account/notifications",1,"all-notifications",3,"click"],["iconName","bell","aria-hidden","true",1,"me-1"]];},template:function(o,i){if(o&1){let e=b();_(0,po,2,2,"ng-template",null,0,h),r(2,"button",8,1),u("shown",function(){return d(e),m(i.onPopoverShown());})("hidden",function(){return d(e),m(i.onPopoverHidden());}),_(4,so,1,0,"ng-container",9),g(5,"my-global-icon",10),s(),_(6,fo,5,1,"div",11)(7,uo,12,10,"ng-template",null,2,h);}if(o&2){let e=v(1),a=v(8);p(2),c("ngbPopover",a)("ngClass",U(4,io,i.opened,i.isInMobileView)),p(2),c("ngTemplateOutlet",e),p(2),c("ngIf",i.isInMobileView);}},dependencies:[X,F,j,G,B,Q,to,Y,Z,q,H],styles:[".content[_ngcontent-%COMP%]{scrollbar-color:auto}.notification-inbox-popover[_ngcontent-%COMP%]{padding:10px}.notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:13px 10px}.notification-inbox-popover[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition:all .1s ease-in-out;border-radius:25px;cursor:pointer}.notification-inbox-popover[_ngcontent-%COMP%]     .feather, .notification-inbox-popover[_ngcontent-%COMP%]     .material, .notification-inbox-popover[_ngcontent-%COMP%]     .misc, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     .feather, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     .material, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     .misc{color:gray}.notification-inbox-popover[_ngcontent-%COMP%]     svg, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]     svg{transition:color .1s ease-in-out}.notification-inbox-popover[_ngcontent-%COMP%]:hover, .notification-inbox-popover[_ngcontent-%COMP%]:active, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{background-color:#ffffff26}.notification-inbox-popover[_ngcontent-%COMP%]:hover     .feather, .notification-inbox-popover[_ngcontent-%COMP%]:hover     .material, .notification-inbox-popover[_ngcontent-%COMP%]:hover     .misc, .notification-inbox-popover[_ngcontent-%COMP%]:active     .feather, .notification-inbox-popover[_ngcontent-%COMP%]:active     .material, .notification-inbox-popover[_ngcontent-%COMP%]:active     .misc, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover     .feather, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover     .material, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover     .misc, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active     .feather, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active     .material, .notification-inbox-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active     .misc{color:#fff}.notification-inbox-popover.shown[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#ffffff47;box-shadow:inset 0 3px 5px #00000053}.notification-inbox-popover.shown[_ngcontent-%COMP%]     .feather, .notification-inbox-popover.shown[_ngcontent-%COMP%]     .material, .notification-inbox-popover.shown[_ngcontent-%COMP%]     .misc, .notification-inbox-link[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]     .feather, .notification-inbox-link[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]     .material, .notification-inbox-link[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]     .misc{color:#fff}.notification-inbox-popover.hidden[_ngcontent-%COMP%]{display:none}  .popover-notifications.popover{max-width:none;top:-6px!important;left:7px!important}  .popover-notifications.popover .arrow{display:none}  .popover-notifications.popover .popover-body{padding:0;font-size:14px;font-family:Source Sans Pro,sans-serif;width:400px;box-shadow:0 2px 6px #0000004d}  .popover-notifications.popover .popover-body .loader{display:flex;align-items:center;justify-content:center;padding:5px 0}  .popover-notifications.popover .popover-body .content{max-height:150px;transition:max-height .15s ease-out;display:flex;height:500px;flex-direction:column}  .popover-notifications.popover .popover-body .content.loaded{max-height:500px}  .popover-notifications.popover .popover-body .content>my-user-notifications:nth-child(2){overflow-y:auto;flex-grow:1}  .popover-notifications.popover .popover-body .notifications-header{display:flex;justify-content:space-between;border-bottom:1px solid rgba(0,0,0,.1);align-items:center;padding:0 12px;font-size:14px;font-weight:700;color:#00000080;text-transform:uppercase;min-height:40px}  .popover-notifications.popover .popover-body .notifications-header a:hover,   .popover-notifications.popover .popover-body .notifications-header a:focus,   .popover-notifications.popover .popover-body .notifications-header a:active{text-decoration:none!important}  .popover-notifications.popover .popover-body .notifications-header a:focus:not(:focus-visible){outline:none!important}  .popover-notifications.popover .popover-body .notifications-header button{background:transparent;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}  .popover-notifications.popover .popover-body .notifications-header button my-global-icon+*{margin-inline-end:.25rem;margin-inline-start:.25rem}  .popover-notifications.popover .popover-body .notifications-header a,   .popover-notifications.popover .popover-body .notifications-header button{color:#14141480}  .popover-notifications.popover .popover-body .notifications-header a:hover:not(:disabled),   .popover-notifications.popover .popover-body .notifications-header button:hover:not(:disabled){color:#141414cc}  .popover-notifications.popover .popover-body .notifications-header my-global-icon[iconName=cog]{width:20px}  .popover-notifications.popover .popover-body .notifications-header my-global-icon[iconName=tick]{width:26px}  .popover-notifications.popover .popover-body .all-notifications{display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--mainForegroundColor);padding:7px 0;margin-top:auto;text-decoration:none}.notification-inbox-popover[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]{cursor:pointer;position:relative}.notification-inbox-popover[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%]{margin-inline-start:1.25rem}.notification-inbox-popover[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%]{position:absolute;top:6px;left:0;display:flex;align-items:center;justify-content:center;background-color:var(--mainColor);color:#fff;font-size:10px;font-weight:600;border-radius:15px;width:15px;height:15px}@media screen and (max-width: 500px){.notification-inbox-popover[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%], .notification-inbox-link[_ngcontent-%COMP%]   .unread-notifications[_ngcontent-%COMP%]{top:-4px;left:-2px}}"]}));var no=x;export{no as NotificationComponent};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/