import{a as m,b as p}from"./chunk-VYZQNJAY.js";import{$ as g,Gf as O,K as d,Y as u,b as c,c as b,hf as v,m as o,x as h}from"./chunk-4A7FW7VV.js";import{g as B,j as a}from"./chunk-K6ICEIKK.js";var k=B(O());var n=(0,k.default)("peertube:search:FindInBulkService"),i=class i{constructor(e){this.searchService=e;a(this,"advancedSearchForBulk");a(this,"getVideoInBulk");a(this,"getChannelInBulk");a(this,"getPlaylistInBulk");this.getVideoInBulk=this.buildBulkObservableObject(this.getVideosInBulk.bind(this)),this.getChannelInBulk=this.buildBulkObservableObject(this.getChannelsInBulk.bind(this)),this.getPlaylistInBulk=this.buildBulkObservableObject(this.getPlaylistsInBulk.bind(this)),this.advancedSearchForBulk=new m({searchTarget:"local"});}getVideo(e){return n("Schedule video fetch for uuid %s.",e),this.getData({observableObject:this.getVideoInBulk,finder:t=>t.uuid===e||t.shortUUID===e,param:e});}getChannel(e){return n("Schedule channel fetch for handle %s.",e),this.getData({observableObject:this.getChannelInBulk,finder:t=>t.nameWithHost===e||t.nameWithHostForced===e,param:e});}getPlaylist(e){return n("Schedule playlist fetch for uuid %s.",e),this.getData({observableObject:this.getPlaylistInBulk,finder:t=>t.uuid===e||t.shortUUID===e,param:e});}getData(e){let{observableObject:t,param:l,finder:P}=e;return new c(s=>{t.result.pipe(h(r=>r.params.includes(l)),d(),o(r=>r.response.data),o(r=>r.find(P))).subscribe({next:r=>{if(!r){s.error(new Error("\u0644\u0645 \u064A\u064F\u0639\u062B\u0631 \u0639\u0644\u0649 \u0627\u0644\u0639\u0646\u0635\u0631 "+l+""));return;}s.next(r),s.complete();},error:r=>s.error(r)}),t.notifier.next(l);});}getVideosInBulk(e){return n("Fetching videos %s.",e.join(", ")),this.searchService.searchVideos({uuids:e,componentPagination:{itemsPerPage:e.length,currentPage:1},skipCount:!0,advancedSearch:this.advancedSearchForBulk});}getChannelsInBulk(e){return n("Fetching channels %s.",e.join(", ")),this.searchService.searchVideoChannels({handles:e,componentPagination:{itemsPerPage:e.length,currentPage:1},advancedSearch:this.advancedSearchForBulk});}getPlaylistsInBulk(e){return n("Fetching playlists %s.",e.join(", ")),this.searchService.searchVideoPlaylists({uuids:e,componentPagination:{itemsPerPage:e.length,currentPage:1},advancedSearch:this.advancedSearchForBulk});}buildBulkObservableObject(e){let t=new b();return{notifier:t,result:v({time:100,bulkGet:e,notifierObservable:t.asObservable()})};}};a(i,"\u0275fac",function(t){return new(t||i)(g(p));}),a(i,"\u0275prov",u({token:i,factory:i.Éµfac}));var f=i;export{f as a};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/