import{a as Y_}from"./chunk-VTUTDAHH.js";import{a as q_}from"./chunk-LOVXD4GQ.js";import{a as jt,b as il,c as rl}from"./chunk-P22RIXDF.js";import{a as tl}from"./chunk-AV5N3MGJ.js";import{a as V_}from"./chunk-OANTFZ4P.js";import{a as Pn}from"./chunk-EL2IVBTL.js";import{a as K_}from"./chunk-SESCJUR7.js";import{a as w_,b as Hn}from"./chunk-ZM5RL52X.js";import{a as U_}from"./chunk-RC6ZHZJX.js";import{b as G_}from"./chunk-VYZQNJAY.js";import{a as z_,b as X_,c as W_,d as j_,e as H_,f as J_,g as ol,h as yi}from"./chunk-HSMLP335.js";import{d as B_}from"./chunk-XGXRY5NY.js";import{c as Kn}from"./chunk-IA75VPMY.js";import{a as nl}from"./chunk-OOKZXLTV.js";import{a as Jn}from"./chunk-RY6C3VVE.js";import{g as Z_,h as el}from"./chunk-AJL6C324.js";import{a as Nn}from"./chunk-D3FHDE3Z.js";import{a as Wn}from"./chunk-JKIUJPUH.js";import"./chunk-7AYEGJPF.js";import{c as D_,k as x_}from"./chunk-RXO3LGSG.js";import"./chunk-PZG7XDNU.js";import"./chunk-CF2PRKCK.js";import{b as y_}from"./chunk-F4NNW7U6.js";import"./chunk-AJTAIDL7.js";import{a as Ue,b as Di,c as Mt,h as be,i as Fe,j as he,k as tn,l as ft,m as k_,n as Lt,o as $t,p as ve,q as Q_}from"./chunk-VPUMNBNK.js";import"./chunk-XIGDB2RN.js";import{a as tt,e as v_,f as jn,g as Fi}from"./chunk-FDM4WNGU.js";import"./chunk-24QQSIIJ.js";import{a as Ri}from"./chunk-FCT3LKDI.js";import{a as Tt}from"./chunk-K67EGD4G.js";import{a as fn}from"./chunk-3NN6IC32.js";import{a as bi}from"./chunk-UOVZQ5E7.js";import"./chunk-NAT3JZF7.js";import{a as nt}from"./chunk-LQ3CTFST.js";import{a as Mi}from"./chunk-SPKU4WOP.js";import{a as dt}from"./chunk-JPIRBOZL.js";import"./chunk-EBTUWTIZ.js";import{a as R_}from"./chunk-KOE64Z5J.js";import{a as vi}from"./chunk-HR2BZ37A.js";import{a as Ni}from"./chunk-XLVZGSUB.js";import{a as L_,b as hi}from"./chunk-RVLWM6RI.js";import"./chunk-73DTZG4O.js";import{a as $_}from"./chunk-CVTLOUPO.js";import"./chunk-FOKVUJB6.js";import"./chunk-LUFSC2DY.js";import{c as Ti,d as Ii,e as Oi}from"./chunk-CNM6TRJ3.js";import"./chunk-X6JWC5WV.js";import{c as Mn}from"./chunk-GP5LX4CA.js";import{a as et}from"./chunk-4V7EB4W6.js";import{a as Dt,b as en}from"./chunk-KG4UYECH.js";import{a as Ci,b as Si}from"./chunk-NO6VG5DO.js";import"./chunk-UDQ7P63C.js";import"./chunk-6C7DPHTS.js";import"./chunk-7HXKHM3O.js";import"./chunk-4XL6BJ7M.js";import{a as Ei}from"./chunk-GOWSOB6U.js";import"./chunk-RBCGTDIC.js";import"./chunk-DPQ4XGHN.js";import{B as $e,i as __,k as l_,m as s_,n as c_,r as di,t as d_,u as p_,v as m_,w as u_,x as g_,y as C_}from"./chunk-XEFO2OX5.js";import{a as de}from"./chunk-WRZZAQTV.js";import{b as b_,c as F_,d as fi,h as Pi,i as h_,k as Xn,l as Bn,m as Ai}from"./chunk-5CNYD3QV.js";import{b as Nt,c as yt}from"./chunk-RZGVOE4L.js";import{A as Pe,a as qa,c as Ve,d as se,f as Se,g as Me,k as At,l as Ot,m as En,o as fe,p as Rt,r as ke,s as bt,t as Ft,u as ht,v as li,z as ce}from"./chunk-AHXSH3AS.js";import{$ as Ee,$a as za,Ab as I,Ae as a_,Af as E_,B as ge,Bb as w,Be as Or,C as Yo,Ca as a,Cb as _n,Cf as T_,D as qo,Da as T,E as ya,Eb as Te,Ed as Za,Fb as Ie,Gb as Oe,Gc as Et,H as La,Hb as Ba,Ib as v,J as $a,Jb as Pt,Jf as I_,Kb as X,Kc as lt,Kd as Fn,Kf as O_,L as xa,La as ne,Lb as Wa,Ld as Tn,Md as ci,Na as wa,Nb as ja,Nd as e_,Ne as Ae,Nf as N_,Oa as u,Oe as Re,Of as xe,Pd as ei,Qf as Ge,R as wn,Ra as It,Rd as t_,Re as In,Sa as l,Sb as ie,Tb as Ha,Te as kn,Tf as mi,Ub as _e,Ue as _t,Va as Sr,Wb as Sn,X as Ga,Xf as zn,Y as qe,Ya as Bt,Ye as me,Yf as M_,Za as Va,Zc as Qe,_a as ka,_c as Ka,ab as i,ad as Ze,af as S_,ba as h,bb as o,bc as Ja,bd as Le,bf as pi,c as Jo,cb as m,cd as Ya,da as Ua,db as S,eb as E,eg as De,fb as Er,fg as K,gb as k,gg as ct,hg as Zt,i as Ko,ib as D,ig as ui,jb as y,jd as Qa,je as n_,jg as ze,ka as gn,kb as s,ke as o_,kg as vt,la as P,lb as W,m as Xt,ma as A,mb as j,md as bn,me as i_,nb as Ce,oa as Vn,ob as M,pb as p,pc as le,pd as Qt,qb as Xa,qc as Ne,qd as st,qe as ti,qg as gi,r as Un,rb as Tr,rc as B,rg as On,sa as ai,sb as qt,sg as f_,td as Qo,tf as Nr,ud as Zo,ug as P_,vb as gt,vg as A_,wb as Ct,wc as _i,xb as St,xd as Q,xf as Mr,ya as an,yb as Cn,yc as ye,yd as Wt,ye as r_,za as Xe,zb as C,zd as si,ze as Ir}from"./chunk-4A7FW7VV.js";import"./chunk-BERSDMCF.js";import"./chunk-ONF7AOBQ.js";import{a as zt,b as Yt,j as c,k as pe}from"./chunk-K6ICEIKK.js";var Yn=n=>({"input-error":n});function Xl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.cache.previews.size);}}function Bl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.cache.captions.size);}}function Wl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.cache.torrents.size);}}function jl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.cache.storyboards.size);}}function Hl(n,r){n&1&&(S(0),D(1,13),m(2,"p",44)(3,"pre"),y(),E());}function Jl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.customizations.javascript);}}function Kl(n,r){n&1&&(S(0),D(1,14),m(2,"p",44)(3,"pre"),i(4,"p",44),m(5,"em"),o(),m(6,"pre"),y(),E()),n&2&&(a(6),W("{")("}")("{")("}"),j(1));}function Yl(n,r){if(n&1&&(i(0,"div",43),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.customizations.css);}}var qn=class qn{constructor(){c(this,"form");c(this,"formErrors");}getCacheSize(r){return this.form.value.cache[r].size;}};c(qn,"\u0275fac",function(e){return new(e||qn)();}),c(qn,"\u0275cmp",h({type:qn,selectors:[["my-edit-advanced-configuration"]],inputs:{form:"form",formErrors:"formErrors"},standalone:!0,features:[v],decls:65,vars:29,consts:()=>{let r;r="\u5FEB\u53D6";let e;e="\u90E8\u4EFD\u6A94\u6848\u672A\u806F\u76DF\uFF0C\u4E26\u6703\u5728\u9700\u8981\u6642\u64F7\u53D6\u3002\u5B9A\u7FA9\u5B83\u5011\u7684\u5FEB\u53D6\u7B56\u7565\u3002";let t;t="\u8981\u4FDD\u7559\u5728\u5FEB\u53D6\u4E2D\u7684\u9810\u89BD\u6578\u91CF";let _;_="{VAR_PLURAL, plural, =1 {\u5DF2\u5FEB\u53D6\u5716\u7247} other {\u5DF2\u5FEB\u53D6\u5716\u7247}}",_=Ce(_,{VAR_PLURAL:"\uFFFD0\uFFFD"});let d;d="\u8981\u4FDD\u7559\u5728\u5FEB\u53D6\u4E2D\u7684\u5F71\u7247\u5B57\u5E55\u6578\u91CF";let g;g="{VAR_PLURAL, plural, =1 {\u5DF2\u5FEB\u53D6\u5B57\u5E55} other {\u5DF2\u5FEB\u53D6\u5B57\u5E55}}",g=Ce(g,{VAR_PLURAL:"\uFFFD0\uFFFD"});let O;O="\u8981\u4FDD\u7559\u5728\u5FEB\u53D6\u4E2D\u7684\u5F71\u7247 torrent \u6578\u91CF";let R;R="{VAR_PLURAL, plural, =1 {\u5DF2\u5FEB\u53D6\u7684 torrent} other {\u5DF2\u5FEB\u53D6\u7684 torrents}}",R=Ce(R,{VAR_PLURAL:"\uFFFD0\uFFFD"});let N;N="\u8981\u4FDD\u7559\u5728\u5FEB\u53D6\u4E2D\u7684\u5F71\u7247\u6545\u4E8B\u677F\u7684\u6578\u91CF";let b;b="{VAR_PLURAL, plural, =1 {\u5FEB\u53D6\u7684\u6545\u4E8B\u677F} other {\u5FEB\u53D6\u7684\u6545\u4E8B\u677F}}",b=Ce(b,{VAR_PLURAL:"\uFFFD0\uFFFD"});let G;G="\u81EA\u8A02";let F;F="\u5728\u5EFA\u7ACB\u5916\u639B\u7A0B\u5F0F\u6216\u4F48\u666F\u4E3B\u984C\u592A\u9EBB\u7169\u6642\u5C0D\u60A8\u7684 PeerTube \u7AD9\u53F0\u9032\u884C\u5C11\u91CF\u4FEE\u6539\u3002";let L;L="JavaScript";let $;$=""+"\uFFFD#2\uFFFD"+"\u76F4\u63A5\u7DE8\u5BEB JavaScript \u7A0B\u5F0F\u78BC\u3002\u7BC4\u4F8B\uFF1A"+"\uFFFD/#2\uFFFD"+""+"\uFFFD#3\uFFFD"+"console.log('my instance is amazing');"+"\uFFFD/#3\uFFFD"+"";let H;return H=""+"[\uFFFD#2\uFFFD|\uFFFD#4\uFFFD]"+"\u76F4\u63A5\u7DE8\u5BEB CSS \u7A0B\u5F0F\u78BC\u3002\u7BC4\u4F8B\uFF1A"+"[\uFFFD/#2\uFFFD|\uFFFD/#4\uFFFD]"+""+"[\uFFFD#3\uFFFD|\uFFFD#6\uFFFD]"+"#custom-css "+"[\uFFFD0\uFFFD|\uFFFD2\uFFFD]"+" color: red; "+"[\uFFFD1\uFFFD|\uFFFD3\uFFFD]"+" "+"[\uFFFD/#3\uFFFD|\uFFFD/#6\uFFFD]"+""+"[\uFFFD#2\uFFFD|\uFFFD#4\uFFFD]"+"\u5728\u524D\u9762\u9644\u52A0 "+"\uFFFD#5\uFFFD"+"#custom-css"+"\uFFFD/#5\uFFFD"+" \u4EE5\u8986\u5BEB\u6A23\u5F0F\u3002\u7BC4\u4F8B\uFF1A"+"[\uFFFD/#2\uFFFD|\uFFFD/#4\uFFFD]"+""+"[\uFFFD#3\uFFFD|\uFFFD#6\uFFFD]"+"#custom-css .logged-in-email "+"[\uFFFD0\uFFFD|\uFFFD2\uFFFD]"+" color: red; "+"[\uFFFD1\uFFFD|\uFFFD3\uFFFD]"+" "+"[\uFFFD/#3\uFFFD|\uFFFD/#6\uFFFD]"+"",H=Ce(H),[r,e,t,_,d,g,O,R,N,b,G,F,L,$,H,[3,"formGroup"],[1,"pt-two-cols","mt-5"],[1,"title-col"],[1,"inner-form-description"],[1,"content-col"],["formGroupName","cache"],["formGroupName","previews",1,"form-group"],["for","cachePreviewsSize"],[1,"number-with-unit"],["type","number","min","0","id","cachePreviewsSize","formControlName","size",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["formGroupName","captions",1,"form-group"],["for","cacheCaptionsSize"],["type","number","min","0","id","cacheCaptionsSize","formControlName","size",1,"form-control",3,"ngClass"],["formGroupName","torrents",1,"form-group"],["for","cacheTorrentsSize"],["type","number","min","0","id","cacheTorrentsSize","formControlName","size",1,"form-control",3,"ngClass"],["type","number","min","0","id","cacheStoryboardsSize","formControlName","size",1,"form-control",3,"ngClass"],[1,"pt-two-cols","mt-4"],["id","customizations",1,"anchor"],["formGroupName","instance"],["formGroupName","customizations"],[1,"form-group"],["for","customizationJavascript"],["ptTemplate","customHtml"],["id","customizationJavascript","formControlName","javascript","dir","ltr",1,"form-control",3,"ngClass"],["for","customizationCSS"],["id","customizationCSS","formControlName","css","dir","ltr",1,"form-control",3,"ngClass"],["role","alert",1,"form-error"],[1,"mb-2"]];},template:function(e,t){e&1&&(S(0,15),i(1,"div",16)(2,"div",17)(3,"h2"),s(4,0),o(),i(5,"div",18),s(6,1),o()(),i(7,"div",19),S(8,20),i(9,"div",21)(10,"label",22),s(11,2),o(),i(12,"div",23),m(13,"input",24),i(14,"span"),s(15,3),o()(),u(16,Xl,2,1,"div",25),o(),i(17,"div",26)(18,"label",27),s(19,4),o(),i(20,"div",23),m(21,"input",28),i(22,"span"),s(23,5),o()(),u(24,Bl,2,1,"div",25),o(),i(25,"div",29)(26,"label",30),s(27,6),o(),i(28,"div",23),m(29,"input",31),i(30,"span"),s(31,7),o()(),u(32,Wl,2,1,"div",25),o(),i(33,"div",29)(34,"label",30),s(35,8),o(),i(36,"div",23),m(37,"input",32),i(38,"span"),s(39,9),o()(),u(40,jl,2,1,"div",25),o(),E(),o()(),i(41,"div",33)(42,"div",17),m(43,"div",34),i(44,"h2"),s(45,10),o(),i(46,"div",18),s(47,11),o()(),i(48,"div",19),S(49,35)(50,36),i(51,"div",37)(52,"label",38),s(53,12),o(),i(54,"my-help"),u(55,Hl,4,0,"ng-template",39),o(),m(56,"textarea",40),u(57,Jl,2,1,"div",25),o(),i(58,"div",37)(59,"label",41),C(60,"CSS"),o(),i(61,"my-help"),u(62,Kl,7,4,"ng-template",39),o(),m(63,"textarea",42),u(64,Yl,2,1,"div",25),o(),E()(),o()(),E()),e&2&&(l("formGroup",t.form),a(13),l("ngClass",X(17,Yn,t.formErrors["cache.previews.size"])),a(2),W(t.getCacheSize("previews")),j(15),a(),l("ngIf",t.formErrors.cache.previews.size),a(5),l("ngClass",X(19,Yn,t.formErrors["cache.captions.size"])),a(2),W(t.getCacheSize("captions")),j(23),a(),l("ngIf",t.formErrors.cache.captions.size),a(5),l("ngClass",X(21,Yn,t.formErrors["cache.torrents.size"])),a(2),W(t.getCacheSize("torrents")),j(31),a(),l("ngIf",t.formErrors.cache.torrents.size),a(5),l("ngClass",X(23,Yn,t.formErrors["cache.storyboards.size"])),a(2),W(t.getCacheSize("storyboards")),j(39),a(),l("ngIf",t.formErrors.cache.storyboards.size),a(16),l("ngClass",X(25,Yn,t.formErrors["instance.customizations.javascript"])),a(),l("ngIf",t.formErrors.instance.customizations.javascript),a(6),l("ngClass",X(27,Yn,t.formErrors["instance.customizations.css"])),a(),l("ngIf",t.formErrors.instance.customizations.css));},dependencies:[ce,Ve,En,Se,Me,li,Pe,fe,ke,Rt,le,B,en,Dt],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var Li=qn;function ql(n,r){if(n&1&&(S(0),s(1,1),ie(2,"bytes"),E()),n&2){let e=p(2);a(2),W(_e(2,1,e.computeQuotaWithTranscoding(),0)),j(1);}}function Ql(n,r){if(n&1&&(i(0,"div"),S(1),D(2,0),m(3,"strong"),y(),E(),m(4,"br"),u(5,ql,3,4,"ng-container",2),o()),n&2){let e=p();a(5),l("ngIf",e.isTranscodingInformationDisplayed());}}var Qn=class Qn{constructor(r){this.server=r;c(this,"videoQuota");c(this,"serverConfig");}ngOnInit(){this.serverConfig=this.server.getHTMLConfig();}isTranscodingInformationDisplayed(){return this.serverConfig.transcoding.enabledResolutions.length!==0;}computeQuotaWithTranscoding(){let r=this.serverConfig.transcoding,e=r.enabledResolutions,t=Za.H_4K,_=0;for(let d of e)_+=d/t;return r.hls.enabled&&(_*=2),_*this.getQuotaAsNumber();}getQuotaAsNumber(){return parseInt(this.videoQuota+"",10);}};c(Qn,"\u0275fac",function(e){return new(e||Qn)(T(Ge));}),c(Qn,"\u0275cmp",h({type:Qn,selectors:[["my-user-real-quota-info"]],inputs:{videoQuota:"videoQuota"},standalone:!0,features:[v],decls:1,vars:1,consts:()=>{let r;r="\u5F71\u7247\u914D\u984D\u50C5\u8003\u616E"+"\uFFFD#3\uFFFD"+"\u4E0A\u50B3\u7684"+"\uFFFD/#3\uFFFD"+"\u5F71\u7247\uFF0C\u800C\u4E0D\u5305\u542B\u8F49\u63DB\u7DE8\u78BC\u7684\u6A94\u6848\u6216\u4F7F\u7528\u8005\u532F\u51FA\u5C01\u5B58\u6A94\uFF08\u53EF\u80FD\u5305\u542B\u5F71\u7247\u6A94\uFF09\u3002 ";let e;return e="\u5DF2\u555F\u7528\u8F49\u63DB\u7DE8\u78BC\uFF0C\u56E0\u6B64\u5F71\u7247\u5927\u5C0F\u6700\u591A\u70BA\u7D04 "+"\uFFFD0\uFFFD"+"\u3002 ",[r,e,[4,"ngIf"]];},template:function(e,t){e&1&&u(0,Ql,6,1,"div",2),e&2&&l("ngIf",t.getQuotaAsNumber()>0);},dependencies:[B,Tt],encapsulation:2}));var An=Qn;function Zl(n,r){if(n&1&&(i(0,"span",5),C(1),o()),n&2){let e=p(2);a(),I(e.inputSuffix);}}function es(n,r){if(n&1){let e=k();S(0),i(1,"input",3),Oe("ngModelChange",function(_){P(e);let d=p();return Ie(d.customValue,_)||(d.customValue=_),A(_);}),M("ngModelChange",function(){P(e);let _=p();return A(_.onModelChange());}),o(),u(2,Zl,2,1,"span",4),E();}if(n&2){let e=p();a(),Te("ngModel",e.customValue),l("type",e.inputType),a(),l("ngIf",e.inputSuffix);}}var hn=class hn{constructor(){c(this,"items",[]);c(this,"clearable",!1);c(this,"searchable",!1);c(this,"groupBy");c(this,"labelForId");c(this,"inputSuffix");c(this,"inputType","text");c(this,"customValue","");c(this,"selectedId");c(this,"disabled",!1);c(this,"itemsWithCustom",[]);c(this,"propagateChange",r=>{});}ngOnChanges(){this.itemsWithCustom=this.getItems();}writeValue(r){this.selectedId=r,this.isSelectedIdInItems()!==!0&&(this.selectedId="other",this.customValue=r);}registerOnChange(r){this.propagateChange=r;}registerOnTouched(){}onModelChange(){return this.selectedId==="other"?this.propagateChange(this.customValue):this.propagateChange(this.selectedId);}isSelectedIdInItems(){return!!this.items.find(r=>r.id===this.selectedId);}getItems(){let r={id:"other",label:"\u81EA\u8A02\u503C\u2026\u2026"};return this.items.concat([r]);}isCustomValue(){return this.selectedId==="other";}setDisabledState(r){this.disabled=r;}};c(hn,"\u0275fac",function(e){return new(e||hn)();}),c(hn,"\u0275cmp",h({type:hn,selectors:[["my-select-custom-value"]],inputs:{items:"items",clearable:"clearable",searchable:"searchable",groupBy:"groupBy",labelForId:"labelForId",inputSuffix:"inputSuffix",inputType:"inputType"},standalone:!0,features:[Ba([{provide:qa,useExisting:Ga(()=>hn),multi:!0}]),gn,v],decls:3,vars:8,consts:[[1,"root"],[3,"ngModelChange","items","clearable","searchable","groupBy","labelForId","disabled","ngModel"],[4,"ngIf"],[1,"form-control",3,"ngModelChange","ngModel","type"],["class","input-suffix",4,"ngIf"],[1,"input-suffix"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"my-select-options",1),Oe("ngModelChange",function(d){return Ie(t.selectedId,d)||(t.selectedId=d),d;}),M("ngModelChange",function(){return t.onModelChange();}),o(),u(2,es,3,3,"ng-container",2),o()),e&2&&(a(),l("items",t.itemsWithCustom)("clearable",t.clearable)("searchable",t.searchable)("groupBy",t.groupBy)("labelForId",t.labelForId)("disabled",t.disabled),Te("ngModel",t.selectedId),a(),l("ngIf",t.isCustomValue()));},dependencies:[Nn,ce,Ve,Se,At,B],styles:[".muted[_ngcontent-%COMP%]{font-size:90%}ng-select[_ngcontent-%COMP%]{width:auto}@media screen and (max-width: auto){ng-select[_ngcontent-%COMP%]{width:100%}}ng-select[_ngcontent-%COMP%]     .ng-value-container{max-height:100px;overflow-y:auto;overflow-x:hidden}ng-select[_ngcontent-%COMP%]     .ng-value-label img{position:relative;top:-1px}ng-select[_ngcontent-%COMP%]     img{border-radius:50%;height:20px;width:20px}.root[_ngcontent-%COMP%]{display:flex;align-items:center}.root[_ngcontent-%COMP%] > my-select-options[_ngcontent-%COMP%]{flex-grow:1}my-select-options[_ngcontent-%COMP%] + input[_ngcontent-%COMP%]{display:block;font-size:15px;padding:3px 15px;width:auto;max-width:auto;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px;margin-inline-start:.3125rem}my-select-options[_ngcontent-%COMP%] + input[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}my-select-options[_ngcontent-%COMP%] + input[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: calc(auto + 40px)){my-select-options[_ngcontent-%COMP%] + input[_ngcontent-%COMP%]{width:100%}}.input-suffix[_ngcontent-%COMP%]{margin-inline-start:.3125rem}"]}));var xt=hn;var nn=class nn{constructor(r,e){this.authHttp=r;this.restExtractor=e;c(this,"videoQuotaOptions",[]);c(this,"videoQuotaDailyOptions",[]);c(this,"transcodingThreadOptions",[]);this.videoQuotaOptions=[{id:-1,label:"\u7121\u9650\u5236"},{id:0,label:"\u7121 - \u7121\u6CD5\u4E0A\u50B3"},{id:100*1024*1024,label:"100MB"},{id:500*1024*1024,label:"500MB"},{id:1024*1024*1024,label:"1GB"},{id:5*1024*1024*1024,label:"5GB"},{id:20*1024*1024*1024,label:"20GB"},{id:50*1024*1024*1024,label:"50GB"},{id:100*1024*1024*1024,label:"100GB"},{id:200*1024*1024*1024,label:"200GB"},{id:500*1024*1024*1024,label:"500GB"}],this.videoQuotaDailyOptions=[{id:-1,label:"\u7121\u9650\u5236"},{id:0,label:"\u7121 - \u7121\u6CD5\u4E0A\u50B3"},{id:10*1024*1024,label:"10MB"},{id:50*1024*1024,label:"50MB"},{id:100*1024*1024,label:"100MB"},{id:500*1024*1024,label:"500MB"},{id:2*1024*1024*1024,label:"2GB"},{id:5*1024*1024*1024,label:"5GB"},{id:10*1024*1024*1024,label:"10GB"},{id:20*1024*1024*1024,label:"20GB"},{id:50*1024*1024*1024,label:"50GB"}],this.transcodingThreadOptions=[{id:0,label:"\u81EA\u52D5\uFF08\u900F\u904E ffmpeg\uFF09"},{id:1,label:"1"},{id:2,label:"2"},{id:4,label:"4"},{id:8,label:"8"},{id:12,label:"12"},{id:16,label:"16"},{id:32,label:"32"}];}getCustomConfig(){return this.authHttp.get(nn.BASE_APPLICATION_URL+"/custom").pipe(ge(r=>this.restExtractor.handleError(r)));}updateCustomConfig(r){return this.authHttp.put(nn.BASE_APPLICATION_URL+"/custom",r).pipe(ge(e=>this.restExtractor.handleError(e)));}};c(nn,"BASE_APPLICATION_URL",_t.apiUrl+"/api/v1/config"),c(nn,"\u0275fac",function(e){return new(e||nn)(Ee(lt),Ee(ct));}),c(nn,"\u0275prov",qe({token:nn,factory:nn.ɵfac}));var pt=nn;var Dn=n=>({"input-error":n}),ts=n=>({"disabled-checkbox-extra":n});function ns(n,r){if(n&1&&(i(0,"option",216),C(1),o()),n&2){let e=r.$implicit;l("value",e.id),a(),I(e.label);}}function os(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.defaultClientRoute);}}function is(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.trending.videos.algorithms.default);}}function rs(n,r){n&1&&(i(0,"span"),s(1,68),o());}function as(n,r){n&1&&(i(0,"span"),s(1,69),o());}function _s(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.broadcastMessage.level);}}function ls(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.broadcastMessage.message);}}function ss(n,r){if(n&1&&(i(0,"div",218),C(1),o()),n&2){let e=p();a(),I(e.signupAlertMessage);}}function cs(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.signup.limit);}}function ds(n,r){n&1&&(i(0,"small",219),s(1,70),o());}function ps(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.signup.minimumAge);}}function ms(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.user.videoQuota);}}function us(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.user.videoQuotaDaily);}}function gs(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.import.concurrency);}}function Cs(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.videoChannels.maxPerUser);}}function Ss(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.search.searchIndex.url);}}function Es(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.export.users.maxUserVideoQuota);}}function Ts(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.export.users.exportExpiration);}}function Is(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.followings.instance.autoFollowIndex.indexUrl);}}function Os(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.admin.email);}}function Ns(n,r){if(n&1&&(i(0,"div",217),C(1),o()),n&2){let e=p();a(),I(e.formErrors.services.twitter.username);}}var eo=class eo{constructor(r,e,t){this.configService=r;this.menuService=e;this.themeService=t;c(this,"form");c(this,"formErrors");c(this,"serverConfig");c(this,"signupAlertMessage");c(this,"defaultLandingPageOptions",[]);c(this,"availableThemes");c(this,"exportExpirationOptions",[]);c(this,"exportMaxUserVideoQuotaOptions",[]);}ngOnInit(){this.buildLandingPageOptions(),this.checkSignupField(),this.checkImportSyncField(),this.availableThemes=this.themeService.buildAvailableThemes(),this.exportExpirationOptions=[{id:1e3*3600*24,label:"1\u5929"},{id:1e3*3600*24*2,label:"2\u5929"},{id:1e3*3600*24*7,label:"7\u5929"},{id:1e3*3600*24*30,label:"30\u5929"}],this.exportMaxUserVideoQuotaOptions=this.configService.videoQuotaOptions.filter(r=>r.id>=1);}ngOnChanges(r){r.serverConfig&&this.buildLandingPageOptions();}countExternalAuth(){return this.serverConfig.plugin.registeredExternalAuths.length;}getVideoQuotaOptions(){return this.configService.videoQuotaOptions;}getVideoQuotaDailyOptions(){return this.configService.videoQuotaDailyOptions;}doesTrendingVideosAlgorithmsEnabledInclude(r){let e=this.form.value.trending.videos.algorithms.enabled;return Array.isArray(e)?!!e.find(t=>t===r):!1;}getUserVideoQuota(){return this.form.value.user.videoQuota;}isExportUsersEnabled(){return this.form.value.export.users.enabled===!0;}getDisabledExportUsersClass(){return{"disabled-checkbox-extra":!this.isExportUsersEnabled()};}isSignupEnabled(){return this.form.value.signup.enabled===!0;}getDisabledSignupClass(){return{"disabled-checkbox-extra":!this.isSignupEnabled()};}isImportVideosHttpEnabled(){return this.form.value.import.videos.http.enabled===!0;}importSynchronizationChecked(){return this.isImportVideosHttpEnabled()&&this.form.value.import.videoChannelSynchronization.enabled;}hasUnlimitedSignup(){return this.form.value.signup.limit===-1;}isSearchIndexEnabled(){return this.form.value.search.searchIndex.enabled===!0;}getDisabledSearchIndexClass(){return{"disabled-checkbox-extra":!this.isSearchIndexEnabled()};}isTranscriptionEnabled(){return this.form.value.videoTranscription.enabled===!0;}getTranscriptionRunnerDisabledClass(){return{"disabled-checkbox-extra":!this.isTranscriptionEnabled()};}isAutoFollowIndexEnabled(){return this.form.value.followings.instance.autoFollowIndex.enabled===!0;}buildLandingPageOptions(){this.defaultLandingPageOptions=this.menuService.buildCommonLinks(this.serverConfig).links.map(r=>({id:r.path,label:r.label,description:r.path}));}getDefaultThemeLabel(){return this.themeService.getDefaultThemeLabel();}checkImportSyncField(){let r=this.form.get("import.videoChannelSynchronization.enabled");this.form.get("import.videos.http.enabled").valueChanges.subscribe(t=>{r.setValue(t&&r.value),t?r.enable():r.disable();});}checkSignupField(){let r=this.form.get("signup.enabled");r.valueChanges.pipe(xa()).subscribe(([e,t])=>{e===!1&&t===!0&&(this.signupAlertMessage="\u60A8\u555F\u7528\u4E86\u8A3B\u518A\uFF1A\u6211\u5011\u81EA\u52D5\u555F\u7528\u4E86\u4E0B\u9762\u300C\u5F71\u7247\u300D\u90E8\u4EFD\u7684\u300C\u81EA\u52D5\u5C01\u9396\u65B0\u5F71\u7247\u300D\u3002",this.form.patchValue({autoBlacklist:{videos:{ofUsers:{enabled:!0}}}}));}),r.updateValueAndValidity();}};c(eo,"\u0275fac",function(e){return new(e||eo)(T(pt),T(M_),T(A_));}),c(eo,"\u0275cmp",h({type:eo,selectors:[["my-edit-basic-configuration"]],inputs:{form:"form",formErrors:"formErrors",serverConfig:"serverConfig"},standalone:!0,features:[gn,v],decls:358,vars:74,consts:()=>{let r;r="\u504F\u597D\u5F71\u7247\u7E2E\u5716\u4E2D\u7684\u4F5C\u8005\u986F\u793A\u540D\u7A31";let e;e="\u7576\u4F7F\u7528\u8005\u9EDE\u64CA\u9078\u55AE\u4E2D\u7684\u767B\u5165\u6309\u9215\u6642\uFF0C\u5728\u55AE\u3127\u5916\u90E8\u8EAB\u4EFD\u9A57\u8B49\u4E0A\u91CD\u65B0\u5C0E\u5411\u4F7F\u7528\u8005";let t;t="\u555F\u7528\u5EE3\u64AD\u8A0A\u606F";let _;_="\u5141\u8A31\u4F7F\u7528\u8005\u5FFD\u7565\u5EE3\u64AD\u8A0A\u606F";let d;d="\u555F\u7528\u8A3B\u518A";let g;g="\u8A3B\u518A\u9700\u8981\u5BE9\u67E5\u54E1\u6838\u51C6";let O;O="\u8A3B\u518A\u9700\u8981\u96FB\u5B50\u90F5\u4EF6\u9A57\u8B49";let R;R="\u4F4D\u5143\u7D44";let N;N="\u4F4D\u5143\u7D44";let b;b="\u81EA\u52D5\u70BA\u65B0\u4F7F\u7528\u8005\u555F\u7528\u5F71\u7247\u6B77\u53F2\u7D00\u9304";let G;G="\u5141\u8A31\u4EE5 HTTP URL \u532F\u5165 (\u4F8B\u5982 YouTube)";let F;F="\u5141\u8A31\u4F7F\u7528\u7A2E\u5B50\u6A94\u6848\u6216\u78C1\u529B\u9023\u7D50\u532F\u5165";let L;L="\u5141\u8A31\u8207 YouTube \u7B49\u5176\u4ED6\u5E73\u53F0\u7684\u983B\u9053\u540C\u6B65";let $;$="\u81EA\u52D5\u5C01\u9396\u65B0\u5F71\u7247";let H;H="\u5141\u8A31\u4F7F\u7528\u8005\u4E0A\u50B3\u5F71\u7247\u7684\u65B0\u7248\u672C";let z;z="\u555F\u7528\u5F71\u7247\u5206\u93E1";let V;V="\u555F\u7528\u5F71\u7247\u8F49\u9304";let x;x="\u555F\u7528\u9060\u7AEF\u57F7\u884C\u5668\u9032\u884C\u8F49\u9304";let Y;Y="\u5141\u8A31\u4F7F\u7528\u8005\u9060\u7AEF\u641C\u5C0B URI\uFF0F\u4EE3\u865F";let oe;oe="\u5141\u8A31\u533F\u540D\u4F7F\u7528\u8005\u9060\u7AEF\u641C\u5C0B URI\uFF0F\u4EE3\u865F";let we;we="\u555F\u7528\u5168\u57DF\u641C\u5C0B";let ae;ae="\u5728\u641C\u5C0B\u5217\u505C\u7528\u672C\u5730\u641C\u5C0B";let Be;Be="\u641C\u5C0B\u5217\u9810\u8A2D\u4F7F\u7528\u5168\u57DF\u641C\u5C0B";let We;We="\u5141\u8A31\u60A8\u7684\u4F7F\u7528\u8005\u532F\u5165\u8CC7\u6599\u5C01\u5B58\u6A94";let je;je="\u5141\u8A31\u60A8\u7684\u4F7F\u7528\u8005\u532F\u51FA\u4ED6\u5011\u7684\u8CC7\u6599";let He;He="\u4F4D\u5143\u7D44";let Je;Je="\u5176\u4ED6\u7AD9\u81FA\u53EF\u4EE5\u8FFD\u8E64\u60A8\u7684";let Z;Z="\u624B\u52D5\u6279\u51C6\u65B0\u7684\u7AD9\u81FA\u8FFD\u8E64\u8005";let it;it="\u81EA\u52D5\u8FFD\u8E64\u7AD9\u81FA";let Ye;Ye="\u81EA\u52D5\u8FFD\u8E64\u516C\u958B\u7D22\u5F15\u4E0A\u7684\u7AD9\u81FA";let rt;rt="\u555F\u7528\u806F\u7D61\u8868\u55AE";let at;at="\u5916\u89C0";let Ke;Ke="\u4F7F\u7528"+"\uFFFD#7\uFFFD"+"\u5916\u639B\u7A0B\u5F0F\u8207\u4F48\u666F\u4E3B\u984C"+"[\uFFFD/#7\uFFFD|\uFFFD/#8\uFFFD]"+"\u4F86\u9032\u884C\u66F4\u591A\u8B8A\u66F4\uFF0C\u6216\u662F\u52A0\u5165\u4E00\u4E9B\u5C0F"+"\uFFFD#8\uFFFD"+"\u4FEE\u6539"+"[\uFFFD/#7\uFFFD|\uFFFD/#8\uFFFD]"+"\u3002 ",Ke=Ce(Ke);let q;q="\u4F48\u666F\u4E3B\u984C";let U;U=""+"\uFFFD0\uFFFD"+"";let Jt;Jt="\u9996\u9801";let un;un="\u9810\u8A2D\u71B1\u9580\u9801\u9762";let Kt;Kt="\u71B1\u9580\u5F71\u7247";let te;te="\u6700\u8FD1\u7684\u6AA2\u8996";let Wo;Wo="\u6700\u559C\u6B61\u7684\u5F71\u7247";let jo;jo="\u5168\u57DF\u6AA2\u8996";let Ho;Ho="\u5EE3\u64AD\u8A0A\u606F";let ee;ee="\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u986F\u793A\u8A0A\u606F";let vr;vr="\u5EE3\u64AD\u8A0A\u606F\u7B49\u7D1A";let Dr;Dr="\u8CC7\u8A0A";let yr;yr="\u8B66\u544A";let Lr;Lr="\u932F\u8AA4";let $r;$r="\u8A0A\u606F";let xr;xr="\u65B0\u4F7F\u7528\u8005";let Gr;Gr="\u7BA1\u7406"+"\uFFFD#88\uFFFD"+"\u4F7F\u7528\u8005"+"\uFFFD/#88\uFFFD"+"\u4EE5\u55AE\u7368\u8A2D\u5B9A\u4ED6\u5011\u7684\u914D\u984D\u3002 ";let Ur;Ur="\u26A0\uFE0F \u4F7F\u7528\u6B64\u529F\u80FD\u6642\u5FC5\u9808\u975E\u5E38\u5C0F\u5FC3\u3002";let wr;wr="\u9650\u5236\u8A3B\u518A";let oi;oi="{VAR_PLURAL, plural, =1 {\u4F7F\u7528\u8005} other {\u4F7F\u7528\u8005}}",oi=Ce(oi,{VAR_PLURAL:"\uFFFD0\uFFFD"});let Vr;Vr="\u5EFA\u7ACB\u5E33\u865F\u6240\u9700\u7684\u6700\u4F4E\u5E74\u9F61";let ii;ii="{VAR_PLURAL, plural, =1 {\u6B72} other {\u6B72}}",ii=Ce(ii,{VAR_PLURAL:"\uFFFD0\uFFFD"});let kr;kr="\u6BCF\u500B\u4F7F\u7528\u8005\u9810\u8A2D\u7684\u5F71\u7247\u914D\u984D";let zr;zr="\u6BCF\u500B\u4F7F\u7528\u8005\u9810\u8A2D\u7684\u6BCF\u65E5\u4E0A\u50B3\u9650\u5236";let Xr;Xr="\u5F71\u7247";let Br;Br="\u532F\u5165\u5DE5\u4F5C\u4E26\u884C";let Wr;Wr="\u5141\u8A31\u540C\u6642\u532F\u5165\u591A\u90E8\u5F71\u7247\u3002 \u26A0\uFE0F \u9700\u8981\u91CD\u65B0\u555F\u52D5 PeerTube\u3002";let jr;jr="\u5E73\u884C\u4F5C\u696D";let Hr;Hr="\u26A0\uFE0F \u82E5\u555F\u7528\uFF0C\u6211\u5011\u5EFA\u8B70\u4F7F\u7528 "+"\uFFFD#157\uFFFD"+"HTTP \u4EE3\u7406\u4F3A\u670D\u5668"+"\uFFFD/#157\uFFFD"+"\u4EE5\u907F\u514D\u4F86\u81EA\u60A8 PeerTube \u4F3A\u670D\u5668\u7684\u79C1\u4EBA URL \u5B58\u53D6";let Jr;Jr="\u26A0\uFE0F \u82E5\u60A8\u4E0D\u4FE1\u4EFB\u60A8\u7684\u4F7F\u7528\u8005\uFF0C\u5247\u6211\u5011\u4E0D\u5EFA\u8B70\u555F\u7528\u6B64\u529F\u80FD";let Kr;Kr="\u26D4 \u60A8\u9700\u8981\u4F7F\u7528 HTTP URL \u532F\u5165\u624D\u80FD\u555F\u7528\u6B64\u529F\u80FD\u3002";let Yr;Yr="\u9664\u975E\u4F7F\u7528\u8005\u88AB\u6A19\u8A18\u70BA\u53D7\u4FE1\u4EFB\uFF0C\u5426\u5247\u4ED6\u5011\u7684\u5F71\u7247\u5C07\u6703\u5728\u677F\u4E3B\u5BE9\u95B1\u524D\u4FDD\u6301\u79C1\u5BC6\u5F71\u7247\u7684\u72C0\u614B\u3002";let qr;qr="\u4F7F\u7528 ffmpeg \u7522\u751F\u672C\u6A5F\u5F71\u7247\u7684\u5206\u93E1\uFF0C\u8B93\u4F7F\u7528\u8005\u5728\u62D6\u66F3\u5F71\u7247\u6642\u53EF\u4EE5\u5728\u64AD\u653E\u5668\u4E2D\u770B\u5230\u5F71\u7247\u9810\u89BD";let Qr;Qr="\u81EA\u52D5\u5EFA\u7ACB\u4E0A\u50B3/\u532F\u5165\u7684\u96A8\u9078\u8996\u8A0A\u5F71\u7247\u7684\u5B57\u5E55\u6A94\u6848";let Zr;Zr="\u4F7F\u7528"+"\uFFFD#199\uFFFD"+"\u9060\u7AEF\u57F7\u884C\u5668"+"\uFFFD/#199\uFFFD"+"\u4EE5\u8655\u7406\u8F49\u9304\u4F5C\u696D\u3002\u9060\u7AEF\u57F7\u884C\u5668\u5FC5\u9808\u5148\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u8A3B\u518A\u3002 ";let ea;ea="\u5F71\u7247\u983B\u9053";let ta;ta="\u6BCF\u500B\u4F7F\u7528\u8005\u7684\u6700\u5927\u5F71\u7247\u983B\u9053\u6578";let ri;ri="{VAR_PLURAL, plural, =1 {\u983B\u9053} other {\u983B\u9053}}",ri=Ce(ri,{VAR_PLURAL:"\uFFFD0\uFFFD"});let na;na="\u641C\u5C0B";let oa;oa="\u5141\u8A31"+"\uFFFD#225\uFFFD"+"\u60A8\u7684\u4F7F\u7528\u8005"+"\uFFFD/#225\uFFFD"+"\u5C0B\u627E\u672A\u8207\u60A8\u7684\u7AD9\u53F0\u806F\u76DF\u7684\u9060\u7AEF\u5F71\u7247\u8207\u6F14\u54E1";let ia;ia="\u5141\u8A31"+"\uFFFD#231\uFFFD"+"\u533F\u540D\u4F7F\u7528\u8005"+"\uFFFD/#231\uFFFD"+"\u5C0B\u627E\u672A\u8207\u60A8\u7684\u7AD9\u53F0\u806F\u76DF\u7684\u9060\u7AEF\u5F71\u7247\u8207\u6F14\u54E1";let ra;ra="\u26A0\uFE0F \u6B64\u529F\u80FD\u76F8\u7576\u4F9D\u8CF4\u65BC\u7AD9\u81FA\u7684\u5BE9\u6838\u7A0B\u5EA6\u8207\u60A8\u6240\u9078\u53D6\u7684\u641C\u5C0B\u7D22\u5F15\u3002";let aa;aa="\u60A8\u53EA\u61C9\u5728\u751F\u7522\u74B0\u5883\u4E2D\u4F7F\u7528\u5BE9\u6838\u7684\u641C\u5C0B\u7D22\u5F15\uFF0C\u6216"+"\uFFFD#240\uFFFD"+"\u81EA\u884C\u67B6\u8A2D"+"\uFFFD/#240\uFFFD"+"\u3002 ";let _a;_a="\u641C\u5C0B\u7D22\u5F15 URL";let la;la="\u5426\u5247\u4ECD\u9810\u8A2D\u4F7F\u7528\u672C\u5730\u641C\u5C0B";let sa;sa="\u4F7F\u7528\u8005\u532F\u5165/\u532F\u51FA";let ca;ca="\u532F\u5165\u6642\u6703\u6AA2\u67E5\u5F71\u7247\u914D\u984D\uFF0C\u56E0\u6B64\u4F7F\u7528\u8005\u7121\u6CD5\u4E0A\u50B3\u592A\u5927\u7684\u5C01\u5B58\u6A94";let da;da="PeerTube \u8655\u7406\u532F\u5165\u6642\u4E5F\u6703\u6AA2\u67E5\u6BCF\u500B\u5F71\u7247\u7684\u5F71\u7247\u914D\u984D\uFF08\u4E0D\u8003\u616E\u6BCF\u65E5\u914D\u984D\uFF09";let pa;pa="\u4F7F\u7528\u8005\u53EF\u4EE5\u4EE5 .zip \u683C\u5F0F\u532F\u51FA PeerTube \u8CC7\u6599\u4EE5\u9032\u884C\u5099\u4EFD\u6216\u91CD\u65B0\u532F\u5165\u3002\u6BCF\u500B\u4F7F\u7528\u8005\u4E00\u6B21\u50C5\u5141\u8A31\u4E00\u500B\u532F\u51FA";let ma;ma="\u5141\u8A31\u7522\u751F\u532F\u51FA\u7684\u6700\u5927\u4F7F\u7528\u8005\u5F71\u7247\u914D\u984D";let ua;ua="\u82E5\u4F7F\u7528\u8005\u6C7A\u5B9A\u5C07\u5F71\u7247\u6A94\u6848\u5305\u542B\u5728\u5C01\u5B58\u6A94\u4E2D";let ga;ga="\u4F7F\u7528\u8005\u532F\u51FA\u904E\u671F";let Ca;Ca="\u5728\u6B64\u671F\u9650\u5F8C\uFF0C\u5C01\u5B58\u6A94\u5C07\u6703\u88AB\u522A\u9664\u3002";let Sa;Sa="\u806F\u76DF";let Ea;Ea="\u7BA1\u7406\u8207\u5176\u4ED6\u7AD9\u53F0\u7684"+"\uFFFD#296\uFFFD"+"\u95DC\u4FC2"+"\uFFFD/#296\uFFFD"+"\u3002 ";let Ta;Ta="\u26A0\uFE0F \u4F7F\u7528\u6B64\u529F\u80FD\u6642\u5FC5\u9808\u975E\u5E38\u5C0F\u5FC3\u3002";let Ia;Ia="\u26A0\uFE0F \u4F7F\u7528\u6B64\u529F\u80FD\u6642\u5FC5\u9808\u975E\u5E38\u5C0F\u5FC3\u3002";let Oa;Oa="\u6AA2\u8996"+"\uFFFD#320\uFFFD"+"\u6587\u4EF6"+"\uFFFD/#320\uFFFD"+"\u4EE5\u53D6\u5F97\u95DC\u65BC\u9810\u671F URL \u7684\u66F4\u591A\u8CC7\u8A0A ";let Na;Na="\u7D22\u5F15 URL";let Ma;Ma="\u7BA1\u7406";let fa;fa="\u7BA1\u7406\u96FB\u5B50\u90F5\u4EF6";let Pa;Pa="TWITTER/X";let Aa;Aa="Twitter/X \u9700\u8981\u984D\u5916\u8A2D\u5B9A\u3002\u5176\u4ED6\u6240\u6709\u793E\u7FA4\u5A92\u9AD4\uFF08Facebook\u3001Mastodon \u7B49\uFF09\u5747\u6709\u958B\u7BB1\u5373\u7528\u7684\u652F\u63F4\u3002";let Ra;Ra="\u60A8\u7684 Twitter/X \u4F7F\u7528\u8005\u540D\u7A31";let ba;ba="\u8868\u793A\u767C\u4F48\u5167\u5BB9\u7684\u7DB2\u7AD9\u6216\u5E73\u53F0\u7684 Twitter/X \u5E33\u865F\u3002";let Fa;Fa="\u9019\u53EA\u662F Twitter/X \u6240\u9700\u7684 PeerTube HTML \u4E2D\u6CE8\u5165\u7684\u984D\u5916\u8CC7\u8A0A\u3002\u5982\u679C\u60A8\u6C92\u6709 Twitter/X \u5E33\u865F\uFF0C\u8ACB\u4FDD\u7559\u9810\u8A2D\u503C\u3002";let ha;ha="\u26A0\uFE0F \u60A8\u672A\u555F\u7528\u4EFB\u4F55\u5916\u90E8\u8EAB\u4EFD\u9A57\u8B49\u5916\u639B\u7A0B\u5F0F\u3002";let va;va="\u26A0\uFE0F \u60A8\u555F\u7528\u4E86\u591A\u500B\u5916\u90E8\u8EAB\u4EFD\u9A57\u8B49\u5916\u639B\u7A0B\u5F0F\u3002";let Da;return Da="\u8A3B\u518A\u5C07\u4E0D\u9650\u65BC\u56FA\u5B9A\u6578\u91CF\u7684\u4F7F\u7528\u8005\u3002",[at,Ke,q,U,Jt,un,Kt,te,Wo,jo,Ho,ee,vr,Dr,yr,Lr,$r,xr,Gr,Ur,wr,oi,Vr,ii,kr,zr,Xr,Br,Wr,jr,Hr,Jr,Kr,Yr,qr,Qr,Zr,ea,ta,ri,na,oa,ia,ra,aa,_a,la,sa,ca,da,pa,ma,ua,ga,Ca,Sa,Ea,Ta,Ia,Oa,Na,Ma,fa,Pa,Aa,Ra,ba,Fa,ha,va,Da,[3,"formGroup"],[1,"pt-two-cols","mt-5"],[1,"title-col"],[1,"inner-form-description"],["routerLink","/admin/plugins",1,"link-orange"],["routerLink","/admin/config/edit-custom","fragment","advanced-configuration",1,"link-orange"],[1,"content-col"],["formGroupName","theme"],[1,"form-group"],["for","themeDefault"],[1,"peertube-select-container"],["formControlName","default","id","themeDefault",1,"form-control"],["value","default"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","instance",1,"form-group"],["for","instanceDefaultClientRoute"],["id","instanceDefaultClientRoute","formControlName","defaultClientRoute","inputType","text",3,"items","clearable"],["class","form-error","role","alert",4,"ngIf"],["formGroupName","trending",1,"form-group"],["formGroupName","videos"],["formGroupName","algorithms"],["for","trendingVideosAlgorithmsDefault"],["id","trendingVideosAlgorithmsDefault","formControlName","default",1,"form-control"],["value","hot"],["value","most-viewed"],["value","most-liked"],["value","views"],["formGroupName","client"],["formGroupName","miniature"],["inputName","clientVideosMiniaturePreferAuthorDisplayName","formControlName","preferAuthorDisplayName","labelText",r],["formGroupName","menu"],["formGroupName","login"],["inputName","clientMenuLoginRedirectOnSingleExternalAuth","formControlName","redirectOnSingleExternalAuth","labelText",e],["ngProjectAs","description",5,["description"]],[4,"ngIf"],[1,"pt-two-cols","mt-4"],["formGroupName","broadcastMessage"],["inputName","broadcastMessageEnabled","formControlName","enabled","labelText",t],["inputName","broadcastMessageDismissable","formControlName","dismissable","labelText",_],["for","broadcastMessageLevel"],["id","broadcastMessageLevel","formControlName","level",1,"form-control"],["value","info"],["value","warning"],["value","error"],["for","broadcastMessageMessage"],["helpType","markdownText"],["name","broadcastMessageMessage","formControlName","message","markdownType","to-unsafe-html",3,"formError"],["routerLink","/admin/users",1,"link-orange"],["formGroupName","signup"],["inputName","signupEnabled","formControlName","enabled","labelText",d],["class","alert pt-alert-primary alert-signup",4,"ngIf"],["ngProjectAs","extra",5,["extra"]],["inputName","signupRequiresApproval","formControlName","requiresApproval","labelText",g,3,"ngClass"],["inputName","signupRequiresEmailVerification","formControlName","requiresEmailVerification","labelText",O,3,"ngClass"],[3,"ngClass"],["for","signupLimit"],[1,"number-with-unit"],["type","number","min","-1","id","signupLimit","formControlName","limit",1,"form-control",3,"ngClass"],["class","muted small",4,"ngIf"],[1,"mt-3",3,"ngClass"],["for","signupMinimumAge"],["type","number","min","1","id","signupMinimumAge","formControlName","minimumAge",1,"form-control",3,"ngClass"],["formGroupName","user"],["for","userVideoQuota"],["id","userVideoQuota","formControlName","videoQuota","inputSuffix",R,"inputType","number",3,"items","clearable"],[1,"mt-2","d-block","small","muted",3,"videoQuota"],["for","userVideoQuotaDaily"],["id","userVideoQuotaDaily","formControlName","videoQuotaDaily","inputSuffix",N,"inputType","number",3,"items","clearable"],["formGroupName","history"],["inputName","videosHistoryEnabled","formControlName","enabled","labelText",b],["formGroupName","import"],["for","importConcurrency"],[1,"small","muted","ms-1"],["type","number","name","importConcurrency","formControlName","concurrency"],["formGroupName","http",1,"form-group"],["inputName","importVideosHttpEnabled","formControlName","enabled","labelText",G],["href","https://docs.joinpeertube.org/maintain/configuration#security",1,"link-orange"],["formGroupName","torrent",1,"form-group"],["inputName","importVideosTorrentEnabled","formControlName","enabled","labelText",F],["formGroupName","videoChannelSynchronization"],["inputName","importSynchronizationEnabled","formControlName","enabled","labelText",L],[3,"hidden"],["formGroupName","autoBlacklist"],["formGroupName","ofUsers"],["inputName","autoBlacklistVideosOfUsersEnabled","formControlName","enabled","labelText",$],["formGroupName","videoFile"],["formGroupName","update"],["inputName","videoFileUpdateEnabled","formControlName","enabled","labelText",H],["formGroupName","storyboards"],["inputName","storyboardsEnabled","formControlName","enabled","labelText",z],["formGroupName","videoTranscription"],["inputName","videoTranscriptionEnabled","formControlName","enabled","labelText",V],["formGroupName","remoteRunners",1,"form-group",3,"ngClass"],["inputName","videoTranscriptionRemoteRunnersEnabled","formControlName","enabled","labelText",x],["routerLink","/admin/system/runners/runners-list"],["formGroupName","videoChannels",1,"form-group"],["for","videoChannelsMaxPerUser"],["type","number","min","1","id","videoChannelsMaxPerUser","formControlName","maxPerUser",1,"form-control",3,"ngClass"],["formGroupName","search"],["formGroupName","remoteUri"],["inputName","searchRemoteUriUsers","formControlName","users","labelText",Y],["inputName","searchRemoteUriAnonymous","formControlName","anonymous","labelText",oe],["formGroupName","searchIndex"],["inputName","searchIndexEnabled","formControlName","enabled","labelText",we],["href","https://framagit.org/framasoft/peertube/search-index",1,"link-orange"],["for","searchIndexUrl"],["type","text","id","searchIndexUrl","formControlName","url",1,"form-control",3,"ngClass"],[1,"mt-3"],["inputName","searchIndexDisableLocalSearch","formControlName","disableLocalSearch","labelText",ae,3,"ngClass"],["inputName","searchIndexIsDefaultSearch","formControlName","isDefaultSearch","labelText",Be,3,"ngClass"],["formGroupName","users"],["inputName","importUsersEnabled","formControlName","enabled","labelText",We],["formGroupName","export"],["inputName","exportUsersEnabled","formControlName","enabled","labelText",je],[1,"form-group",3,"ngClass"],["for","exportUsersMaxUserVideoQuota"],[1,"ms-2","small","muted"],["id","exportUsersMaxUserVideoQuota","formControlName","maxUserVideoQuota","inputSuffix",He,"inputType","number",3,"items","clearable"],["for","exportUsersExportExpiration"],["labelForId","exportUsersExportExpiration","formControlName","exportExpiration","bindLabel","label","bindValue","value",3,"items","clearable","searchable"],[1,"mt-1","small","muted"],["routerLink","/admin/follows",1,"link-orange"],["formGroupName","followers"],["formGroupName","instance"],["inputName","followersInstanceEnabled","formControlName","enabled","labelText",Je],["inputName","followersInstanceManualApproval","formControlName","manualApproval","labelText",Z],["formGroupName","followings"],["formGroupName","autoFollowBack"],["inputName","followingsInstanceAutoFollowBackEnabled","formControlName","enabled","labelText",it],["formGroupName","autoFollowIndex"],["inputName","followingsInstanceAutoFollowIndexEnabled","formControlName","enabled","labelText",Ye],["href","https://docs.joinpeertube.org/admin/following-instances#automatically-follow-other-instances","rel","noopener noreferrer","target","_blank",1,"link-orange"],["for","followingsInstanceAutoFollowIndexUrl"],["type","text","id","followingsInstanceAutoFollowIndexUrl","formControlName","indexUrl",1,"form-control",3,"ngClass"],["formGroupName","admin",1,"form-group"],["for","adminEmail"],["type","text","id","adminEmail","formControlName","email",1,"form-control",3,"ngClass"],["formGroupName","contactForm",1,"form-group"],["inputName","enableContactForm","formControlName","enabled","labelText",rt],["formGroupName","services"],["formGroupName","twitter"],["for","servicesTwitterUsername"],[1,"label-small-info"],[1,"mb-0"],["type","text","id","servicesTwitterUsername","formControlName","username",1,"form-control",3,"ngClass"],[3,"value"],["role","alert",1,"form-error"],[1,"alert","pt-alert-primary","alert-signup"],[1,"muted","small"]];},template:function(e,t){e&1&&(S(0,71),i(1,"div",72)(2,"div",73)(3,"h2"),s(4,0),o(),i(5,"div",74),D(6,1),m(7,"a",75)(8,"a",76),y(),o()(),i(9,"div",77),S(10,78),i(11,"div",79)(12,"label",80),s(13,2),o(),i(14,"div",81)(15,"select",82)(16,"option",83),s(17,3),o(),u(18,ns,2,2,"option",84),o()()(),E(),i(19,"div",85)(20,"label",86),s(21,4),o(),m(22,"my-select-custom-value",87),u(23,os,2,1,"div",88),o(),i(24,"div",89),S(25,90)(26,91),i(27,"label",92),s(28,5),o(),i(29,"div",81)(30,"select",93)(31,"option",94),s(32,6),o(),i(33,"option",95),s(34,7),o(),i(35,"option",96),s(36,8),o(),i(37,"option",97),s(38,9),o()()(),u(39,is,2,1,"div",88),E()(),o(),S(40,98)(41,90)(42,99),i(43,"div",79),m(44,"my-peertube-checkbox",100),o(),E()(),S(45,101)(46,102),i(47,"div",79)(48,"my-peertube-checkbox",103),S(49,104),u(50,rs,2,0,"span",105)(51,as,2,0,"span",105),E(),o()(),E()()(),o()(),i(52,"div",106)(53,"div",73)(54,"h2"),s(55,10),o(),i(56,"div",74),s(57,11),o()(),i(58,"div",77),S(59,107),i(60,"div",79),m(61,"my-peertube-checkbox",108),o(),i(62,"div",79),m(63,"my-peertube-checkbox",109),o(),i(64,"div",79)(65,"label",110),s(66,12),o(),i(67,"div",81)(68,"select",111)(69,"option",112),s(70,13),o(),i(71,"option",113),s(72,14),o(),i(73,"option",114),s(74,15),o()()(),u(75,_s,2,1,"div",88),o(),i(76,"div",79)(77,"label",115),s(78,16),o(),m(79,"my-help",116)(80,"my-markdown-textarea",117),u(81,ls,2,1,"div",88),o(),E(),o()(),i(82,"div",106)(83,"div",73)(84,"h2"),s(85,17),o(),i(86,"div",74),D(87,18),m(88,"a",118),y(),o()(),i(89,"div",77),S(90,119),i(91,"div",79)(92,"my-peertube-checkbox",120),S(93,104),i(94,"span"),s(95,19),o(),u(96,ss,2,1,"div",121),E(),S(97,122),i(98,"div",79),m(99,"my-peertube-checkbox",123),o(),i(100,"div",79),m(101,"my-peertube-checkbox",124),o(),i(102,"div",125)(103,"label",126),s(104,20),o(),i(105,"div",127),m(106,"input",128),i(107,"span"),s(108,21),o()(),u(109,cs,2,1,"div",88)(110,ds,2,0,"small",129),o(),i(111,"div",130)(112,"label",131),s(113,22),o(),i(114,"div",127),m(115,"input",132),i(116,"span"),s(117,23),o()(),u(118,ps,2,1,"div",88),o(),E(),o()(),E(),S(119,133),i(120,"div",79)(121,"label",134),s(122,24),o(),m(123,"my-select-custom-value",135)(124,"my-user-real-quota-info",136),u(125,ms,2,1,"div",88),o(),i(126,"div",79)(127,"label",137),s(128,25),o(),m(129,"my-select-custom-value",138),u(130,us,2,1,"div",88),o(),i(131,"div",79),S(132,139)(133,90),m(134,"my-peertube-checkbox",140),E()(),o(),E(),o()(),i(135,"div",106)(136,"div",73)(137,"h2"),s(138,26),o()(),i(139,"div",77),S(140,141)(141,90),i(142,"div",79)(143,"label",142),s(144,27),o(),i(145,"span",143),s(146,28),o(),i(147,"div",127),m(148,"input",144),i(149,"span"),s(150,29),o()(),u(151,gs,2,1,"div",88),o(),i(152,"div",145)(153,"my-peertube-checkbox",146),S(154,104),i(155,"span"),D(156,30),m(157,"a",147),y(),o(),E(),o()(),i(158,"div",148)(159,"my-peertube-checkbox",149),S(160,104),i(161,"span"),s(162,31),o(),E(),o()(),E(),S(163,150),i(164,"div",79)(165,"my-peertube-checkbox",151),S(166,104),i(167,"span",152),s(168,32),o(),E(),o()(),E()(),S(169,153)(170,90)(171,154),i(172,"div",79)(173,"my-peertube-checkbox",155),S(174,104),i(175,"span"),s(176,33),o(),E(),o()(),E()()(),S(177,156)(178,157),i(179,"div",79),m(180,"my-peertube-checkbox",158),o(),E()(),S(181,159),i(182,"div",79)(183,"my-peertube-checkbox",160),S(184,104),i(185,"span"),s(186,34),o(),E(),o()(),E(),S(187,161),i(188,"div",79)(189,"my-peertube-checkbox",162),S(190,104),i(191,"span"),s(192,35),o(),E(),S(193,122),i(194,"div",163)(195,"my-peertube-checkbox",164),S(196,104),i(197,"span"),D(198,36),m(199,"a",165),y(),o(),E(),o()(),E(),o()(),E(),o()(),i(200,"div",106)(201,"div",73)(202,"h2"),s(203,37),o()(),i(204,"div",77)(205,"div",166)(206,"label",167),s(207,38),o(),i(208,"div",127),m(209,"input",168),i(210,"span"),s(211,39),o()(),u(212,Cs,2,1,"div",88),o()()(),i(213,"div",106)(214,"div",73)(215,"h2"),s(216,40),o()(),i(217,"div",77),S(218,169)(219,170),i(220,"div",79)(221,"my-peertube-checkbox",171),S(222,104),i(223,"span"),D(224,41),m(225,"strong"),y(),o(),E(),o()(),i(226,"div",79)(227,"my-peertube-checkbox",172),S(228,104),i(229,"span"),D(230,42),m(231,"strong"),y(),o(),E(),o()(),E(),S(232,173),i(233,"div",79)(234,"my-peertube-checkbox",174),S(235,104),i(236,"div"),s(237,43),o(),i(238,"div"),D(239,44),m(240,"a",175),y(),o(),E(),S(241,122),i(242,"div",125)(243,"label",176),s(244,45),o(),m(245,"input",177),u(246,Ss,2,1,"div",88),o(),i(247,"div",178),m(248,"my-peertube-checkbox",179),o(),i(249,"div",178)(250,"my-peertube-checkbox",180),S(251,104),i(252,"span"),s(253,46),o(),E(),o()(),E(),o()(),E()(),o()(),i(254,"div",106)(255,"div",73)(256,"h2"),s(257,47),o()(),i(258,"div",77),S(259,141)(260,181),i(261,"div",79)(262,"my-peertube-checkbox",182),S(263,104),i(264,"div"),s(265,48),o(),i(266,"div"),s(267,49),o(),E(),o()(),E()(),S(268,183)(269,181),i(270,"div",79)(271,"my-peertube-checkbox",184),S(272,104),i(273,"span"),s(274,50),o(),E(),S(275,122),i(276,"div",185)(277,"label",186),s(278,51),o(),i(279,"span",187),s(280,52),o(),m(281,"my-select-custom-value",188),u(282,Es,2,1,"div",88),o(),i(283,"div",185)(284,"label",189),s(285,53),o(),m(286,"my-select-options",190),i(287,"div",191),s(288,54),o(),u(289,Ts,2,1,"div",88),o(),E(),o()(),E()(),o()(),i(290,"div",106)(291,"div",73)(292,"h2"),s(293,55),o(),i(294,"div",74),D(295,56),m(296,"a",192),y(),o()(),i(297,"div",77),S(298,193)(299,194),i(300,"div",79),m(301,"my-peertube-checkbox",195),o(),i(302,"div",79),m(303,"my-peertube-checkbox",196),o(),E()(),S(304,197)(305,194)(306,198),i(307,"div",79)(308,"my-peertube-checkbox",199),S(309,104),i(310,"span"),s(311,57),o(),E(),o()(),E(),S(312,200),i(313,"div",79)(314,"my-peertube-checkbox",201),S(315,104),i(316,"div"),s(317,58),o(),i(318,"span"),D(319,59),m(320,"a",202),y(),o(),E(),S(321,122),i(322,"div",125)(323,"label",203),s(324,60),o(),m(325,"input",204),u(326,Is,2,1,"div",88),o(),E(),o()(),E()()(),o()(),i(327,"div",106)(328,"div",73)(329,"h2"),s(330,61),o()(),i(331,"div",77)(332,"div",205)(333,"label",206),s(334,62),o(),m(335,"input",207),u(336,Os,2,1,"div",88),o(),i(337,"div",208),m(338,"my-peertube-checkbox",209),o()()(),i(339,"div",106)(340,"div",73)(341,"h2"),s(342,63),o(),i(343,"div",74),s(344,64),o()(),i(345,"div",77),S(346,210)(347,211),i(348,"div",79)(349,"label",212),s(350,65),o(),i(351,"div",213)(352,"p",214),s(353,66),o(),i(354,"p"),s(355,67),o()(),m(356,"input",215),u(357,Ns,2,1,"div",88),o(),E()(),o()(),E()),e&2&&(l("formGroup",t.form),a(17),W(t.getDefaultThemeLabel()),j(17),a(),l("ngForOf",t.availableThemes),a(4),l("items",t.defaultLandingPageOptions)("clearable",!1),a(),l("ngIf",t.formErrors.instance.defaultClientRoute),a(16),l("ngIf",t.formErrors.trending.videos.algorithms.default),a(11),l("ngIf",t.countExternalAuth()===0),a(),l("ngIf",t.countExternalAuth()>1),a(24),l("ngIf",t.formErrors.broadcastMessage.level),a(5),l("formError",t.formErrors["broadcastMessage.message"]),a(),l("ngIf",t.formErrors.broadcastMessage.message),a(15),l("ngIf",t.signupAlertMessage),a(3),l("ngClass",t.getDisabledSignupClass()),a(2),l("ngClass",t.getDisabledSignupClass()),a(),l("ngClass",t.getDisabledSignupClass()),a(4),l("ngClass",X(58,Dn,t.formErrors["signup.limit"])),a(2),W(t.form.value.signup.limit),j(108),a(),l("ngIf",t.formErrors.signup.limit),a(),l("ngIf",t.hasUnlimitedSignup()),a(),l("ngClass",t.getDisabledSignupClass()),a(4),l("ngClass",X(60,Dn,t.formErrors["signup.minimumAge"])),a(2),W(t.form.value.signup.minimumAge),j(117),a(),l("ngIf",t.formErrors.signup.minimumAge),a(5),l("items",t.getVideoQuotaOptions())("clearable",!1),a(),l("videoQuota",t.getUserVideoQuota()),a(),l("ngIf",t.formErrors.user.videoQuota),a(4),l("items",t.getVideoQuotaDailyOptions())("clearable",!1),a(),l("ngIf",t.formErrors.user.videoQuotaDaily),a(21),l("ngIf",t.formErrors.import.concurrency),a(16),l("hidden",t.isImportVideosHttpEnabled()),a(27),l("ngClass",t.getTranscriptionRunnerDisabledClass()),a(15),l("ngClass",X(62,Dn,t.formErrors["videoChannels.maxPerUser"])),a(2),W(t.form.value.videoChannels.maxPerUser),j(211),a(),l("ngIf",t.formErrors.videoChannels.maxPerUser),a(30),l("ngClass",t.getDisabledSearchIndexClass()),a(3),l("ngClass",X(64,Dn,t.formErrors["search.searchIndex.url"])),a(),l("ngIf",t.formErrors.search.searchIndex.url),a(2),l("ngClass",t.getDisabledSearchIndexClass()),a(2),l("ngClass",t.getDisabledSearchIndexClass()),a(26),l("ngClass",t.getDisabledExportUsersClass()),a(5),l("items",t.exportMaxUserVideoQuotaOptions)("clearable",!1),a(),l("ngIf",t.formErrors.export.users.maxUserVideoQuota),a(),l("ngClass",t.getDisabledExportUsersClass()),a(3),l("items",t.exportExpirationOptions)("clearable",!1)("searchable",!1),a(3),l("ngIf",t.formErrors.export.users.exportExpiration),a(33),l("ngClass",X(66,ts,!t.isAutoFollowIndexEnabled())),a(3),l("ngClass",X(68,Dn,t.formErrors["followings.instance.autoFollowIndex.indexUrl"])),a(),l("ngIf",t.formErrors.followings.instance.autoFollowIndex.indexUrl),a(9),l("ngClass",X(70,Dn,t.formErrors["admin.email"])),a(),l("ngIf",t.formErrors.admin.email),a(20),l("ngClass",X(72,Dn,t.formErrors["services.twitter.username"])),a(),l("ngIf",t.formErrors.services.twitter.username));},dependencies:[ce,Ft,ht,Ve,En,bt,Se,Me,li,Pe,fe,ke,Rt,Le,Ne,xt,B,et,en,Wn,le,An,Nn],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var $i=eo;var yn=class yn{getTranscodingResolutions(){return[{id:"0p",label:"\u50C5\u97F3\u8A0A",description:"\u5FC5\u9808\u555F\u7528\u300C\u5206\u5272\u97F3\u8A0A\u8207\u8996\u8A0A\u300D\uFF0CPeerTube \u64AD\u653E\u7A0B\u5F0F\u624D\u80FD\u5411\u4F7F\u7528\u8005\u63D0\u51FA\u300C\u50C5\u97F3\u8A0A\u300D\u89E3\u6790\u5EA6"},{id:"144p",label:"144p"},{id:"240p",label:"240p"},{id:"360p",label:"360p"},{id:"480p",label:"480p"},{id:"720p",label:"720p"},{id:"1080p",label:"1080p"},{id:"1440p",label:"1440p"},{id:"2160p",label:"2160p"}];}isTranscodingEnabled(r){return r.value.transcoding.enabled===!0;}isHLSEnabled(r){return r.value.transcoding.hls.enabled===!0;}isRemoteRunnerVODEnabled(r){return r.value.transcoding.remoteRunners.enabled===!0;}isRemoteRunnerLiveEnabled(r){return r.value.live.transcoding.remoteRunners.enabled===!0;}isStudioEnabled(r){return r.value.videoStudio.enabled===!0;}isLiveEnabled(r){return r.value.live.enabled===!0;}isLiveTranscodingEnabled(r){return r.value.live.transcoding.enabled===!0;}getTotalTranscodingThreads(r){let e=r.value.transcoding.enabled,t=r.value.transcoding.threads,_=r.value.live.transcoding.enabled,d=r.value.live.transcoding.threads,g=!e||+t>0;g&&(g=!_||+d>0);let O=0;return e&&(O+=+t||1),_&&(O+=+d||1),{value:O,atMost:g,unit:me("{value, plural, =1 {\u500B\u57F7\u884C\u7DD2} other {\u500B\u57F7\u884C\u7DD2}}",{value:O})};}};c(yn,"\u0275fac",function(e){return new(e||yn)();}),c(yn,"\u0275prov",qe({token:yn,factory:yn.ɵfac}));var on=yn;var al={VALIDATORS:[se.required],MESSAGES:{required:"\u7AD9\u81FA\u540D\u7A31\u5FC5\u586B\u3002"}},_l={VALIDATORS:[se.maxLength(250)],MESSAGES:{maxlength:"\u7C21\u77ED\u63CF\u8FF0\u4E0D\u5F97\u8D85\u904E 250 \u500B\u5B57\u5143\u3002"}},ll={VALIDATORS:[se.required],MESSAGES:{required:"Twitter \u4F7F\u7528\u8005\u540D\u7A31\u5FC5\u586B\u3002"}},ni={VALIDATORS:[se.required,se.min(1),se.pattern("[0-9]+")],MESSAGES:{required:"\u9700\u8981\u5FEB\u53D6\u5927\u5C0F\u3002",min:"\u5FEB\u53D6\u5927\u5C0F\u5FC5\u9808\u5927\u65BC 1\u3002",pattern:"\u5FEB\u53D6\u5927\u5C0F\u5FC5\u9808\u70BA\u6578\u5B57\u3002"}},sl={VALIDATORS:[se.required,se.min(-1),se.pattern("-?[0-9]+")],MESSAGES:{required:"\u8A3B\u518A\u9650\u5236\u5FC5\u586B\u3002",min:"\u8A3B\u518A\u9650\u5236\u5FC5\u9808\u5927\u65BC 1\u3002\u4F7F\u7528 -1 \u4EE5\u505C\u7528\u3002",pattern:"\u8A3B\u518A\u9650\u5236\u5FC5\u9808\u70BA\u6578\u5B57\u3002"}},cl={VALIDATORS:[se.required,se.min(1),se.pattern("[0-9]+")],MESSAGES:{required:"\u8A3B\u518A\u6700\u4F4E\u5E74\u9F61\u662F\u5FC5\u8981\u7684\u3002",min:"\u8A3B\u518A\u6700\u4F4E\u5E74\u9F61\u5FC5\u9808\u5927\u65BC1\u3002",pattern:"\u8A3B\u518A\u6700\u4F4E\u5E74\u9F61\u5FC5\u9808\u662F\u6578\u5B57\u3002"}},dl={VALIDATORS:[se.required,se.email],MESSAGES:{required:"\u7BA1\u7406\u54E1\u96FB\u5B50\u90F5\u4EF6\u5FC5\u586B\u3002",email:"\u7BA1\u7406\u54E1\u96FB\u5B50\u90F5\u4EF6\u5FC5\u9808\u6709\u6548\u3002"}},Pr={VALIDATORS:[se.required,se.min(0)],MESSAGES:{required:"\u8F49\u63DB\u7DE8\u78BC\u57F7\u884C\u7DD2\u5FC5\u586B\u3002",min:"\u8F49\u63DB\u7DE8\u78BC\u57F7\u884C\u7DD2\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0\u3002"}},pl={VALIDATORS:[se.required,se.min(-1)],MESSAGES:{required:"\u9700\u8981\u6700\u9577\u6709\u6548\u6642\u9593\u3002",min:"\u6700\u5927\u76F4\u64AD\u6301\u7E8C\u6642\u9593\u5FC5\u9808\u5927\u65BC\u7B49\u65BC -1\u3002"}},ml={VALIDATORS:[se.required,se.min(-1)],MESSAGES:{required:"\u9700\u8981\u6700\u9577\u7AD9\u53F0\u6709\u6548\u6642\u9593\u3002",min:"\u6700\u5927\u7AD9\u53F0\u76F4\u64AD\u6578\u5FC5\u9808\u5927\u65BC\u7B49\u65BC -1\u3002"}},ul={VALIDATORS:[se.required,se.min(-1)],MESSAGES:{required:"\u9700\u8981\u6700\u9577\u4F7F\u7528\u8005\u6709\u6548\u6642\u9593\u3002",min:"\u6700\u5927\u4F7F\u7528\u8005\u76F4\u64AD\u6578\u5FC5\u9808\u5927\u65BC\u7B49\u65BC -1\u3002"}},gl={VALIDATORS:[se.required,se.min(1),se.pattern("[0-9]+")],MESSAGES:{required:"\u6BCF\u500B\u4F7F\u7528\u8005\u6700\u591A\u5F71\u7247\u983B\u9053\u6578\u70BA\u5FC5\u586B\u3002",min:"\u6BCF\u500B\u4F7F\u7528\u8005\u6700\u591A\u5F71\u7247\u983B\u9053\u6578\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 1\u3002",pattern:"\u6BCF\u500B\u4F7F\u7528\u8005\u6700\u591A\u5F71\u7247\u983B\u9053\u6578\u5FC5\u9808\u70BA\u6578\u5B57\u3002"}},Ar={VALIDATORS:[se.required,se.min(1)],MESSAGES:{required:"\u9700\u8981\u4E26\u884C\u3002",min:"\u4E26\u884C\u6578\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 1\u3002"}},Cl={VALIDATORS:[se.pattern(/^https:\/\//)],MESSAGES:{pattern:"\u7D22\u5F15 URL \u5FC5\u9808\u70BA URL"}},Sl={VALIDATORS:[se.pattern(/^https?:\/\//)],MESSAGES:{pattern:"\u641C\u5C0B\u7D22\u5F15 URL \u5FC5\u9808\u70BA URL"}},El={VALIDATORS:[se.required,se.min(1)],MESSAGES:{required:"\u532F\u51FA\u6709\u9650\u671F\u9650\u70BA\u5FC5\u586B\u3002",min:"\u532F\u51FA\u6709\u6548\u671F\u9650\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 1\u3002"}},Tl={VALIDATORS:[se.required,se.min(1)],MESSAGES:{required:"\u9700\u8981\u6700\u5927\u4F7F\u7528\u8005\u5F71\u7247\u914D\u984D\u3002",min:"\u6700\u5927\u4F7F\u7528\u8005\u5F71\u7247\u914D\u984D\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 1\u3002"}};var to=class to{};c(to,"\u0275fac",function(e){return new(e||to)();}),c(to,"\u0275cmp",h({type:to,selectors:[["my-custom-markup-help"]],standalone:!0,features:[v],decls:4,vars:0,consts:()=>{let r;return r=""+"\uFFFD#2\uFFFD"+"Markdown \u76F8\u5BB9\u7248\u672C"+"[\uFFFD/#2\uFFFD|\uFFFD/#3\uFFFD]"+"\u4E5F\u652F\u63F4"+"\uFFFD#3\uFFFD"+"\u81EA\u8A02 PeerTube HTML \u6A19\u7C64"+"[\uFFFD/#2\uFFFD|\uFFFD/#3\uFFFD]"+"",r=Ce(r),[r,["href","https://en.wikipedia.org/wiki/Markdown#Example","target","_blank","rel","noreferrer noopener"],["href","https://docs.joinpeertube.org/api/custom-client-markup","target","_blank","rel","noreferrer noopener"]];},template:function(e,t){e&1&&(S(0),D(1,0),m(2,"a",1)(3,"a",2),y(),E());},encapsulation:2}));var no=to;function fs(n,r){if(n&1&&(i(0,"div",12),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instanceCustomHomepage.content);}}var oo=class oo{constructor(r){this.customMarkup=r;c(this,"form");c(this,"formErrors");c(this,"customMarkdownRenderer");}getCustomMarkdownRenderer(){return this.customMarkup.getCustomMarkdownRenderer();}};c(oo,"\u0275fac",function(e){return new(e||oo)(T(Hn));}),c(oo,"\u0275cmp",h({type:oo,selectors:[["my-edit-homepage"]],inputs:{form:"form",formErrors:"formErrors"},standalone:!0,features:[v],decls:14,vars:5,consts:()=>{let r;r="\u7AD9\u53F0\u9996\u9801";let e;return e="\u9996\u9801",[r,e,[3,"formGroup"],["formGroupName","instanceCustomHomepage"],[1,"homepage","pt-two-cols","mt-5"],[1,"title-col"],[1,"content-col"],[1,"form-group"],["for","instanceCustomHomepageContent"],[1,"label-small-info"],["name","instanceCustomHomepageContent","formControlName","content","dir","ltr",3,"customMarkdownRenderer","debounceTime","formError"],["class","form-error","role","alert",4,"ngIf"],["role","alert",1,"form-error"]];},template:function(e,t){e&1&&(S(0,2)(1,3),i(2,"div",4)(3,"div",5)(4,"h2"),s(5,0),o()(),i(6,"div",6)(7,"div",7)(8,"label",8),s(9,1),o(),i(10,"div",9),m(11,"my-custom-markup-help"),o(),m(12,"my-markdown-textarea",10),u(13,fs,2,1,"div",11),o()()(),E()()),e&2&&(l("formGroup",t.form),a(12),l("customMarkdownRenderer",t.getCustomMarkdownRenderer())("debounceTime",500)("formError",t.formErrors["instanceCustomHomepage.content"]),a(),l("ngIf",t.formErrors.instanceCustomHomepage.content));},dependencies:[ce,Se,Me,Pe,fe,ke,Rt,no,Wn,B],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var xi=oo;var Il=n=>({"input-error":n});function Ps(n,r){if(n&1&&(i(0,"div",90),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.name);}}function As(n,r){if(n&1&&(i(0,"div",90),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.shortDescription);}}function Rs(n,r){n&1&&(S(0),s(1,33),E());}function bs(n,r){n&1&&(S(0),D(1,34),m(2,"br"),y(),E());}function Fs(n,r){n&1&&(S(0),D(1,35),m(2,"strong")(3,"strong"),y(),E());}function hs(n,r){if(n&1&&(i(0,"div",90),C(1),o()),n&2){let e=p();a(),I(e.formErrors.instance.defaultNSFWPolicy);}}var io=class io{constructor(r,e,t,_){this.customMarkup=r;this.notifier=e;this.instanceService=t;this.server=_;c(this,"form");c(this,"formErrors");c(this,"languageItems",[]);c(this,"categoryItems",[]);c(this,"instanceBannerUrl");c(this,"instanceAvatars",[]);c(this,"serverConfig");}get instanceName(){return this.server.getHTMLConfig().instance.name;}ngOnInit(){this.serverConfig=this.server.getHTMLConfig(),this.updateActorImages();}getCustomMarkdownRenderer(){return this.customMarkup.getCustomMarkdownRenderer();}onBannerChange(r){this.instanceService.updateInstanceBanner(r).subscribe({next:()=>{this.notifier.success("\u6A6B\u5E45\u5DF2\u8B8A\u66F4\u3002"),this.resetActorImages();},error:e=>Nr({err:e,name:"\u6A6B\u5E45",notifier:this.notifier})});}onBannerDelete(){this.instanceService.deleteInstanceBanner().subscribe({next:()=>{this.notifier.success("\u6A6B\u5E45\u5DF2\u522A\u9664\u3002"),this.resetActorImages();},error:r=>this.notifier.error(r.message)});}onAvatarChange(r){this.instanceService.updateInstanceAvatar(r).subscribe({next:()=>{this.notifier.success("\u5927\u982D\u8CBC\u5DF2\u8B8A\u66F4\u3002"),this.resetActorImages();},error:e=>Nr({err:e,name:"\u5927\u982D\u7167",notifier:this.notifier})});}onAvatarDelete(){this.instanceService.deleteInstanceAvatar().subscribe({next:()=>{this.notifier.success("\u5DF2\u522A\u9664\u5927\u982D\u7167\u3002"),this.resetActorImages();},error:r=>this.notifier.error(r.message)});}updateActorImages(){var r;this.instanceBannerUrl=(r=t_(this.serverConfig.instance.banners,"width"))==null?void 0:r.path,this.instanceAvatars=this.serverConfig.instance.avatars;}resetActorImages(){this.server.resetConfig().subscribe(r=>{this.serverConfig=r,this.updateActorImages();});}};c(io,"\u0275fac",function(e){return new(e||io)(T(Hn),T(K),T(R_),T(Ge));}),c(io,"\u0275cmp",h({type:io,selectors:[["my-edit-instance-information"]],inputs:{form:"form",formErrors:"formErrors",languageItems:"languageItems",categoryItems:"categoryItems"},standalone:!0,features:[v],decls:137,vars:29,consts:()=>{let r;r="\u52A0\u5165\u65B0\u5206\u985E";let e;e="\u52A0\u5165\u65B0\u8A9E\u8A00";let t;t="\u7AD9\u81FA";let _;_="\u65B9\u5F62\u5716\u793A";let d;d="\u65B9\u5F62\u5716\u793A\u53EF\u4EE5\u5728\u60A8\u7684\u81EA\u8A02\u9996\u9801\u4E0A\u4F7F\u7528\u3002";let g;g="\u6A6B\u5E45";let O;O="\u6A6B\u5E45\u986F\u793A\u5728\u95DC\u65BC\u3001\u767B\u5165\u8207\u8A3B\u518A\u9801\u9762\u4E2D\uFF0C\u4E26\u5728\u60A8\u7684\u81EA\u8A02\u9996\u9801\u4E0A\u4F7F\u7528\u3002";let R;R="\u5176\u4E5F\u53EF\u4EE5\u986F\u793A\u5728\u5916\u90E8\u7DB2\u7AD9\u4E0A\u4EE5\u63A8\u5EE3\u60A8\u7684\u7AD9\u53F0\uFF0C\u4F8B\u5982 "+"\uFFFD#22\uFFFD"+"JoinPeerTube.org"+"\uFFFD/#22\uFFFD"+".";let N;N="\u540D\u7A31";let b;b="\u77ED\u63CF\u8FF0";let G;G="\u63CF\u8FF0";let F;F="\u4E3B\u8981\u7AD9\u81FA\u5206\u985E";let L;L="\u60A8\u8207\u60A8\u7684\u677F\u4E3B\u4E3B\u8981\u4F7F\u7528\u7684\u8A9E\u8A00";let $;$="\u5BE9\u6838\u8207 NSFW";let H;H="\u7BA1\u7406"+"\uFFFD#56\uFFFD"+"\u4F7F\u7528\u8005"+"\uFFFD/#56\uFFFD"+"\u4EE5\u5EFA\u69CB\u7BA1\u7406\u5718\u968A\u3002 ";let z;z="\u5305\u542B\u654F\u611F\u5167\u5BB9\u7684\u5F71\u7247\u653F\u7B56";let V;V="\u96B1\u85CF";let x;x="\u6A21\u7CCA\u7E2E\u5716";let Y;Y="\u986F\u793A";let oe;oe="\u689D\u6B3E";let we;we="\u884C\u70BA\u5B88\u5247";let ae;ae="\u7BA1\u7406\u8CC7\u8A0A";let Be;Be="\u8AB0\u7BA1\u7406\u6B64\u7AD9\u81FA\uFF1F\u5C0D NSFW \u5F71\u7247\u6709\u4F55\u539F\u5247\uFF1F\u653F\u6CBB\u5F71\u7247\u5462\uFF1F\u7B49\u7B49";let We;We="\u60A8\u8207\u60A8\u7684\u7AD9\u81FA";let je;je="\u8AB0\u5728\u7BA1\u7406\u7AD9\u81FA\uFF1F";let He;He="\u4E00\u500B\u4EBA\uFF1F\u975E\u71DF\u5229\u7D44\u7E54\uFF1F\u9084\u662F\u4E00\u9593\u516C\u53F8\uFF1F";let Je;Je="\u70BA\u4EC0\u9EBC\u60A8\u8981\u5EFA\u7ACB\u6B64\u7AD9\u81FA\uFF1F";let Z;Z="\u8981\u5206\u4EAB\u60A8\u7684\u500B\u4EBA\u5F71\u7247\uFF1F\u9084\u662F\u8981\u958B\u653E\u8A3B\u518A\u4E26\u8B93\u4EBA\u5011\u53EF\u4EE5\u4E0A\u50B3\u4ED6\u5011\u60F3\u8981\u4E0A\u50B3\u7684\u5F71\u7247\u5462\uFF1F";let it;it="\u60A8\u6253\u7B97\u7DAD\u8B77\u6B64\u7AD9\u81FA\u591A\u4E45\uFF1F";let Ye;Ye="\u9019\u5C0D\u60F3\u8981\u5728\u60A8\u7684\u7AD9\u81FA\u4E0A\u8A3B\u518A\u7684\u4F7F\u7528\u8005\u4F86\u8AAA\u662F\u5F88\u91CD\u8981\u7684";let rt;rt="\u60A8\u5C0D PeerTube \u4F3A\u670D\u5668\u6709\u4F55\u8CA1\u52D9\u898F\u5283\uFF1F";let at;at="\u7528\u81EA\u5DF1\u7684\u8CC7\u91D1\u55CE\uFF1F\u4F7F\u7528\u8005\u6350\u6B3E\uFF1F\u5EE3\u544A\uFF1F";let Ke;Ke="\u5176\u4ED6\u8CC7\u8A0A";let q;q="\u7AD9\u81FA\u5728\u4F55\u7A2E\u4F3A\u670D\u5668\uFF0F\u786C\u9AD4\u4E0A\u57F7\u884C\uFF1F";let U;U="\u4F8B\u5982\uFF1A2vCore 2GB RAM\uFF0C\u6307\u5411\u60A8\u79DF\u7528\u4F3A\u670D\u5668\u7684\u76F4\u63A5\u9023\u7D50\u7B49\u3002";let Jt;Jt="\u672C\u7AD9\u81FA\u70BA\u654F\u611F\u8207 NSFW \u5167\u5BB9\u5C08\u7528";let un;un="\u555F\u7528\u8A72\u9078\u9805\u5C07\u8B93\u5176\u4ED6\u7BA1\u7406\u54E1\u77E5\u9053\u60A8\u4E3B\u8981\u5171\u540C\u5206\u4EAB\u654F\u611F\u5167\u5BB9\u3002"+"\uFFFD#2\uFFFD\uFFFD/#2\uFFFD"+"\u6B64\u5916\uFF0C\u9810\u8A2D\u6703\u81EA\u52D5\u52FE\u9078\u5F71\u7247\u4E0A\u50B3\u7684 NSFW \u6838\u53D6\u65B9\u584A\u3002 ";let Kt;return Kt="\u6709"+"[\uFFFD#2\uFFFD|\uFFFD#3\uFFFD]"+"\u96B1\u85CF"+"[\uFFFD/#2\uFFFD|\uFFFD/#3\uFFFD]"+"\u6216"+"[\uFFFD#2\uFFFD|\uFFFD#3\uFFFD]"+"\u6A21\u7CCA\u7E2E\u5716"+"[\uFFFD/#2\uFFFD|\uFFFD/#3\uFFFD]"+"\uFF0C\u8981\u89C0\u770B\u5F71\u7247\u6642\u5C07\u6703\u8ACB\u6C42\u78BA\u8A8D\u3002 ",Kt=Ce(Kt),[t,_,d,g,O,R,N,b,G,F,L,$,H,z,V,x,Y,oe,we,ae,Be,We,je,He,Je,Z,it,Ye,rt,at,Ke,q,U,Jt,un,Kt,[3,"formGroup"],["formGroupName","instance"],[1,"pt-two-cols","mt-5"],[1,"title-col"],[1,"content-col"],[1,"form-group"],["for","avatarfile"],[1,"label-small-info"],[1,"mb-0"],["actorType","account","previewImage","false","displayUsername","false",1,"d-block","mb-4",3,"avatarChange","avatarDelete","username","avatars"],["for","bannerfile"],["target","_blank","href","https://joinpeertube.org/instances"],[1,"d-block","mb-4",3,"bannerChange","bannerDelete","previewImage","bannerUrl"],["for","instanceName"],["type","text","id","instanceName","formControlName","name",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["for","instanceShortDescription"],["id","instanceShortDescription","formControlName","shortDescription",1,"form-control","small",3,"ngClass"],["for","instanceDescription"],["name","instanceDescription","formControlName","description",3,"customMarkdownRenderer","debounceTime","formError"],["for","instanceCategories"],["id","instanceCategories","formControlName","categories","placeholder",r,3,"availableItems","selectableGroup"],["for","instanceLanguages"],["id","instanceLanguages","formControlName","languages","placeholder",e,3,"availableItems","selectableGroup"],[1,"pt-two-cols","mt-4"],[1,"inner-form-description"],["routerLink","/admin/users",1,"link-orange"],["inputName","instanceIsNSFW","formControlName","isNSFW"],["ptTemplate","label"],["ptTemplate","help"],["for","instanceDefaultNSFWPolicy"],["ptTemplate","customHtml"],[1,"peertube-select-container"],["id","instanceDefaultNSFWPolicy","formControlName","defaultNSFWPolicy",1,"form-control"],["value","do_not_list"],["value","blur"],["value","display"],["for","instanceTerms"],["helpType","markdownText"],["name","instanceTerms","formControlName","terms","markdownType","enhanced",3,"formError"],["for","instanceCodeOfConduct"],["name","instanceCodeOfConduct","formControlName","codeOfConduct","markdownType","enhanced",3,"formError"],["for","instanceModerationInformation"],["name","instanceModerationInformation","formControlName","moderationInformation","markdownType","enhanced",3,"formError"],["for","instanceAdministrator"],["name","instanceAdministrator","formControlName","administrator","markdownType","enhanced",3,"formError"],["for","instanceCreationReason"],["name","instanceCreationReason","formControlName","creationReason","markdownType","enhanced",3,"formError"],["for","instanceMaintenanceLifetime"],["name","instanceMaintenanceLifetime","formControlName","maintenanceLifetime","markdownType","enhanced",3,"formError"],["for","instanceBusinessModel"],["name","instanceBusinessModel","formControlName","businessModel","markdownType","enhanced",3,"formError"],["for","instanceHardwareInformation"],["name","instanceHardwareInformation","formControlName","hardwareInformation","markdownType","enhanced",3,"formError"],["role","alert",1,"form-error"]];},template:function(e,t){e&1&&(S(0,36)(1,37),i(2,"div",38)(3,"div",39)(4,"h2"),s(5,0),o()(),i(6,"div",40)(7,"div",41)(8,"label",42),s(9,1),o(),i(10,"div",43)(11,"p",44),s(12,2),o()(),i(13,"my-actor-avatar-edit",45),M("avatarChange",function(d){return t.onAvatarChange(d);})("avatarDelete",function(){return t.onAvatarDelete();}),o()(),i(14,"div",41)(15,"label",46),s(16,3),o(),i(17,"div",43)(18,"p",44),s(19,4),o(),i(20,"p"),D(21,5),m(22,"a",47),y(),o()(),i(23,"my-actor-banner-edit",48),M("bannerChange",function(d){return t.onBannerChange(d);})("bannerDelete",function(){return t.onBannerDelete();}),o()(),i(24,"div",41)(25,"label",49),s(26,6),o(),m(27,"input",50),u(28,Ps,2,1,"div",51),o(),i(29,"div",41)(30,"label",52),s(31,7),o(),m(32,"textarea",53),u(33,As,2,1,"div",51),o(),i(34,"div",41)(35,"label",54),s(36,8),o(),i(37,"div",43),m(38,"my-custom-markup-help"),o(),m(39,"my-markdown-textarea",55),o(),i(40,"div",41)(41,"label",56),s(42,9),o(),i(43,"div"),m(44,"my-select-checkbox",57),o()(),i(45,"div",41)(46,"label",58),s(47,10),o(),i(48,"div"),m(49,"my-select-checkbox",59),o()()()(),i(50,"div",60)(51,"div",39)(52,"h2"),s(53,11),o(),i(54,"div",61),D(55,12),m(56,"a",62),y(),o()(),i(57,"div",40)(58,"div",41)(59,"my-peertube-checkbox",63),u(60,Rs,2,0,"ng-template",64)(61,bs,3,0,"ng-template",65),o()(),i(62,"div",41)(63,"label",66),s(64,13),o(),i(65,"my-help"),u(66,Fs,4,0,"ng-template",67),o(),i(67,"div",68)(68,"select",69)(69,"option",70),s(70,14),o(),i(71,"option",71),s(72,15),o(),i(73,"option",72),s(74,16),o()()(),u(75,hs,2,1,"div",51),o(),i(76,"div",41)(77,"label",73),s(78,17),o(),m(79,"my-help",74)(80,"my-markdown-textarea",75),o(),i(81,"div",41)(82,"label",76),s(83,18),o(),m(84,"my-help",74)(85,"my-markdown-textarea",77),o(),i(86,"div",41)(87,"label",78),s(88,19),o(),m(89,"my-help",74),i(90,"div",43),s(91,20),o(),m(92,"my-markdown-textarea",79),o()()(),i(93,"div",60)(94,"div",39)(95,"h2"),s(96,21),o()(),i(97,"div",40)(98,"div",41)(99,"label",80),s(100,22),o(),m(101,"my-help",74),i(102,"div",43),s(103,23),o(),m(104,"my-markdown-textarea",81),o(),i(105,"div",41)(106,"label",82),s(107,24),o(),m(108,"my-help",74),i(109,"div",43),s(110,25),o(),m(111,"my-markdown-textarea",83),o(),i(112,"div",41)(113,"label",84),s(114,26),o(),m(115,"my-help",74),i(116,"div",43),s(117,27),o(),m(118,"my-markdown-textarea",85),o(),i(119,"div",41)(120,"label",86),s(121,28),o(),m(122,"my-help",74),i(123,"div",43),s(124,29),o(),m(125,"my-markdown-textarea",87),o()()(),i(126,"div",60)(127,"div",39)(128,"h2"),s(129,30),o()(),i(130,"div",40)(131,"div",41)(132,"label",88),s(133,31),o(),i(134,"div",43),s(135,32),o(),m(136,"my-markdown-textarea",89),o()()(),E()()),e&2&&(l("formGroup",t.form),a(13),l("username",t.instanceName)("avatars",t.instanceAvatars),a(10),l("previewImage",!1)("bannerUrl",t.instanceBannerUrl),a(4),l("ngClass",X(25,Il,t.formErrors.instance.name)),a(),l("ngIf",t.formErrors.instance.name),a(4),l("ngClass",X(27,Il,t.formErrors["instance.shortDescription"])),a(),l("ngIf",t.formErrors.instance.shortDescription),a(6),l("customMarkdownRenderer",t.getCustomMarkdownRenderer())("debounceTime",500)("formError",t.formErrors["instance.description"]),a(5),l("availableItems",t.categoryItems)("selectableGroup",!1),a(5),l("availableItems",t.languageItems)("selectableGroup",!1),a(26),l("ngIf",t.formErrors.instance.defaultNSFWPolicy),a(5),l("formError",t.formErrors["instance.terms"]),a(5),l("formError",t.formErrors["instance.codeOfConduct"]),a(7),l("formError",t.formErrors["instance.moderationInformation"]),a(12),l("formError",t.formErrors["instance.administrator"]),a(7),l("formError",t.formErrors["instance.creationReason"]),a(7),l("formError",t.formErrors["instance.maintenanceLifetime"]),a(7),l("formError",t.formErrors["instance.businessModel"]),a(11),l("formError",t.formErrors["instance.hardwareInformation"]));},dependencies:[ce,Ft,ht,Ve,bt,Se,Me,Pe,fe,ke,Rt,Jn,V_,le,B,no,Wn,Ni,Le,et,Dt,en],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var Gi=io;function vs(n,r){n&1&&(S(0),s(1,19),E());}function Ds(n,r){if(n&1&&(i(0,"div",68),C(1),o()),n&2){let e=p();a(),I(e.formErrors.live.maxInstanceLives);}}function ys(n,r){if(n&1&&(i(0,"div",68),C(1),o()),n&2){let e=p();a(),I(e.formErrors.live.maxUserLives);}}function Ls(n,r){if(n&1&&(i(0,"div",68),C(1),o()),n&2){let e=p();a(),I(e.formErrors.live.maxDuration);}}function $s(n,r){n&1&&(S(0),s(1,20),E());}function xs(n,r){if(n&1&&m(0,"div",71),n&2){let e=p(2).$implicit;l("innerHTML",e.description,an);}}function Gs(n,r){n&1&&u(0,xs,1,1,"ng-template",70);}function Us(n,r){if(n&1&&(i(0,"div",29)(1,"my-peertube-checkbox",69),u(2,Gs,1,0,null,63),o()()),n&2){let e=r.$implicit,t=p();a(),qt("labelText",e.label),l("inputName",t.getResolutionKey(e.id))("formControlName",e.id),a(),l("ngIf",e.description);}}function ws(n,r){if(n&1&&(S(0),s(1,21),E()),n&2){let e=p();a(),W(e.getTotalTranscodingThreads().value)(e.getTotalTranscodingThreads().unit),j(1);}}function Vs(n,r){if(n&1&&(S(0),s(1,22),E()),n&2){let e=p();a(),W(e.getTotalTranscodingThreads().value)(e.getTotalTranscodingThreads().unit),j(1);}}function ks(n,r){if(n&1&&(i(0,"div",68),C(1),o()),n&2){let e=p();a(),I(e.formErrors.live.transcoding.threads);}}function zs(n,r){if(n&1&&(i(0,"div",68),C(1),o()),n&2){let e=p();a(),I(e.formErrors.live.transcoding.profile);}}var ro=class ro{constructor(r,e){this.configService=r;this.editConfigurationService=e;c(this,"form");c(this,"formErrors");c(this,"serverConfig");c(this,"transcodingThreadOptions",[]);c(this,"transcodingProfiles",[]);c(this,"liveMaxDurationOptions",[]);c(this,"liveResolutions",[]);}ngOnInit(){this.transcodingThreadOptions=this.configService.transcodingThreadOptions,this.liveMaxDurationOptions=[{id:-1,label:"\u7121\u9650\u5236"},{id:1e3*3600,label:"1\u5C0F\u6642"},{id:1e3*3600*3,label:"3\u5C0F\u6642"},{id:1e3*3600*5,label:"5\u5C0F\u6642"},{id:1e3*3600*10,label:"10\u5C0F\u6642"}],this.liveResolutions=this.editConfigurationService.getTranscodingResolutions();}ngOnChanges(r){r.serverConfig&&(this.transcodingProfiles=this.buildAvailableTranscodingProfile());}buildAvailableTranscodingProfile(){return this.serverConfig.live.transcoding.availableProfiles.map(e=>e==="default"?{id:e,label:"\u9810\u8A2D",description:"x264\uFF0C\u4EE5\u76F8\u5BB9\u6700\u591A\u88DD\u7F6E\u70BA\u76EE\u6A19"}:{id:e,label:e});}getResolutionKey(r){return"live.transcoding.resolutions."+r;}getLiveRTMPPort(){return this.serverConfig.live.rtmp.port;}isLiveEnabled(){return this.editConfigurationService.isLiveEnabled(this.form);}isRemoteRunnerLiveEnabled(){return this.editConfigurationService.isRemoteRunnerLiveEnabled(this.form);}getDisabledLiveClass(){return{"disabled-checkbox-extra":!this.isLiveEnabled()};}getDisabledLiveTranscodingClass(){return{"disabled-checkbox-extra":!this.isLiveEnabled()||!this.isLiveTranscodingEnabled()};}getDisabledLiveLocalTranscodingClass(){return{"disabled-checkbox-extra":!this.isLiveEnabled()||!this.isLiveTranscodingEnabled()||this.isRemoteRunnerLiveEnabled()};}isLiveTranscodingEnabled(){return this.editConfigurationService.isLiveTranscodingEnabled(this.form);}getTotalTranscodingThreads(){return this.editConfigurationService.getTotalTranscodingThreads(this.form);}};c(ro,"\u0275fac",function(e){return new(e||ro)(T(pt),T(on));}),c(ro,"\u0275cmp",h({type:ro,selectors:[["my-edit-live-configuration"]],inputs:{form:"form",formErrors:"formErrors",serverConfig:"serverConfig"},standalone:!0,features:[gn,v],decls:96,vars:29,consts:()=>{let r;r="\u5141\u8A31\u60A8\u7684\u4F7F\u7528\u8005\u81EA\u52D5\u767C\u4F48\u4ED6\u5011\u7684\u76F4\u64AD\u7684\u91CD\u64AD";let e;e="\u5141\u8A31\u60A8\u7684\u4F7F\u7528\u8005\u8B8A\u66F4\u76F4\u64AD\u5EF6\u9072";let t;t="\u540C\u6642\u8F49\u78BC\u539F\u59CB\u89E3\u6790\u5EA6";let _;_="\u70BA\u76F4\u64AD\u555F\u7528\u9060\u7AEF\u57F7\u884C\u5668";let d;d="\u76F4\u64AD";let g;g="\u8B93\u60A8\u7AD9\u53F0\u7684\u4F7F\u7528\u8005\u53EF\u4EE5\u9032\u884C\u76F4\u64AD\u4E32\u6D41\u3002";let O;O="\u26A0\uFE0F \u555F\u7528\u76F4\u64AD\u4E32\u6D41\u9700\u8981\u60A8\u5C0D\u4F7F\u7528\u8005\u7684\u4FE1\u4EFB\u8207\u984D\u5916\u7684\u5BE9\u6838\u5DE5\u4F5C";let R;R="\u82E5\u555F\u7528\uFF0C\u5247\u60A8\u7684\u4F3A\u670D\u5668\u5FC5\u9808\u5728\u9023\u7D50\u57E0 "+"\uFFFD0\uFFFD"+" \u4E0A\u63A5\u53D7\u9023\u5165\u7684 TCP \u6D41\u91CF";let N;N="\u4F4E\u5EF6\u9072\u505C\u7528 P2P\uFF0C\u9AD8\u5EF6\u9072\u53EF\u4EE5\u589E\u52A0 P2P \u6BD4\u4F8B";let b;b="\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u5EFA\u7ACB\u7684\u6700\u591A\u540C\u6642\u76F4\u64AD";let G;G="{VAR_PLURAL, plural, =1 {\u76F4\u64AD} other {\u76F4\u64AD}}",G=Ce(G,{VAR_PLURAL:"\uFFFD0\uFFFD"});let F;F="\u6BCF\u500B\u4F7F\u7528\u8005\u53EF\u540C\u6642\u5EFA\u7ACB\u7684\u6700\u591A\u540C\u6642\u76F4\u64AD";let L;L="{VAR_PLURAL, plural, =1 {\u76F4\u64AD} other {\u76F4\u64AD}}",L=Ce(L,{VAR_PLURAL:"\uFFFD0\uFFFD"});let $;$="\u6700\u5927\u76F4\u64AD\u6642\u9593";let H;H="\u8F49\u63DB\u7DE8\u78BC";let z;z="\u8207\u96A8\u9078\u8996\u8A0A\u8F49\u78BC\u76F8\u540C\uFF0C\u5C07\u76F4\u64AD\u4E32\u6D41\u8F49\u78BC\u70BA\u4EFB\u4F55\u88DD\u7F6E\u90FD\u53EF\u4EE5\u64AD\u653E\u7684\u4E32\u6D41\u5F62\u5F0F\u3002\u9700\u8981\u5F37\u5927\u7684 CPU \u4EE5\u53CA\u4E00\u4E9B\u5176\u4ED6\u786C\u9AD4\u3002";let V;V="\u8F38\u51FA\u683C\u5F0F";let x;x="\u8981\u751F\u6210\u7684\u76F4\u64AD\u89E3\u6790\u5EA6";let Y;Y="\u5373\u4F7F\u5176\u9AD8\u65BC\u60A8\u5DF2\u555F\u7528\u7684\u6700\u9AD8\u89E3\u6790\u5EA6";let oe;oe="\u4F7F\u7528"+"\uFFFD#80\uFFFD"+"\u9060\u7AEF\u57F7\u884C\u5668"+"\uFFFD/#80\uFFFD"+"\u4F86\u8655\u7406\u5373\u6642\u8F49\u63DB\u7DE8\u78BC\u3002\u9060\u7AEF\u57F7\u884C\u5668\u5FC5\u9808\u5148\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u8A3B\u518A\u3002 ";let we;we="\u76F4\u64AD\u8F49\u63DB\u7DE8\u78BC\u57F7\u884C\u7DD2";let ae;ae="\u5373\u6642\u8F49\u63DB\u7DE8\u78BC\u8A2D\u5B9A\u6A94";let Be;Be="\u53EF\u4EE5\u900F\u904E PeerTube \u5916\u639B\u7A0B\u5F0F\u65B0\u589E\u65B0\u7684\u5373\u6642\u8F49\u63DB\u7DE8\u78BC\u8A2D\u5B9A\u6A94";let We;We="\u5141\u8A31\u76F4\u64AD\u4E32\u6D41";let je;je="\u5DF2\u555F\u7528\u76F4\u64AD\u4E32\u6D41\u7684\u8F49\u78BC";let He;He="\u5C07\u6703\u6700\u591A\u4F7F\u7528 "+"\uFFFD0\uFFFD"+" "+"\uFFFD1\uFFFD"+" \u4F86\u9032\u884C\u96A8\u9078\u8996\u8A0A\u8F49\u78BC ";let Je;return Je="\u5C07\u6703\u6700\u5C11\u4F7F\u7528 "+"\uFFFD0\uFFFD"+" "+"\uFFFD1\uFFFD"+" \u4F86\u9032\u884C\u96A8\u9078\u8996\u8A0A\u8F49\u78BC ",[d,g,O,R,N,b,G,F,L,$,H,z,V,x,Y,oe,we,ae,Be,We,je,He,Je,[3,"formGroup"],[1,"pt-two-cols","mt-5"],[1,"title-col"],[1,"inner-form-description"],[1,"content-col"],["formGroupName","live"],[1,"form-group"],["inputName","liveEnabled","formControlName","enabled"],["ptTemplate","label"],["ngProjectAs","description",5,["description"]],["ngProjectAs","extra",5,["extra"]],[1,"form-group",3,"ngClass"],["inputName","liveAllowReplay","formControlName","allowReplay","labelText",r],["formGroupName","latencySetting",1,"form-group",3,"ngClass"],["inputName","liveLatencySettingEnabled","formControlName","enabled","labelText",e],["for","liveMaxInstanceLives"],[1,"ms-2","small","muted"],[1,"number-with-unit"],["type","number","name","liveMaxInstanceLives","formControlName","maxInstanceLives"],["class","form-error","role","alert",4,"ngIf"],["for","liveMaxUserLives"],["type","number","name","liveMaxUserLives","formControlName","maxUserLives"],["for","liveMaxDuration"],["labelForId","liveMaxDuration","formControlName","maxDuration","bindLabel","label","bindValue","value",3,"items","clearable","searchable"],[1,"pt-two-cols"],["formGroupName","transcoding"],["inputName","liveTranscodingEnabled","formControlName","enabled"],[1,"callout","callout-light","pt-2","mt-2","pb-0"],[1,"callout-title"],[3,"ngClass"],[1,"ms-2","mt-3"],[1,"mt-3"],["formGroupName","resolutions"],["class","form-group",4,"ngFor","ngForOf"],["inputName","liveTranscodingAlwaysTranscodeOriginalResolution","formControlName","alwaysTranscodeOriginalResolution","labelText",t],["formGroupName","remoteRunners",1,"form-group","mt-4",3,"ngClass"],["inputName","liveTranscodingRemoteRunnersEnabled","formControlName","enabled","labelText",_],["routerLink","/admin/system/runners/runners-list"],["for","liveTranscodingThreads"],[1,"small","muted","ms-1"],[4,"ngIf"],["id","liveTranscodingThreads","formControlName","threads",3,"items","clearable"],[1,"form-group","mt-4",3,"ngClass"],["for","liveTranscodingProfile"],["id","liveTranscodingProfile","formControlName","profile",3,"items","clearable"],["role","alert",1,"form-error"],[3,"inputName","formControlName","labelText"],["ptTemplate","help"],[3,"innerHTML"]];},template:function(e,t){e&1&&(S(0,23),i(1,"div",24)(2,"div",25)(3,"h2"),s(4,0),o(),i(5,"div",26),s(6,1),o()(),i(7,"div",27),S(8,28),i(9,"div",29)(10,"my-peertube-checkbox",30),u(11,vs,2,0,"ng-template",31),S(12,32),i(13,"div"),s(14,2),o(),i(15,"div"),s(16,3),o(),E(),S(17,33),i(18,"div",34),m(19,"my-peertube-checkbox",35),o(),i(20,"div",36)(21,"my-peertube-checkbox",37),S(22,32),s(23,4),E(),o()(),i(24,"div",34)(25,"label",38),s(26,5),o(),i(27,"span",39),C(28,'(-1 for "unlimited")'),o(),i(29,"div",40),m(30,"input",41),i(31,"span"),s(32,6),o()(),u(33,Ds,2,1,"div",42),o(),i(34,"div",34)(35,"label",43),s(36,7),o(),i(37,"span",39),C(38,'(-1 for "unlimited")'),o(),i(39,"div",40),m(40,"input",44),i(41,"span"),s(42,8),o()(),u(43,ys,2,1,"div",42),o(),i(44,"div",34)(45,"label",45),s(46,9),o(),m(47,"my-select-options",46),u(48,Ls,2,1,"div",42),o(),E(),o()(),E(),o()(),i(49,"div",47)(50,"div",25)(51,"h2"),s(52,10),o(),i(53,"div",26),s(54,11),o()(),i(55,"div",27),S(56,28)(57,48),i(58,"div",34)(59,"my-peertube-checkbox",49),u(60,$s,2,0,"ng-template",31),o()(),i(61,"div",50)(62,"h3",51),s(63,12),o(),i(64,"div",52)(65,"div",53)(66,"h4"),s(67,13),o(),i(68,"div",54),S(69,55),u(70,Us,3,4,"div",56),E(),i(71,"div",29)(72,"my-peertube-checkbox",57),S(73,32),s(74,14),E(),o()()()()()(),i(75,"div",58)(76,"my-peertube-checkbox",59),S(77,32),i(78,"span"),D(79,15),m(80,"a",60),y(),o(),E(),o()(),i(81,"div",34)(82,"label",61),s(83,16),o(),i(84,"span",62),u(85,ws,2,2,"ng-container",63)(86,Vs,2,2,"ng-container",63),o(),m(87,"my-select-custom-value",64),u(88,ks,2,1,"div",42),o(),i(89,"div",65)(90,"label",66),s(91,17),o(),i(92,"span",62),s(93,18),o(),m(94,"my-select-options",67),u(95,zs,2,1,"div",42),o(),E()(),o()(),E()),e&2&&(l("formGroup",t.form),a(16),W(t.getLiveRTMPPort()),j(16),a(2),l("ngClass",t.getDisabledLiveClass()),a(2),l("ngClass",t.getDisabledLiveClass()),a(4),l("ngClass",t.getDisabledLiveClass()),a(8),W(t.form.value.live.maxInstanceLives),j(32),a(),l("ngIf",t.formErrors.live.maxInstanceLives),a(),l("ngClass",t.getDisabledLiveClass()),a(8),W(t.form.value.live.maxUserLives),j(42),a(),l("ngIf",t.formErrors.live.maxUserLives),a(),l("ngClass",t.getDisabledLiveClass()),a(3),l("items",t.liveMaxDurationOptions)("clearable",!1)("searchable",!0),a(),l("ngIf",t.formErrors.live.maxDuration),a(10),l("ngClass",t.getDisabledLiveClass()),a(6),l("ngClass",t.getDisabledLiveTranscodingClass()),a(6),l("ngForOf",t.liveResolutions),a(5),l("ngClass",t.getDisabledLiveTranscodingClass()),a(6),l("ngClass",t.getDisabledLiveLocalTranscodingClass()),a(4),l("ngIf",t.getTotalTranscodingThreads().atMost),a(),l("ngIf",!t.getTotalTranscodingThreads().atMost),a(),l("items",t.transcodingThreadOptions)("clearable",!1),a(),l("ngIf",t.formErrors.live.transcoding.threads),a(),l("ngClass",t.getDisabledLiveLocalTranscodingClass()),a(5),l("items",t.transcodingProfiles)("clearable",!1),a(),l("ngIf",t.formErrors.live.transcoding.profile));},dependencies:[ce,Ve,En,Se,Me,Pe,fe,ke,Rt,et,Dt,le,B,Nn,Ne,Le,xt],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var Ui=ro;function Xs(n,r){n&1&&(S(0),s(1,23),E());}function Bs(n,r){n&1&&(S(0),i(1,"p"),s(2,24),o(),E());}function Ws(n,r){n&1&&(S(0),D(1,25),m(2,"strong")(3,"p"),i(4,"ul"),m(5,"li")(6,"li")(7,"li"),o(),m(8,"p"),y(),E());}function js(n,r){n&1&&(S(0),s(1,26),E(),m(2,"br"),S(3),s(4,27),E(),m(5,"br"),S(6),s(7,28),E());}function Hs(n,r){if(n&1&&m(0,"div",85),n&2){let e=p(2).$implicit;l("innerHTML",e.description,an);}}function Js(n,r){n&1&&u(0,Hs,1,1,"ng-template",54);}function Ks(n,r){if(n&1&&(i(0,"div",83)(1,"my-peertube-checkbox",84),u(2,Js,1,0,null,69),o()()),n&2){let e=r.$implicit,t=p();a(),qt("labelText",e.label),l("inputName",t.getResolutionKey(e.id))("formControlName",e.id),a(),l("ngIf",e.description);}}function Ys(n,r){if(n&1&&(S(0),s(1,29),E()),n&2){let e=p();a(),W(e.getTotalTranscodingThreads().value)(e.getTotalTranscodingThreads().unit),j(1);}}function qs(n,r){if(n&1&&(S(0),s(1,30),E()),n&2){let e=p();a(),W(e.getTotalTranscodingThreads().value)(e.getTotalTranscodingThreads().unit),j(1);}}function Qs(n,r){if(n&1&&(i(0,"div",86),C(1),o()),n&2){let e=p();a(),I(e.formErrors.transcoding.threads);}}function Zs(n,r){if(n&1&&(i(0,"div",86),C(1),o()),n&2){let e=p();a(),I(e.formErrors.transcoding.concurrency);}}function ec(n,r){if(n&1&&(i(0,"div",86),C(1),o()),n&2){let e=p();a(),I(e.formErrors.transcoding.profile);}}function tc(n,r){n&1&&(S(0,47),i(1,"span"),s(2,31),o(),E());}var ao=class ao{constructor(r,e,t){this.configService=r;this.editConfigurationService=e;this.notifier=t;c(this,"form");c(this,"formErrors");c(this,"serverConfig");c(this,"transcodingThreadOptions",[]);c(this,"transcodingProfiles",[]);c(this,"resolutions",[]);c(this,"additionalVideoExtensions","");}ngOnInit(){this.transcodingThreadOptions=this.configService.transcodingThreadOptions,this.resolutions=this.editConfigurationService.getTranscodingResolutions(),this.checkTranscodingFields();}ngOnChanges(r){r.serverConfig&&(this.transcodingProfiles=this.buildAvailableTranscodingProfile(),this.additionalVideoExtensions=this.serverConfig.video.file.extensions.join(" "));}buildAvailableTranscodingProfile(){return this.serverConfig.transcoding.availableProfiles.map(e=>e==="default"?{id:e,label:"\u9810\u8A2D",description:"x264\uFF0C\u4EE5\u76F8\u5BB9\u6700\u591A\u88DD\u7F6E\u70BA\u76EE\u6A19"}:{id:e,label:e});}getResolutionKey(r){return"transcoding.resolutions."+r;}isRemoteRunnerVODEnabled(){return this.editConfigurationService.isRemoteRunnerVODEnabled(this.form);}isTranscodingEnabled(){return this.editConfigurationService.isTranscodingEnabled(this.form);}isHLSEnabled(){return this.editConfigurationService.isHLSEnabled(this.form);}isStudioEnabled(){return this.editConfigurationService.isStudioEnabled(this.form);}getTranscodingDisabledClass(){return{"disabled-checkbox-extra":!this.isTranscodingEnabled()};}getHLSDisabledClass(){return{"disabled-checkbox-extra":!this.isHLSEnabled()};}getLocalTranscodingDisabledClass(){return{"disabled-checkbox-extra":!this.isTranscodingEnabled()||this.isRemoteRunnerVODEnabled()};}getStudioDisabledClass(){return{"disabled-checkbox-extra":!this.isStudioEnabled()};}getTotalTranscodingThreads(){return this.editConfigurationService.getTotalTranscodingThreads(this.form);}checkTranscodingFields(){let r=this.form.get("transcoding.enabled"),e=this.form.get("videoStudio.enabled"),t=this.form.get("transcoding.hls.enabled"),_=this.form.get("transcoding.webVideos.enabled");_.valueChanges.subscribe(d=>{d===!1&&t.value===!1&&(t.setValue(!0),this.notifier.info("\u81EA\u52D5\u555F\u7528 HLS \u8F49\u78BC\uFF0C\u56E0\u70BA\u555F\u7528\u8F49\u78BC\u6642\u5FC5\u9808\u81F3\u5C11\u555F\u7528 1 \u7A2E\u8F38\u51FA\u683C\u5F0F","",1e4));}),t.valueChanges.subscribe(d=>{d===!1&&_.value===!1&&(_.setValue(!0),this.notifier.info("\u81EA\u52D5\u555F\u7528\u7DB2\u8DEF\u8996\u8A0A\u8F49\u78BC\uFF0C\u56E0\u70BA\u555F\u7528\u8F49\u78BC\u6642\u5FC5\u9808\u81F3\u5C11\u555F\u7528 1 \u7A2E\u8F38\u51FA\u683C\u5F0F","",1e4));}),r.valueChanges.subscribe(d=>{d===!1&&e.setValue(!1);}),r.updateValueAndValidity(),_.updateValueAndValidity(),e.updateValueAndValidity(),t.updateValueAndValidity();}};c(ao,"\u0275fac",function(e){return new(e||ao)(T(pt),T(on),T(K));}),c(ao,"\u0275cmp",h({type:ao,selectors:[["my-edit-vod-transcoding"]],inputs:{form:"form",formErrors:"formErrors",serverConfig:"serverConfig"},standalone:!0,features:[gn,v],decls:117,vars:27,consts:()=>{let r;r="\u5141\u8A31\u984D\u5916\u7684\u526F\u6A94\u540D";let e;e="\u5141\u8A31\u4E0A\u50B3\u97F3\u8A0A\u6A94\u6848";let t;t="\u4FDD\u7559\u8F38\u5165\u6A94\u7684\u7248\u672C";let _;_="\u555F\u7528\u4E86\u7DB2\u8DEF\u5F71\u7247";let d;d="\u555F\u7528\u4E86 P2P \u652F\u63F4\u7684 HLS";let g;g="\u5206\u5272\u97F3\u8A0A\u8207\u8996\u8A0A\u4E32\u6D41";let O;O="\u540C\u6642\u8F49\u78BC\u539F\u59CB\u89E3\u6790\u5EA6";let R;R="\u70BA\u96A8\u9078\u8996\u8A0A\u555F\u7528\u9060\u7AEF\u57F7\u884C\u5668";let N;N="\u555F\u7528\u5F71\u7247\u5DE5\u4F5C\u5BA4";let b;b="\u70BA\u5DE5\u4F5C\u5BA4\u555F\u7528\u9060\u7AEF\u57F7\u884C\u5668";let G;G="\u9810\u8A08\u4F3A\u670D\u5668\u8F49\u78BC\u8207\u4E32\u6D41\u5F71\u7247\u7684\u80FD\u529B\u4E26\u4E0D\u5BB9\u6613\uFF0C\u6CC1\u4E14\u6211\u5011\u7121\u6CD5\u81EA\u52D5\u8ABF\u6574 PeerTube\u3002";let F;F="\u4E0D\u904E\uFF0C\u5728\u8ABF\u6574\u4EE5\u4E0B\u7684\u503C\u524D\uFF0C\u60A8\u53EF\u80FD\u6703\u60F3\u8981\u5148\u95B1\u8B80"+"\uFFFD#10\uFFFD"+"\u6211\u5011\u7684\u6307\u5357"+"\uFFFD/#10\uFFFD"+"\u3002 ";let L;L="\u8F49\u63DB\u7DE8\u78BC";let $;$="\u8655\u7406\u4E0A\u50B3\u7684\u5F71\u7247\uFF0C\u8B93\u5B83\u5011\u4EE5\u4EFB\u4F55\u88DD\u7F6E\u90FD\u53EF\u4EE5\u64AD\u653E\u7684\u4E32\u6D41\u5F62\u5F0F\u64AD\u653E\u3002\u5118\u7BA1\u8CC7\u6E90\u6602\u8CB4\uFF0C\u4F46\u9019\u662F PeerTube \u7684\u95DC\u9375\u90E8\u4EFD\uFF0C\u56E0\u6B64\u8ACB\u8B39\u614E\u884C\u4E8B\u3002";let H;H="\u8F38\u5165";let z;z="\u5141\u8A31\u4F7F\u7528\u8005\u4E0A\u50B3 .mp4\u3001.ogv \u8207 .webm \u4EE5\u5916\u7684\u5176\u4ED6\u526F\u6A94\u540D\u5F71\u7247\uFF08\u5982 .avi\u3001.mov\u3001.mkv \u7B49\uFF09\u3002";let V;V="\u5141\u8A31\u4F7F\u7528\u8005\u4E0A\u50B3 .mp3, .ogg, .wma, .flac, .aac, \u6216 .ac3 \u97F3\u8A0A\u6A94\u6848\u3002";let x;x="\u8A72\u6A94\u6848\u5C07\u6703\u5728\u4E0A\u50B3\u6642\u8207\u975C\u6B62\u5716\u7247\u5408\u4F75\u70BA\u5F71\u7247\u7684\u9810\u89BD\u6A94\u6848\u3002";let Y;Y="\u82E5\u555F\u7528\uFF0C\u8F38\u5165\u6A94\u6848\u5728\u8F49\u63DB\u7DE8\u78BC\u5F8C\u4E0D\u6703\u88AB\u522A\u9664\uFF0C\u800C\u662F\u79FB\u52D5\u5230\u5C08\u7528\u8CC7\u6599\u593E\u6216\u7269\u4EF6\u5132\u5B58\u4E2D";let oe;oe="\u8F38\u51FA";let we;we="\u82E5\u555F\u7528\uFF0C\u9060\u7AEF PeerTube \u7248\u672C < 6.3.0 \u7684\u7AD9\u53F0\u5C07\u7121\u6CD5\u64AD\u653E\u9019\u4E9B\u5F71\u7247";let ae;ae="\u7522\u751F\u7684\u89E3\u6790\u5EA6";let Be;Be="\u5373\u4F7F\u5176\u9AD8\u65BC\u60A8\u555F\u7528\u7684\u6700\u5927\u89E3\u6790\u5EA6";let We;We="\u4F7F\u7528"+"\uFFFD#74\uFFFD"+"\u9060\u7AEF\u57F7\u884C\u5668"+"\uFFFD/#74\uFFFD"+"\u4F86\u8655\u7406\u96A8\u9078\u8996\u8A0A\u8F49\u63DB\u7DE8\u78BC\u3002\u9060\u7AEF\u57F7\u884C\u5668\u5FC5\u9808\u5148\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u8A3B\u518A\u3002 ";let je;je="\u8F49\u63DB\u7DE8\u78BC\u57F7\u884C\u7DD2";let He;He="\u8F49\u78BC\u4F5C\u696D\u4E26\u884C";let Je;Je="\u5141\u8A31\u540C\u6642\u8F49\u78BC\u591A\u500B\u6A94\u6848\u3002 \u26A0\uFE0F \u9700\u8981\u91CD\u65B0\u555F\u52D5 PeerTube";let Z;Z="\u5E73\u884C\u4F5C\u696D";let it;it="\u8F49\u63DB\u7DE8\u78BC\u8A2D\u5B9A\u6A94";let Ye;Ye="\u900F\u904E PeerTube \u5916\u639B\u7A0B\u5F0F\u65B0\u589E\u65B0\u7684\u8F49\u63DB\u7DE8\u78BC\u8A2D\u5B9A\u6A94";let rt;rt="\u5F71\u7247\u5DE5\u4F5C\u5BA4";let at;at="\u5141\u8A31\u60A8\u7684\u4F7F\u7528\u7DE8\u8F2F\u4ED6\u5011\u7684\u5F71\u7247\uFF08\u526A\u8F2F\u3001\u65B0\u589E\u4ECB\u7D39\uFF0F\u7D50\u5C3E\u3001\u65B0\u589E\u6C34\u5370\u7B49\uFF09";let Ke;Ke="\u4F7F\u7528"+"\uFFFD#116\uFFFD"+"\u9060\u7AEF\u57F7\u884C\u5668"+"\uFFFD/#116\uFFFD"+"\u4F86\u8655\u7406\u5DE5\u4F5C\u5BA4\u8F49\u63DB\u7DE8\u78BC\u4F5C\u696D\u3002\u9060\u7AEF\u57F7\u884C\u5668\u5FC5\u9808\u5148\u5728\u60A8\u7684\u7AD9\u53F0\u4E0A\u8A3B\u518A\u3002 ";let q;q="\u8F49\u63DB\u7DE8\u78BC\u5DF2\u555F\u7528";let U;U="\u82E5\u60A8\u4E5F\u555F\u7528\u4E86 HLS \u652F\u63F4\uFF0C\u6240\u9700\u7684\u5132\u5B58\u7A7A\u9593\u5C07\u6703\u4E58\u4EE5 2";let Jt;Jt=""+"\uFFFD#2\uFFFD"+"\u9700\u8981 ffmpeg >= 4.1"+"\uFFFD/#2\uFFFD"+""+"[\uFFFD#3\uFFFD|\uFFFD#8\uFFFD]"+"\u7522\u751F HLS \u64AD\u653E\u6E05\u55AE\u8207\u5206\u6BB5\u7684 MP4 \u6A94\u6848\uFF0C\u5F9E\u800C\u53D6\u5F97\u6BD4\u7DB2\u8DEF\u5F71\u7247\u66F4\u597D\u7684\u64AD\u653E\u6548\u679C\uFF1A"+"[\uFFFD/#3\uFFFD|\uFFFD/#8\uFFFD]"+""+"\uFFFD#4\uFFFD"+""+"[\uFFFD#5\uFFFD|\uFFFD#6\uFFFD|\uFFFD#7\uFFFD]"+"\u89E3\u6790\u5EA6\u8B8A\u66F4\u8F03\u70BA\u5E73\u9806"+"[\uFFFD/#5\uFFFD|\uFFFD/#6\uFFFD|\uFFFD/#7\uFFFD]"+""+"[\uFFFD#5\uFFFD|\uFFFD#6\uFFFD|\uFFFD#7\uFFFD]"+"\u64AD\u653E\u901F\u5EA6\u66F4\u5FEB\uFF0C\u5C24\u5176\u662F\u8F03\u9577\u7684\u5F71\u7247"+"[\uFFFD/#5\uFFFD|\uFFFD/#6\uFFFD|\uFFFD/#7\uFFFD]"+""+"[\uFFFD#5\uFFFD|\uFFFD#6\uFFFD|\uFFFD#7\uFFFD]"+"\u66F4\u7A69\u5B9A\u7684\u64AD\u653E\uFF08\u8F03\u5C11\u81ED\u87F2/\u7121\u9650\u8F09\u5165\uFF09"+"[\uFFFD/#5\uFFFD|\uFFFD/#6\uFFFD|\uFFFD/#7\uFFFD]"+""+"\uFFFD/#4\uFFFD"+""+"[\uFFFD#3\uFFFD|\uFFFD#8\uFFFD]"+"\u82E5\u60A8\u4E5F\u555F\u7528\u4E86\u7DB2\u8DEF\u5F71\u7247\u652F\u63F4\uFF0C\u53EF\u80FD\u6703\u8B93\u5F71\u7247\u7684\u5132\u5B58\u7A7A\u9593\u4E58\u4EE5 2"+"[\uFFFD/#3\uFFFD|\uFFFD/#8\uFFFD]"+"",Jt=Ce(Jt);let un;un="\u5C07\u97F3\u8A0A\u4E32\u6D41\u5132\u5B58\u5728\u8207\u8996\u8A0A\u4E0D\u540C\u7684\u6A94\u6848\u4E2D\u3002";let Kt;Kt="\u6B64\u9078\u9805\u65B0\u589E\u4E86 HLS \u64AD\u653E\u7A0B\u5F0F\u5411\u4F7F\u7528\u8005\u5EFA\u8B70\u300C\u50C5\u97F3\u8A0A\u300D\u54C1\u8CEA\u7684\u529F\u80FD\u3002";let te;te="\u5176\u4E5F\u900F\u904E\u4E0D\u5728\u6BCF\u500B\u89E3\u6790\u5EA6\u7684\u6A94\u6848\u4E2D\u8907\u88FD\u97F3\u8A0A\u4E32\u6D41\u4F86\u7BC0\u7701\u78C1\u789F\u7A7A\u9593";let Wo;Wo="\u5C07\u6703\u4F7F\u7528\u6700\u591A "+"\uFFFD0\uFFFD"+" "+"\uFFFD1\uFFFD"+" \u4F86\u9032\u884C\u5373\u6642\u8F49\u78BC ";let jo;jo="\u5C07\u6703\u4F7F\u7528\u6700\u5C11 "+"\uFFFD0\uFFFD"+" "+"\uFFFD1\uFFFD"+" \u4F86\u9032\u884C\u5373\u6642\u8F49\u78BC ";let Ho;return Ho="\u26A0\uFE0F \u60A8\u5FC5\u9808\u5148\u555F\u7528\u8F49\u63DB\u7DE8\u78BC\u624D\u80FD\u555F\u7528\u5F71\u7247\u5DE5\u4F5C\u5BA4",[G,F,L,$,H,z,V,x,Y,oe,we,ae,Be,We,je,He,Je,Z,it,Ye,rt,at,Ke,q,U,Jt,un,Kt,te,Wo,jo,Ho,[3,"formGroup"],[1,"pt-two-cols","mt-4"],[1,"title-col"],[1,"content-col"],[1,"callout","callout-orange"],["target","_blank","rel","noopener noreferrer","href","https://docs.joinpeertube.org/admin/configuration#vod-transcoding",1,"link-orange"],[1,"inner-form-description"],["formGroupName","transcoding"],["inputName","transcodingEnabled","formControlName","enabled",3,"recommended"],["ptTemplate","label"],["ngProjectAs","extra",5,["extra"]],[1,"callout","callout-light","pt-2","pb-0"],[1,"callout-title"],[1,"form-group",3,"ngClass"],["inputName","transcodingAllowAdditionalExtensions","formControlName","allowAdditionalExtensions","labelText",r],["ngProjectAs","description",5,["description"]],["inputName","transcodingAllowAudioFiles","formControlName","allowAudioFiles","labelText",e],["formGroupName","originalFile",1,"form-group",3,"ngClass"],["inputName","transcodingOriginalFileKeep","formControlName","keep","labelText",t],[1,"callout","callout-light","pt-2","mt-2","pb-0"],["formGroupName","webVideos"],["inputName","transcodingWebVideosEnabled","formControlName","enabled","labelText",_],["ptTemplate","help"],["formGroupName","hls"],["inputName","transcodingHlsEnabled","formControlName","enabled","labelText",d,3,"recommended"],["inputName","transcodingHlsSplitAudioAndVideo","formControlName","splitAudioAndVideo","labelText",g],[1,"mb-2","fw-bold"],[1,"ms-2","d-flex","flex-column"],["formGroupName","resolutions"],["class","form-group",4,"ngFor","ngForOf"],["inputName","transcodingAlwaysTranscodeOriginalResolution","formControlName","alwaysTranscodeOriginalResolution","labelText",O],["formGroupName","remoteRunners",1,"form-group","mt-4",3,"ngClass"],["inputName","transcodingRemoteRunnersEnabled","formControlName","enabled","labelText",R],["routerLink","/admin/system/runners/runners-list"],[1,"form-group","mt-4",3,"ngClass"],["for","transcodingThreads"],[1,"small","muted","ms-1"],[4,"ngIf"],["id","transcodingThreads","formControlName","threads",3,"items","clearable"],["class","form-error","role","alert",4,"ngIf"],["for","transcodingConcurrency"],[1,"number-with-unit"],["type","number","name","transcodingConcurrency","formControlName","concurrency"],["for","transcodingProfile"],["id","transcodingProfile","formControlName","profile",3,"items","clearable"],[1,"pt-two-cols","mt-2"],["formGroupName","videoStudio"],["inputName","videoStudioEnabled","formControlName","enabled","labelText",N],["ngProjectAs","description",5,["description"],4,"ngIf"],["formGroupName","remoteRunners",1,"form-group",3,"ngClass"],["inputName","videoStudioRemoteRunnersEnabled","formControlName","enabled","labelText",b],[1,"form-group"],[3,"inputName","formControlName","labelText"],[3,"innerHTML"],["role","alert",1,"form-error"]];},template:function(e,t){e&1&&(S(0,32),i(1,"div",33),m(2,"div",34),i(3,"div",35)(4,"div",36)(5,"span"),s(6,0),o(),m(7,"br"),i(8,"span"),D(9,1),m(10,"a",37),y(),o()()()(),i(11,"div",33)(12,"div",34)(13,"h2"),s(14,2),o(),i(15,"div",38),s(16,3),o()(),i(17,"div",35),S(18,39),i(19,"div")(20,"my-peertube-checkbox",40),u(21,Xs,2,0,"ng-template",41),S(22,42),i(23,"div",43)(24,"h3",44),s(25,4),o(),i(26,"div",45)(27,"my-peertube-checkbox",46),S(28,47),i(29,"span"),s(30,5),o(),E(),o()(),i(31,"div",45)(32,"my-peertube-checkbox",48),S(33,47),i(34,"div"),s(35,6),o(),i(36,"div"),s(37,7),o(),E(),o()(),i(38,"div",49)(39,"my-peertube-checkbox",50),S(40,47),i(41,"div"),s(42,8),o(),E(),o()()(),i(43,"div",51)(44,"h3",44),s(45,9),o(),S(46,52),i(47,"div",45)(48,"my-peertube-checkbox",53),u(49,Bs,3,0,"ng-template",54),o()(),E(),S(50,55),i(51,"div",45)(52,"my-peertube-checkbox",56),u(53,Ws,9,0,"ng-template",54),S(54,42),i(55,"div",45)(56,"my-peertube-checkbox",57),S(57,47),s(58,10),E(),u(59,js,8,0,"ng-template",54),o()(),E(),o()(),E(),i(60,"div",45)(61,"div",58),s(62,11),o(),i(63,"div",59),S(64,60),u(65,Ks,3,4,"div",61),E(),i(66,"my-peertube-checkbox",62),S(67,47),s(68,12),E(),o()()()(),E(),o()(),i(69,"div",63)(70,"my-peertube-checkbox",64),S(71,47),i(72,"span"),D(73,13),m(74,"a",65),y(),o(),E(),o()(),i(75,"div",66)(76,"label",67),s(77,14),o(),i(78,"span",68),u(79,Ys,2,2,"ng-container",69)(80,qs,2,2,"ng-container",69),o(),m(81,"my-select-custom-value",70),u(82,Qs,2,1,"div",71),o(),i(83,"div",45)(84,"label",72),s(85,15),o(),i(86,"span",68),s(87,16),o(),i(88,"div",73),m(89,"input",74),i(90,"span"),s(91,17),o()(),u(92,Zs,2,1,"div",71),o(),i(93,"div",45)(94,"label",75),s(95,18),o(),i(96,"span",68),s(97,19),o(),m(98,"my-select-options",76),u(99,ec,2,1,"div",71),o(),E(),o()(),i(100,"div",77)(101,"div",34)(102,"h2"),s(103,20),o(),i(104,"div",38),s(105,21),o()(),i(106,"div",35),S(107,78),i(108,"div",45)(109,"my-peertube-checkbox",79),u(110,tc,3,0,"ng-container",80),o()(),i(111,"div",81)(112,"my-peertube-checkbox",82),S(113,47),i(114,"span"),D(115,22),m(116,"a",65),y(),o(),E(),o()(),E(),o()(),E()),e&2&&(l("formGroup",t.form),a(20),l("recommended",!0),a(6),l("ngClass",t.getTranscodingDisabledClass()),a(5),l("ngClass",t.getTranscodingDisabledClass()),a(7),l("ngClass",t.getTranscodingDisabledClass()),a(9),l("ngClass",t.getTranscodingDisabledClass()),a(4),l("ngClass",t.getTranscodingDisabledClass()),a(),l("recommended",!0),a(3),l("ngClass",t.getHLSDisabledClass()),a(5),l("ngClass",t.getTranscodingDisabledClass()),a(5),l("ngForOf",t.resolutions),a(4),l("ngClass",t.getTranscodingDisabledClass()),a(6),l("ngClass",t.getLocalTranscodingDisabledClass()),a(4),l("ngIf",t.getTotalTranscodingThreads().atMost),a(),l("ngIf",!t.getTotalTranscodingThreads().atMost),a(),l("items",t.transcodingThreadOptions)("clearable",!1),a(),l("ngIf",t.formErrors.transcoding.threads),a(),l("ngClass",t.getLocalTranscodingDisabledClass()),a(9),l("ngIf",t.formErrors.transcoding.concurrency),a(),l("ngClass",t.getLocalTranscodingDisabledClass()),a(5),l("items",t.transcodingProfiles)("clearable",!1),a(),l("ngIf",t.formErrors.transcoding.profile),a(9),l("ngClass",t.getTranscodingDisabledClass()),a(2),l("ngIf",!t.isTranscodingEnabled()),a(),l("ngClass",t.getStudioDisabledClass()));},dependencies:[ce,Ve,En,Se,Me,Pe,fe,ke,Rt,et,Dt,le,Ne,B,Le,xt,Nn],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var wi=ao;function nc(n,r){n&1&&(i(0,"div",31),s(1,8),o());}function oc(n,r){if(n&1&&m(0,"my-edit-homepage",32),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors);}}function ic(n,r){if(n&1&&m(0,"my-edit-instance-information",33),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors)("languageItems",e.languageItems)("categoryItems",e.categoryItems);}}function rc(n,r){if(n&1&&m(0,"my-edit-basic-configuration",34),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors)("serverConfig",e.serverConfig);}}function ac(n,r){if(n&1&&m(0,"my-edit-vod-transcoding",34),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors)("serverConfig",e.serverConfig);}}function _c(n,r){if(n&1&&m(0,"my-edit-live-configuration",34),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors)("serverConfig",e.serverConfig);}}function lc(n,r){if(n&1&&m(0,"my-edit-advanced-configuration",32),n&2){let e=p();l("form",e.form)("formErrors",e.formErrors);}}function sc(n,r){if(n&1&&(D(0,9,1),m(1,"li"),y()),n&2){let e=r.$implicit;a(),W(e),j(0);}}function cc(n,r){if(n&1&&(i(0,"div",35),D(1,9),i(2,"ul"),u(3,sc,2,1,"li",36),o(),y(),o()),n&2){let e=p();a(3),l("ngForOf",e.grabAllErrors());}}function dc(n,r){n&1&&(i(0,"span",35),s(1,10),o());}function pc(n,r){n&1&&(i(0,"span"),s(1,11),o());}var _o=class _o extends yt{constructor(e,t,_,d,g,O,R,N){super();this.formReactiveService=e;this.router=t;this.route=_;this.notifier=d;this.configService=g;this.customPage=O;this.serverService=R;this.editConfigurationService=N;c(this,"activeNav");c(this,"customConfig");c(this,"serverConfig");c(this,"homepage");c(this,"languageItems",[]);c(this,"categoryItems",[]);}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig();let e={instance:{name:al,shortDescription:_l,description:null,isNSFW:!1,defaultNSFWPolicy:null,terms:null,codeOfConduct:null,creationReason:null,moderationInformation:null,administrator:null,maintenanceLifetime:null,businessModel:null,hardwareInformation:null,categories:null,languages:null,defaultClientRoute:null,customizations:{javascript:null,css:null}},theme:{default:null},services:{twitter:{username:ll}},client:{videos:{miniature:{preferAuthorDisplayName:null}},menu:{login:{redirectOnSingleExternalAuth:null}}},cache:{previews:{size:ni},captions:{size:ni},torrents:{size:ni},storyboards:{size:ni}},signup:{enabled:null,limit:sl,requiresApproval:null,requiresEmailVerification:null,minimumAge:cl},import:{videos:{concurrency:Ar,http:{enabled:null},torrent:{enabled:null}},videoChannelSynchronization:{enabled:null},users:{enabled:null}},export:{users:{enabled:null,maxUserVideoQuota:Tl,exportExpiration:El}},trending:{videos:{algorithms:{enabled:null,default:null}}},admin:{email:dl},contactForm:{enabled:null},user:{history:{videos:{enabled:null}},videoQuota:Xn,videoQuotaDaily:Bn},videoChannels:{maxPerUser:gl},transcoding:{enabled:null,threads:Pr,allowAdditionalExtensions:null,allowAudioFiles:null,profile:null,concurrency:Ar,resolutions:{},alwaysTranscodeOriginalResolution:null,originalFile:{keep:null},hls:{enabled:null,splitAudioAndVideo:null},webVideos:{enabled:null},remoteRunners:{enabled:null}},live:{enabled:null,maxDuration:pl,maxInstanceLives:ml,maxUserLives:ul,allowReplay:null,latencySetting:{enabled:null},transcoding:{enabled:null,threads:Pr,profile:null,resolutions:{},alwaysTranscodeOriginalResolution:null,remoteRunners:{enabled:null}}},videoStudio:{enabled:null,remoteRunners:{enabled:null}},videoTranscription:{enabled:null,remoteRunners:{enabled:null}},videoFile:{update:{enabled:null}},autoBlacklist:{videos:{ofUsers:{enabled:null}}},followers:{instance:{enabled:null,manualApproval:null}},followings:{instance:{autoFollowBack:{enabled:null},autoFollowIndex:{enabled:null,indexUrl:Cl}}},broadcastMessage:{enabled:null,level:null,dismissable:null,message:null},search:{remoteUri:{users:null,anonymous:null},searchIndex:{enabled:null,url:Sl,disableLocalSearch:null,isDefaultSearch:null}},instanceCustomHomepage:{content:null},storyboards:{enabled:null}},t={transcoding:{resolutions:{}},live:{transcoding:{resolutions:{}}}};for(let _ of this.editConfigurationService.getTranscodingResolutions())t.transcoding.resolutions[_.id]="false",e.transcoding.resolutions[_.id]=null,t.live.transcoding.resolutions[_.id]="false",e.live.transcoding.resolutions[_.id]=null;this.buildForm(e),this.route.snapshot.fragment&&this.onNavChange(this.route.snapshot.fragment),this.loadConfigAndUpdateForm(),this.loadCategoriesAndLanguages(),this.isUpdateAllowed()||this.form.disable();}formValidated(){if(this.forceCheck(),!this.form.valid)return;let e=S_(this.customConfig,this.form.getRawValue());Un([this.configService.updateCustomConfig(pi(e,"instanceCustomHomepage")),this.customPage.updateInstanceHomepage(e.instanceCustomHomepage.content)]).subscribe({next:([t])=>{let _={content:e.instanceCustomHomepage.content};this.customConfig=Yt(zt({},t),{instanceCustomHomepage:_}),this.serverService.resetConfig().subscribe(d=>{this.serverConfig=d;}),this.updateForm(),this.notifier.success("\u8A2D\u5B9A\u5DF2\u66F4\u65B0\u3002");},error:t=>this.notifier.error(t.message)});}isUpdateAllowed(){return this.serverConfig.webadmin.configuration.edition.allowed===!0;}hasConsistentOptions(){return!!this.hasLiveAllowReplayConsistentOptions();}hasLiveAllowReplayConsistentOptions(){return!(this.editConfigurationService.isTranscodingEnabled(this.form)===!1&&this.editConfigurationService.isLiveEnabled(this.form)&&this.form.value.live.allowReplay===!0);}onNavChange(e){this.activeNav=e,this.router.navigate([],{fragment:this.activeNav});}grabAllErrors(e){let t=e||this.formErrors,_=[];for(let d of Object.keys(t)){let g=t[d];g&&(typeof g=="string"?_.push(g):_=_.concat(this.grabAllErrors(g)));}return _;}updateForm(){this.form.patchValue(this.customConfig);}loadConfigAndUpdateForm(){Un([this.configService.getCustomConfig(),this.customPage.getInstanceHomepage()]).subscribe({next:([e,t])=>{this.customConfig=Yt(zt({},e),{instanceCustomHomepage:t}),this.updateForm(),this.markAllAsDirty();},error:e=>this.notifier.error(e.message)});}loadCategoriesAndLanguages(){Un([this.serverService.getVideoLanguages(),this.serverService.getVideoCategories()]).subscribe({next:([e,t])=>{this.languageItems=e.map(_=>({label:_.label,id:_.id})),this.categoryItems=t.map(_=>({label:_.label,id:_.id+""}));},error:e=>this.notifier.error(e.message)});}};c(_o,"\u0275fac",function(t){return new(t||_o)(T(Nt),T(Ze),T(Qe),T(K),T(pt),T(vi),T(Ge),T(on));}),c(_o,"\u0275cmp",h({type:_o,selectors:[["my-edit-custom-config"]],standalone:!0,features:[ne,v],decls:38,vars:8,consts:()=>{let e;e="\u66F4\u65B0\u8A2D\u5B9A";let t;t="\u8A2D\u5B9A";let _;_="\u9996\u9801";let d;d="\u8CC7\u8A0A";let g;g="\u57FA\u672C";let O;O="VOD \u8F49\u78BC";let R;R="\u76F4\u64AD\u4E32\u6D41";let N;N="\u9032\u968E";let b;b="\u7CFB\u7D71\u7BA1\u7406\u54E1\u505C\u7528\u4E86\u5F9E\u7DB2\u9801\u4ECB\u9762\u66F4\u65B0\u7AD9\u53F0\u8A2D\u5B9A\u7684\u529F\u80FD\u3002";let G;G="\u683C\u5F0F\u6709\u8AA4\uFF1A"+"\uFFFD#2\uFFFD"+""+"\uFFFD*3:1\uFFFD\uFFFD#1:1\uFFFD"+" "+"\uFFFD0:1\uFFFD"+" "+"\uFFFD/#1:1\uFFFD\uFFFD/*3:1\uFFFD"+""+"\uFFFD/#2\uFFFD"+"";let F;F="\u5982\u679C\u60A8\u672A\u555F\u7528\u8F49\u63DB\u7DE8\u78BC\uFF0C\u5247\u7121\u6CD5\u5141\u8A31\u76F4\u64AD\u91CD\u64AD\u3002";let L;return L="\u60A8\u7121\u6CD5\u8B8A\u66F4\u4F3A\u670D\u5668\u8A2D\u5B9A\uFF0C\u56E0\u70BA\u5176\u662F\u7531\u5916\u90E8\u7BA1\u7406\u3002",[["nav","ngbNav"],t,_,d,g,O,R,N,b,G,F,L,[1,"visually-hidden"],["class","alert alert-warning",4,"ngIf"],["role","form",3,"formGroup"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],["ngbNavItem","instance-homepage"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","instance-information"],["ngbNavItem","basic-configuration"],["ngbNavItem","transcoding"],["ngbNavItem","live"],["ngbNavItem","advanced-configuration"],[3,"ngbNavOutlet"],[1,"row","mt-4"],[1,"col-md-7","col-xl-5"],[1,"col-md-5","col-xl-5"],["role","alert","class","form-error submit-error",4,"ngIf"],[4,"ngIf"],["type","submit","value",e,3,"click","disabled"],[1,"alert","alert-warning"],[3,"form","formErrors"],[3,"form","formErrors","languageItems","categoryItems"],[3,"form","formErrors","serverConfig"],["role","alert",1,"form-error","submit-error"],[4,"ngFor","ngForOf"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1",12),s(1,1),o(),u(2,nc,2,0,"div",13),i(3,"form",14)(4,"div",15,0),M("activeIdChange",function(O){return P(d),A(_.onNavChange(O));}),S(6,16),i(7,"a",17),s(8,2),o(),u(9,oc,1,2,"ng-template",18),E(),S(10,19),i(11,"a",17),s(12,3),o(),u(13,ic,1,4,"ng-template",18),E(),S(14,20),i(15,"a",17),s(16,4),o(),u(17,rc,1,3,"ng-template",18),E(),S(18,21),i(19,"a",17),s(20,5),o(),u(21,ac,1,3,"ng-template",18),E(),S(22,22),i(23,"a",17),s(24,6),o(),u(25,_c,1,3,"ng-template",18),E(),S(26,23),i(27,"a",17),s(28,7),o(),u(29,lc,1,2,"ng-template",18),E(),o(),m(30,"div",24),i(31,"div",25),m(32,"div",26),i(33,"div",27),u(34,cc,4,1,"div",28)(35,dc,2,0,"span",28)(36,pc,2,0,"span",29),i(37,"input",30),M("click",function(){return P(d),A(_.formValidated());}),o()()()();}if(t&2){let d=Cn(5);a(2),l("ngIf",!_.isUpdateAllowed()),a(),l("formGroup",_.form),a(),l("activeId",_.activeNav),a(26),l("ngbNavOutlet",d),a(4),l("ngIf",!_.form.valid&&_.isUpdateAllowed()),a(),l("ngIf",!_.hasLiveAllowReplayConsistentOptions()),a(),l("ngIf",!_.isUpdateAllowed()),a(),l("disabled",!_.form.valid||!_.hasConsistentOptions()||!_.isUpdateAllowed());}},dependencies:[B,ce,Ot,Me,Pe,fe,m_,p_,g_,u_,d_,xi,Gi,$i,wi,Ui,Li,C_,Ne],styles:['form[_ngcontent-%COMP%]{padding-bottom:1.5rem}my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:500px}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]{display:block;max-width:90%}.homepage[_ngcontent-%COMP%]   my-markdown-textarea[_ngcontent-%COMP%]     textarea{height:300px!important}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=number][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=number][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}}.number-with-unit[_ngcontent-%COMP%]{position:relative;width:fit-content}.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:absolute;top:.2em;right:2.5rem}@media screen and (max-width: 500px){.number-with-unit[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{display:none}}.number-with-unit[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9;pointer-events:none}input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}input[type=checkbox][_ngcontent-%COMP%]:focus + span[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{position:relative;width:18px;min-width:18px;height:18px;border:1px solid var(--inputBorderColor);border-radius:3px;vertical-align:middle;cursor:pointer}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%]:after{content:"";position:absolute;top:1px;left:5px;width:5px;height:12px;opacity:0;transform:rotate(45deg) scale(0);border-right:2px solid var(--mainBackgroundColor);border-bottom:2px solid var(--mainBackgroundColor)}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{border-color:transparent;background:var(--mainColor);animation:jelly .6s ease}input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]:after{opacity:1;transform:rotate(45deg) scale(1)}input[type=checkbox][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{font-weight:400;cursor:pointer;display:inline;margin-inline-start:.3125rem}input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{opacity:.5;cursor:default}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-options[_ngcontent-%COMP%], my-select-custom-value[_ngcontent-%COMP%], my-select-checkbox[_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{display:flex;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;margin-inline-start:auto}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}input[type=submit][_ngcontent-%COMP%] + .form-error[_ngcontent-%COMP%]{display:inline;margin-inline-start:.3125rem}.inner-form-description[_ngcontent-%COMP%]{font-size:15px;margin-bottom:15px}textarea[_ngcontent-%COMP%]{max-width:100%;display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){textarea[_ngcontent-%COMP%]{width:100%}}textarea.small[_ngcontent-%COMP%]{height:75px}.label-small-info[_ngcontent-%COMP%]{font-style:italic;margin-bottom:10px;font-size:14px}.disabled-checkbox-extra[_ngcontent-%COMP%], .disabled-checkbox-extra[_ngcontent-%COMP%]     label{opacity:.5;pointer-events:none}input[disabled][_ngcontent-%COMP%]{opacity:.5}ngb-tabset[_ngcontent-%COMP%]:not(.previews)     .nav-link{font-size:105%}.submit-error[_ngcontent-%COMP%]{margin-bottom:20px}.alert-signup[_ngcontent-%COMP%]{width:fit-content;margin-top:10px}.callout-container[_ngcontent-%COMP%]{position:absolute;display:flex;height:0;width:100%;justify-content:right}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]{position:relative;right:3.3em;top:.3em;font-size:90%;color:var(--mainColor);background-color:var(--mainBackgroundColor);display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:hover, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus, .callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:active{text-decoration:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.callout-container[_ngcontent-%COMP%]   .callout-link[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}my-actor-banner-edit[_ngcontent-%COMP%]{max-width:500px}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.5rem;font-size:1rem}']}));var Vi=_o;var Ol=[{path:"config",canActivate:[De],data:{userRight:Q.MANAGE_CONFIGURATION},children:[{path:"",redirectTo:"edit-custom",pathMatch:"full"},{path:"edit-custom",component:Vi,data:{meta:{title:"\u7DE8\u8F2F\u81EA\u8A02\u8A2D\u5B9A"}}}]}];var so=class so{};c(so,"\u0275fac",function(e){return new(e||so)();}),c(so,"\u0275cmp",h({type:so,selectors:[["my-abuse-list"]],standalone:!0,features:[v],decls:5,vars:0,consts:()=>{let r;return r="\u56DE\u5831",[r,["iconName","flag","aria-hidden","true"],["viewType","admin"]];},template:function(e,t){e&1&&(i(0,"h1"),m(1,"my-global-icon",1),S(2),s(3,0),E(),o(),m(4,"my-abuse-list-table",2));},dependencies:[de,z_],encapsulation:2}));var ki=so;function uc(n,r){if(n&1){let e=k();i(0,"div",13)(1,"div",14)(2,"my-advanced-input-filter",15),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}}function gc(n,r){if(n&1&&(i(0,"tr")(1,"th",16),s(2,1),o(),i(3,"th",17),s(4,2),o(),i(5,"th",18),D(6,3),m(7,"p-sortIcon",19),y(),o()()),n&2){let e=p();a(5),l("ngbTooltip",e.sortTooltip);}}function Cc(n,r){if(n&1){let e=k();i(0,"tr")(1,"td",20)(2,"button",21),M("click",function(){let _=P(e).$implicit,d=p();return A(d.unblockAccount(_));}),s(3,4),o()(),i(4,"td")(5,"a",22)(6,"div",23),m(7,"my-actor-avatar",24),i(8,"div"),C(9),i(10,"span",25),C(11),o()()()()(),i(12,"td"),C(13),ie(14,"date"),o()();}if(n&2){let e=r.$implicit;a(5),l("href",e.blockedAccount.url,Xe),a(2),l("actor",e.blockedAccount),a(2),w(" ",e.blockedAccount.displayName," "),a(2),I(e.blockedAccount.nameWithHost),a(2),I(_e(14,5,e.createdAt,"short"));}}function Sc(n,r){n&1&&(S(0),s(1,5),E());}function Ec(n,r){n&1&&(S(0),s(1,6),E());}function Tc(n,r){if(n&1&&(i(0,"tr")(1,"td",26)(2,"div",27),u(3,Sc,2,0,"ng-container",28)(4,Ec,2,0,"ng-container",28),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var Ln=class Ln extends X_{constructor(){super(...arguments);c(this,"mode",1);}getIdentifier(){return"InstanceAccountBlocklistComponent";}};c(Ln,"\u0275fac",(()=>{let e;return function(_){return(e||(e=Vn(Ln)))(_||Ln);};})()),c(Ln,"\u0275cmp",h({type:Ln,selectors:[["my-instance-account-blocklist"]],standalone:!0,features:[ne,v],decls:9,vars:11,consts:()=>{let e;e="\u5DF2\u975C\u97F3\u7684\u5E33\u865F";let t;t="\u52D5\u4F5C";let _;_="\u5E33\u865F";let d;d="\u975C\u97F3\u65BC "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let g;g="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u5E33\u865F";let O;O="\u89E3\u9664\u975C\u97F3";let R;R="\u6C92\u6709\u5E33\u865F\u7B26\u5408\u76EE\u524D\u7684\u904E\u6FFE\u5668\u3002";let N;return N="\u627E\u4E0D\u5230\u5E33\u865F\u3002",[e,t,_,d,O,R,N,["iconName","user-x","aria-hidden","true"],[3,"onLazyLoad","value","lazy","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"caption"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","grey-button",3,"click"],["title",g,"target","_blank","rel","noopener noreferrer",3,"href"],[1,"chip","two-lines"],["actorType","account","size","32",3,"actor"],[1,"muted"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(t,_){t&1&&(i(0,"h1"),m(1,"my-global-icon",7),S(2),s(3,0),E(),o(),i(4,"p-table",8),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(5,uc,3,0,"ng-template",9)(6,gc,8,1,"ng-template",10)(7,Cc,15,8,"ng-template",11)(8,Tc,5,2,"ng-template",12),o()),t&2&&(a(4),l("value",_.blockedAccounts)("lazy",!0)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("rowsPerPageOptions",_.rowsPerPageOptions)("first",_.pagination.start)("sortField",_.sort.field)("sortOrder",_.sort.order)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()));},dependencies:[de,ve,be,Ae,Fe,he,Re,nt,$e,Ei,Ue,B,ye],styles:[".moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 960px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 960px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}"]}));var zi=Ln;function Ic(n,r){if(n&1){let e=k();i(0,"div",16)(1,"div",17)(2,"button",18),M("click",function(){P(e);let _=p();return A(_.addServersToBlock());})("key.enter",function(){P(e);let _=p();return A(_.addServersToBlock());}),m(3,"my-global-icon",19),S(4),s(5,2),E(),o()(),i(6,"div",20)(7,"my-advanced-input-filter",21),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}}function Oc(n,r){if(n&1&&(i(0,"tr")(1,"th",22),s(2,3),o(),i(3,"th",23),s(4,4),o(),i(5,"th",24),D(6,5),m(7,"p-sortIcon",25),y(),o()()),n&2){let e=p();a(5),l("ngbTooltip",e.sortTooltip);}}function Nc(n,r){if(n&1){let e=k();i(0,"tr")(1,"td",26)(2,"button",27),M("click",function(){let _=P(e).$implicit,d=p();return A(d.unblockServer(_));}),s(3,6),o()(),i(4,"td")(5,"a",28),C(6),m(7,"my-global-icon",29),o()(),i(8,"td"),C(9),ie(10,"date"),o()();}if(n&2){let e=r.$implicit;a(5),l("href","https://"+e.blockedServer.host,Xe),a(),w(" ",e.blockedServer.host," "),a(3),I(_e(10,3,e.createdAt,"short"));}}function Mc(n,r){n&1&&(S(0),s(1,7),E());}function fc(n,r){n&1&&(S(0),s(1,8),E());}function Pc(n,r){if(n&1&&(i(0,"tr")(1,"td",30)(2,"div",31),u(3,Mc,2,0,"ng-container",32)(4,fc,2,0,"ng-container",32),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var $n=class $n extends j_{constructor(){super(...arguments);c(this,"mode",1);}getIdentifier(){return"InstanceServerBlocklistComponent";}};c($n,"\u0275fac",(()=>{let e;return function(_){return(e||(e=Vn($n)))(_||$n);};})()),c($n,"\u0275cmp",h({type:$n,selectors:[["my-instance-server-blocklist"]],standalone:!0,features:[ne,v],decls:11,vars:12,consts:()=>{let e;e="\u975C\u97F3\u7DB2\u57DF";let t;t="\u5DF2\u975C\u97F3\u4F3A\u670D\u5668";let _;_="\u975C\u97F3\u7DB2\u57DF";let d;d="\u52D5\u4F5C";let g;g="\u7AD9\u81FA";let O;O="\u975C\u97F3\u65BC "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let R;R="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u7AD9\u81FA";let N;N="\u89E3\u9664\u975C\u97F3";let b;b="\u627E\u4E0D\u5230\u7B26\u5408\u76EE\u524D\u904E\u6FFE\u5668\u7684\u4F3A\u670D\u5668\u3002";let G;return G="\u627E\u4E0D\u5230\u4F3A\u670D\u5668\u3002",[["batchDomainsModal",""],t,_,d,g,O,N,b,G,["iconName","peertube-x","aria-hidden","true"],[3,"onLazyLoad","value","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["action",e,3,"domains"],[1,"caption"],[1,"left-buttons"],[1,"peertube-create-button",3,"click","key.enter"],["iconName","add","aria-hidden","true"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","grey-button",3,"click"],["title",R,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1"),m(1,"my-global-icon",9),S(2),s(3,1),E(),o(),i(4,"p-table",10),M("onLazyLoad",function(O){return P(d),A(_.loadLazy(O));}),u(5,Ic,8,0,"ng-template",11)(6,Oc,8,1,"ng-template",12)(7,Nc,11,6,"ng-template",13)(8,Pc,5,2,"ng-template",14),o(),i(9,"my-batch-domains-modal",15,0),M("domains",function(O){return P(d),A(_.onDomainsToBlock(O));}),o();}t&2&&(a(4),l("value",_.blockedServers)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("rowsPerPageOptions",_.rowsPerPageOptions)("first",_.pagination.start)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()));},dependencies:[de,ve,be,Ae,Fe,he,Re,nt,$e,Ue,B,W_,ye],styles:["a[_ngcontent-%COMP%]{display:inline-block}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none!important}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:80%;color:var(--inputPlaceholderColor)}"]}));var Xi=$n;var Rc=n=>({show:n});function bc(n,r){if(n&1){let e=k();i(0,"div",20)(1,"div",21)(2,"my-advanced-input-filter",22),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}if(n&2){let e=p();a(2),l("filters",e.inputFilters);}}function Fc(n,r){if(n&1&&(i(0,"tr")(1,"th",23)(2,"span",24),s(3,1),o()(),i(4,"th",25)(5,"span",24),s(6,2),o()(),i(7,"th",26),D(8,3),m(9,"p-sortIcon",27),y(),o(),i(10,"th",28),s(11,4),o(),i(12,"th",29),s(13,5),o(),i(14,"th",30),D(15,6),m(16,"p-sortIcon",31),y(),o()()),n&2){let e=p();a(7),l("ngbTooltip",e.sortTooltip),a(7),l("ngbTooltip",e.sortTooltip);}}function hc(n,r){n&1&&(i(0,"td")(1,"span",24),s(2,7),o()());}function vc(n,r){if(n&1&&(i(0,"td",41),m(1,"my-table-expander-icon",42),o()),n&2){let e=p(),t=e.$implicit,_=e.expanded;a(),l("pRowToggler",t)("expanded",_);}}function Dc(n,r){n&1&&m(0,"my-global-icon",43);}function yc(n,r){n&1&&(i(0,"span",44),s(1,8),o());}function Lc(n,r){n&1&&(i(0,"span",45),s(1,9),o());}function $c(n,r){if(n&1&&(i(0,"tr"),u(1,hc,3,0,"td",32)(2,vc,2,2,"td",33),i(3,"td",34),m(4,"my-action-dropdown",35),o(),i(5,"td")(6,"my-video-cell",36)(7,"span",37),u(8,Dc,1,0,"my-global-icon",38),o()()(),i(9,"td"),u(10,yc,2,0,"span",39),o(),i(11,"td"),u(12,Lc,2,0,"span",40),o(),i(13,"td"),C(14),ie(15,"date"),o()()),n&2){let e=r.$implicit,t=r.expanded,_=p();a(),l("ngIf",!e.reason),a(),l("ngIf",e.reason),a(2),l("ngClass",X(13,Rc,t))("actions",_.videoBlocklistActions)("entry",e),a(2),l("video",e.video),a(2),l("ngIf",e.type===2),a(2),l("ngIf",e.video.nsfw),a(2),l("ngIf",e.unfederated),a(2),w(" ",_e(15,10,e.createdAt,"short")," ");}}function xc(n,r){if(n&1&&(i(0,"tr")(1,"td",46)(2,"div",47)(3,"div",48)(4,"span",49),s(5,10),o(),m(6,"span",50),o(),i(7,"div",51),m(8,"my-embed",36),o()()()()),n&2){let e=r.$implicit;a(6),l("innerHTML",e.reasonHtml,an),a(2),l("video",e.video);}}function Gc(n,r){n&1&&(S(0),s(1,11),E());}function Uc(n,r){n&1&&(S(0),s(1,12),E());}function wc(n,r){if(n&1&&(i(0,"tr")(1,"td",52)(2,"div",53),u(3,Gc,2,0,"ng-container",32)(4,Uc,2,0,"ng-container",32),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var co=class co extends ze{constructor(e,t,_,d,g,O,R,N){super();this.route=e;this.router=t;this.notifier=_;this.serverService=d;this.confirmService=g;this.videoBlocklistService=O;this.markdownRenderer=R;this.videoService=N;c(this,"blocklist",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"blocklistTypeFilter");c(this,"videoBlocklistActions",[]);c(this,"inputFilters",[{title:"\u9032\u968E\u7BE9\u9078\u689D\u4EF6",children:[{value:"type:auto",label:"\u81EA\u52D5\u5C01\u9396"},{value:"type:manual",label:"\u624B\u52D5\u5C01\u9396"}]}]);this.videoBlocklistActions=[[{label:"\u5167\u90E8\u52D5\u4F5C",isHeader:!0,isDisplayed:b=>b.type===si.AUTO_BEFORE_PUBLISHED},{label:"\u5207\u63DB\u5F71\u7247\u5C01\u9396\u70BA\u624B\u52D5",handler:b=>{this.videoBlocklistService.unblockVideo(b.video.id).pipe(wn(G=>this.videoBlocklistService.blockVideo([{videoId:b.video.id,unfederate:!0}]))).subscribe({next:()=>{this.notifier.success("\u5F71\u7247 "+b.video.name+" \u5DF2\u5207\u63DB\u81F3\u624B\u52D5\u5C01\u9396\u3002"),this.reloadData();},error:G=>this.notifier.error(G.message)});},isDisplayed:b=>b.type===si.AUTO_BEFORE_PUBLISHED}],[{label:"\u5C0D\u5F71\u7247\u7684\u52D5\u4F5C",isHeader:!0},{label:"\u89E3\u9664\u5C01\u9396",handler:b=>this.unblockVideo(b)},{label:"\u522A\u9664",handler:b=>pe(this,null,function*(){(yield this.confirmService.confirm("\u60A8\u771F\u7684\u60F3\u8981\u522A\u9664\u6B64\u5F71\u7247\u55CE\uFF1F","\u522A\u9664"))!==!1&&this.videoService.removeVideo(b.video.id).subscribe({next:()=>{this.notifier.success("\u5F71\u7247\u5DF2\u522A\u9664\u3002"),this.reloadData();},error:F=>this.notifier.error(F.message)});})}]];}ngOnInit(){this.serverService.getHTMLConfig().autoBlacklist.videos.ofUsers.enabled&&(this.blocklistTypeFilter=si.MANUAL),this.initialize();}getIdentifier(){return"VideoBlockListComponent";}toHtml(e){return this.markdownRenderer.textMarkdownToHTML({markdown:e});}unblockVideo(e){return pe(this,null,function*(){let t="\u60A8\u771F\u7684\u60F3\u8981\u89E3\u9664\u5C01\u9396\u6B64\u5F71\u7247\u55CE\uFF1F\u5B83\u5C07\u6703\u518D\u6B21\u51FA\u73FE\u5728\u5F71\u7247\u6E05\u55AE\u4E2D\u3002";(yield this.confirmService.confirm(t,"\u89E3\u9664\u5C01\u9396"))!==!1&&this.videoBlocklistService.unblockVideo(e.video.id).subscribe({next:()=>{this.notifier.success("\u5F71\u7247 "+e.video.name+" \u5DF2\u89E3\u9664\u5C01\u9396\u3002"),this.reloadData();},error:d=>this.notifier.error(d.message)});});}getVideoEmbed(e){return O_({embedUrl:o_({url:n_(e.video,_t.originServerUrl),title:!1,warningTitle:!1}),aspectRatio:e.video.aspectRatio,embedTitle:e.video.name});}reloadDataInternal(){this.videoBlocklistService.listBlocks({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>pe(this,null,function*(){this.totalRecords=e.total,this.blocklist=e.data;for(let t of this.blocklist)Object.assign(t,{reasonHtml:yield this.toHtml(t.reason)});}),error:e=>this.notifier.error(e.message)});}};c(co,"\u0275fac",function(t){return new(t||co)(T(Qe),T(Ze),T(K),T(Ge),T(xe),T(jn),T(gi),T(Mn));}),c(co,"\u0275cmp",h({type:co,selectors:[["my-video-block-list"]],standalone:!0,features:[ne,v],decls:10,vars:13,consts:()=>{let e;e="\u5F71\u7247\u5C01\u9396";let t;t="\u66F4\u591A\u8CC7\u8A0A";let _;_="\u52D5\u4F5C";let d;d="\u5F71\u7247 "+"\uFFFD#9\uFFFD"+""+"\uFFFD/#9\uFFFD"+"";let g;g="\u654F\u611F\u7684";let O;O="\u672A\u52A0\u5165\u806F\u76DF";let R;R="\u65E5\u671F "+"\uFFFD#16\uFFFD"+""+"\uFFFD/#16\uFFFD"+"";let N;N="\u52D5\u4F5C";let b;b="\u56E0\u70BA\u81EA\u52D5\u5C01\u9396\u65B0\u5F71\u7247\uFF0C\u6545\u6B64\u5F71\u7247\u88AB\u5C01\u9396";let G;G="\u8A72\u5217\u4E26\u672A\u63D0\u4F9B\u66F4\u591A\u8CC7\u8A0A";let F;F="NSFW";let L;L="\u672A\u52A0\u5165\u806F\u76DF";let $;$="\u5C01\u9396\u7406\u7531\uFF1A";let H;H="\u627E\u4E0D\u5230\u7B26\u5408\u76EE\u524D\u904E\u6FFE\u898F\u5247\u7684\u5DF2\u5C01\u9396\u5F71\u7247\u3002";let z;return z="\u627E\u4E0D\u5230\u5DF2\u5C01\u9396\u7684\u5F71\u7247\u3002",[e,t,_,d,g,O,R,G,F,L,$,H,z,["iconName","cross","aria-hidden","true"],["dataKey","id",3,"onLazyLoad","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],[1,"caption"],[1,"ms-auto"],[3,"search","filters"],["scope","col",2,"width","40px"],[1,"visually-hidden"],["scope","col",2,"width","150px"],["scope","col","container","body","pSortableColumn","name",3,"ngbTooltip"],["field","name"],["scope","col",2,"width","100px"],["scope","col",2,"width","120px"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[4,"ngIf"],["class","expand-cell",4,"ngIf"],[1,"action-cell"],["placement","bottom-right auto","container","body","label",N,3,"ngClass","actions","entry"],[3,"video"],["name",""],["title",b,"iconName","robot",4,"ngIf"],["class","pt-badge badge-red",4,"ngIf"],["class","pt-badge badge-blue",4,"ngIf"],[1,"expand-cell"],[3,"pRowToggler","expanded"],["title",b,"iconName","robot"],[1,"pt-badge","badge-red"],[1,"pt-badge","badge-blue"],["myAutoColspan","",1,"expand-cell"],[1,"d-flex","moderation-expanded"],[1,"left"],[1,"moderation-expanded-label"],[1,"moderation-expanded-text",3,"innerHTML"],[1,"right"],["myAutoColspan",""],[1,"no-results"]];},template:function(t,_){t&1&&(i(0,"h1"),m(1,"my-global-icon",13),S(2),s(3,0),E(),o(),i(4,"p-table",14),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(5,bc,3,1,"ng-template",15)(6,Fc,17,2,"ng-template",16)(7,$c,16,15,"ng-template",17)(8,xc,9,2,"ng-template",18)(9,wc,5,2,"ng-template",19),o()),t&2&&(a(4),l("value",_.blocklist)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows));},dependencies:[de,ve,be,Ae,Fe,ft,he,Re,nt,$e,B,Mt,tt,le,Di,Ue,Ri,ye],styles:[".moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 960px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 960px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}","my-global-icon[_ngcontent-%COMP%]{width:24px;height:24px}"]}));var Bi=co;var wt=class wt{constructor(r,e,t){this.authHttp=r;this.restExtractor=e;this.restService=t;}listRegistrations(r){let{pagination:e,sort:t,search:_}=r,d=wt.BASE_REGISTRATION_URL,g=new Et();return g=this.restService.addRestGetParams(g,e,t),_&&(g=g.append("search",_)),this.authHttp.get(d,{params:g}).pipe(ge(O=>this.restExtractor.handleError(O)));}acceptRegistration(r){let{registration:e,moderationResponse:t,preventEmailDelivery:_}=r,d=wt.BASE_REGISTRATION_URL+"/"+e.id+"/accept",g={moderationResponse:t,preventEmailDelivery:_};return this.authHttp.post(d,g).pipe(ge(O=>this.restExtractor.handleError(O)));}rejectRegistration(r){let{registration:e,moderationResponse:t,preventEmailDelivery:_}=r,d=wt.BASE_REGISTRATION_URL+"/"+e.id+"/reject",g={moderationResponse:t,preventEmailDelivery:_};return this.authHttp.post(d,g).pipe(ge(O=>this.restExtractor.handleError(O)));}removeRegistrations(r){let e=ei(r);return Ko(e).pipe(qo(t=>this.authHttp.delete(wt.BASE_REGISTRATION_URL+"/"+t.id)),Yo(),ge(t=>this.restExtractor.handleError(t)));}};c(wt,"BASE_REGISTRATION_URL",_t.apiUrl+"/api/v1/users/registrations"),c(wt,"\u0275fac",function(e){return new(e||wt)(Ee(lt),Ee(ct),Ee(vt));}),c(wt,"\u0275prov",qe({token:wt,factory:wt.ɵfac}));var Rn=wt;var fl={VALIDATORS:[se.required,se.minLength(2),se.maxLength(3e3)],MESSAGES:{required:"\u9700\u8981\u5BE9\u6838\u56DE\u61C9\u3002",minlength:"\u5BE9\u6838\u56DE\u61C9\u5FC5\u9808\u81F3\u5C11 2 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u5BE9\u6838\u56DE\u61C9\u4E0D\u80FD\u591A\u65BC 3000 \u500B\u5B57\u5143\u3002"}};var kc=["modal"],zc=n=>({"input-error":n}),Pl=n=>({"text-decoration-line-through":n});function Xc(n,r){if(n&1&&(D(0,1,1),Er(1),y()),n&2){let e=p(2);a(),W(e.registration.username),j(0);}}function Bc(n,r){if(n&1&&(D(0,1,2),Er(1),y()),n&2){let e=p(2);a(),W(e.registration.username),j(0);}}function Wc(n,r){n&1&&(i(0,"div",26),s(1,3),o());}function jc(n,r){if(n&1&&(i(0,"p",28),D(1,5),m(2,"em"),y(),o()),n&2){let e=p(3);l("ngClass",X(2,Pl,e.isPreventEmailDeliveryChecked())),a(2),W(e.registration.email),j(1);}}function Hc(n,r){if(n&1&&(i(0,"div",26),D(1,6),m(2,"em"),y(),o()),n&2){let e=p(3);a(2),W(e.registration.email),j(1);}}function Jc(n,r){if(n&1&&(S(0),i(1,"p"),D(2,4),m(3,"strong")(4,"em"),y(),o(),u(5,jc,3,4,"p",27)(6,Hc,3,1,"div",16),E()),n&2){let e=p(2);a(4),W(e.registration.username),j(2),a(),l("ngIf",e.isEmailEnabled()),a(),l("ngIf",!e.isEmailEnabled());}}function Kc(n,r){if(n&1&&(i(0,"div",26),D(1,8),m(2,"em"),y(),o()),n&2){let e=p(3);a(2),W(e.registration.email),j(1);}}function Yc(n,r){if(n&1&&(S(0),i(1,"p",28),D(2,7),m(3,"em")(4,"strong"),y(),o(),u(5,Kc,3,1,"div",16),E()),n&2){let e=p(2);a(),l("ngClass",X(3,Pl,e.isPreventEmailDeliveryChecked())),a(3),W(e.registration.email),j(2),a(),l("ngIf",!e.isEmailEnabled());}}function qc(n,r){if(n&1&&(i(0,"div",29),C(1),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.moderationResponse," ");}}function Qc(n,r){if(n&1){let e=k();i(0,"div",9)(1,"h4",10),D(2,1),u(3,Xc,2,1,"ng-container",11)(4,Bc,2,1,"ng-container",11),y(),o(),i(5,"button",12),M("click",function(){P(e);let _=p();return A(_.hide());}),m(6,"my-global-icon",13),o()(),i(7,"form",14),M("ngSubmit",function(){P(e);let _=p();return A(_.processRegistration());}),i(8,"div",15),u(9,Wc,2,0,"div",16),i(10,"div",17),u(11,Jc,7,3,"ng-container",11)(12,Yc,6,5,"ng-container",11),o(),i(13,"div",18)(14,"label",19),s(15,2),o(),m(16,"textarea",20),u(17,qc,2,1,"div",21),o(),i(18,"div",18),m(19,"my-peertube-checkbox",22),o()(),i(20,"div",23)(21,"input",24),M("click",function(){P(e);let _=p();return A(_.hide());})("key.enter",function(){P(e);let _=p();return A(_.hide());}),o(),m(22,"input",25),o()();}if(n&2){let e=p();a(3),l("ngIf",e.isAccept()),a(),l("ngIf",e.isReject()),a(3),l("formGroup",e.form),a(2),l("ngIf",!e.registration.emailVerified),a(2),l("ngIf",e.isAccept()),a(),l("ngIf",e.isReject()),a(4),l("ngClass",X(11,zc,e.formErrors.moderationResponse)),a(),l("ngIf",e.formErrors.moderationResponse),a(2),l("disabled",!e.isEmailEnabled()),a(3),l("value",e.getSubmitValue())("disabled",!e.form.valid);}}var po=class po extends yt{constructor(e,t,_,d,g){super();this.formReactiveService=e;this.server=t;this.modalService=_;this.notifier=d;this.registrationService=g;c(this,"modal");c(this,"registrationProcessed",new ai());c(this,"registration");c(this,"openedModal");c(this,"processMode");}ngOnInit(){this.buildForm({moderationResponse:fl,preventEmailDelivery:null});}isAccept(){return this.processMode==="accept";}isReject(){return this.processMode==="reject";}openModal(e,t){this.processMode=t,this.registration=e,this.form.patchValue({preventEmailDelivery:!this.isEmailEnabled()||e.emailVerified!==!0}),this.openedModal=this.modalService.open(this.modal,{centered:!0});}hide(){this.form.reset(),this.openedModal.close();}getSubmitValue(){return this.isAccept()?"\u63A5\u53D7\u8A3B\u518A":"\u62D2\u7D55\u8A3B\u518A";}processRegistration(){return this.isAccept()?this.acceptRegistration():this.rejectRegistration();}isEmailEnabled(){return this.server.getHTMLConfig().email.enabled;}isPreventEmailDeliveryChecked(){return this.form.value.preventEmailDelivery;}acceptRegistration(){this.registrationService.acceptRegistration({registration:this.registration,moderationResponse:this.form.value.moderationResponse,preventEmailDelivery:this.form.value.preventEmailDelivery}).subscribe({next:()=>{this.notifier.success(""+this.registration.username+" \u5E33\u865F\u5DF2\u5EFA\u7ACB"),this.registrationProcessed.emit(),this.hide();},error:e=>this.notifier.error(e.message)});}rejectRegistration(){this.registrationService.rejectRegistration({registration:this.registration,moderationResponse:this.form.value.moderationResponse,preventEmailDelivery:this.form.value.preventEmailDelivery}).subscribe({next:()=>{this.notifier.success(""+this.registration.username+" \u8A3B\u518A\u5DF2\u62D2\u7D55"),this.registrationProcessed.emit(),this.hide();},error:e=>this.notifier.error(e.message)});}};c(po,"\u0275fac",function(t){return new(t||po)(T(Nt),T(Ge),T(di),T(K),T(Rn));}),c(po,"\u0275cmp",h({type:po,selectors:[["my-process-registration-modal"]],viewQuery:function(t,_){if(t&1&&gt(kc,7),t&2){let d;Ct(d=St())&&(_.modal=d.first);}},outputs:{registrationProcessed:"registrationProcessed"},standalone:!0,features:[ne,v],decls:2,vars:0,consts:()=>{let e;e="\u95DC\u9589\u6B64\u6A21\u5F0F";let t;t="\u907F\u514D\u50B3\u9001\u96FB\u5B50\u90F5\u4EF6\u7D66\u4F7F\u7528\u8005";let _;_="\u53D6\u6D88";let d;d=""+"\uFFFD*3:1\uFFFD\uFFFD#1:1\uFFFD"+"\u63A5\u53D7 "+"[\uFFFD0:1\uFFFD|\uFFFD0:2\uFFFD]"+" \u8A3B\u518A"+"[\uFFFD/#1:1\uFFFD\uFFFD/*3:1\uFFFD|\uFFFD/#1:2\uFFFD\uFFFD/*4:2\uFFFD]"+""+"\uFFFD*4:2\uFFFD\uFFFD#1:2\uFFFD"+"\u62D2\u7D55 "+"[\uFFFD0:1\uFFFD|\uFFFD0:2\uFFFD]"+" \u8A3B\u518A"+"[\uFFFD/#1:1\uFFFD\uFFFD/*3:1\uFFFD|\uFFFD/#1:2\uFFFD\uFFFD/*4:2\uFFFD]"+"",d=Ce(d);let g;g="\u50B3\u9001\u8A0A\u606F\u7D66\u4F7F\u7528\u8005";let O;O="\u8A3B\u518A\u96FB\u5B50\u90F5\u4EF6\u5C1A\u672A\u9A57\u8B49\u3002\u96FB\u5B50\u90F5\u4EF6\u905E\u9001\u5DF2\u9810\u8A2D\u505C\u7528\u3002";let R;R=""+"\uFFFD#3\uFFFD"+"\u63A5\u53D7"+"\uFFFD/#3\uFFFD"+"\xA0"+"\uFFFD#4\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#4\uFFFD"+" \u8A3B\u518A\u5C07\u6703\u5EFA\u7ACB\u5E33\u865F\u8207\u983B\u9053\u3002 ";let N;N="\u89E3\u91CB\u5176\u5E33\u865F\u5DF2\u4F7F\u7528\u60A8\u5C07\u5728\u4E0B\u9762\u7DE8\u5BEB\u7684\u5BE9\u6838\u56DE\u8986\u5EFA\u7ACB\u7684\u96FB\u5B50\u90F5\u4EF6\u5C07\u6703\u50B3\u9001\u81F3 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"\u3002 ";let b;b="\u6B64\u7AD9\u53F0\u672A\u555F\u7528\u96FB\u5B50\u90F5\u4EF6\uFF0C\u56E0\u6B64 PeerTube \u5C07\u7121\u6CD5\u50B3\u9001\u89E3\u91CB\u5176\u5E33\u865F\u5DF2\u4F7F\u7528\u60A8\u5C07\u5728\u4E0B\u9762\u7DE8\u5BEB\u7684\u5BE9\u6838\u56DE\u8986\u5EFA\u7ACB\u7684\u96FB\u5B50\u90F5\u4EF6\u81F3 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"\u3002 ";let G;G="\u96FB\u5B50\u90F5\u4EF6\u5C07\u50B3\u9001\u81F3 "+"\uFFFD#3\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#3\uFFFD"+"\uFF0C\u89E3\u91CB\u5176\u8A3B\u518A\u8ACB\u6C42\u5DF2"+"\uFFFD#4\uFFFD"+"\u88AB\u62D2\u7D55"+"\uFFFD/#4\uFFFD"+"\uFF0C\u60A8\u5C07\u5728\u4E0B\u65B9\u5BEB\u4E0B\u5BE9\u6838\u56DE\u61C9\u3002 ";let F;return F="\u6B64\u7AD9\u53F0\u672A\u555F\u7528\u96FB\u5B50\u90F5\u4EF6\uFF0C\u56E0\u6B64 PeerTube \u7121\u6CD5\u50B3\u9001\u5176\u8A3B\u518A\u8ACB\u6C42\u5DF2\u4F7F\u7528\u60A8\u5C07\u5728\u4E0B\u9762\u7DE8\u5BEB\u7684\u5BE9\u6838\u56DE\u8986\u88AB\u62D2\u7D55\u7684\u96FB\u5B50\u90F5\u4EF6\u50B3\u9001\u81F3 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"\u3002 ",[["modal",""],d,g,O,R,N,b,G,F,[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],["novalidate","",3,"ngSubmit","formGroup"],[1,"modal-body","mb-3"],["class","alert alert-warning",4,"ngIf"],[1,"description"],[1,"form-group"],["for","moderationResponse"],["formControlName","moderationResponse","ngbAutofocus","","name","moderationResponse","id","moderationResponse",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["inputName","preventEmailDelivery","formControlName","preventEmailDelivery","labelText",t,3,"disabled"],[1,"modal-footer","inputs"],["type","button","role","button","value",_,1,"peertube-button","grey-button",3,"click","key.enter"],["type","submit",1,"peertube-button","orange-button",3,"value","disabled"],[1,"alert","alert-warning"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["role","alert",1,"form-error"]];},template:function(t,_){t&1&&u(0,Qc,23,13,"ng-template",null,0,Sn);},dependencies:[B,de,ce,Ot,Ve,Se,Me,Pe,fe,ke,le,et],encapsulation:2}));var Wi=po;function Zc(n,r){if(n&1&&C(0),n&2){let e=p(2);w(" \u2713 ",e.entry.email," ");}}function ed(n,r){if(n&1&&(i(0,"em"),C(1),o()),n&2){let e=p(3);a(),w("? ",e.entry.email,"");}}function td(n,r){if(n&1&&u(0,ed,2,1,"em",1),n&2){let e=p(2);l("ngIf",!e.entry.emailVerified);}}function nd(n,r){if(n&1&&u(0,Zc,1,1)(1,td,1,1,"em"),n&2){let e=p();Bt(e.entry.emailVerified===!0?0:1);}}function od(n,r){if(n&1&&C(0),n&2){let e=p();w(" ",e.entry.email," ");}}var mo=class mo{constructor(){c(this,"entry");c(this,"showEmailVerifyInformation");}getTitle(){return this.entry.emailVerified?"\u5DF2\u9A57\u8B49\u4F7F\u7528\u8005\u96FB\u5B50\u90F5\u4EF6":"\u4F7F\u7528\u8005\u96FB\u5B50\u90F5\u4EF6\u5C1A\u672A\u9A57\u8B49";}};c(mo,"\u0275fac",function(e){return new(e||mo)();}),c(mo,"\u0275cmp",h({type:mo,selectors:[["my-user-email-info"]],inputs:{entry:"entry",showEmailVerifyInformation:[2,"showEmailVerifyInformation","showEmailVerifyInformation",Ja]},standalone:!0,features:[wa,v],decls:4,vars:3,consts:[[3,"href","title"],[4,"ngIf"]],template:function(e,t){e&1&&(S(0),i(1,"a",0),u(2,nd,2,1)(3,od,1,1),o(),E()),e&2&&(a(),l("href","mailto:"+t.entry.email,Xe)("title",t.getTitle()),a(),Bt(t.showEmailVerifyInformation?2:3));},dependencies:[B],styles:["a[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}));var uo=mo;var id=["processRegistrationModal"],rd=n=>({show:n});function ad(n,r){if(n&1&&m(0,"my-action-dropdown",28),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function _d(n,r){if(n&1){let e=k();i(0,"div",23)(1,"div",24),u(2,ad,1,2,"my-action-dropdown",25),o(),i(3,"div",26)(4,"my-advanced-input-filter",27),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode());}}function ld(n,r){if(n&1&&(i(0,"tr")(1,"th",29),m(2,"p-tableHeaderCheckbox",30),o(),i(3,"th",29)(4,"span",31),s(5,2),o()(),i(6,"th",32)(7,"span",31),s(8,3),o()(),i(9,"th",33),s(10,4),o(),i(11,"th",33),s(12,5),o(),i(13,"th",33),s(14,6),o(),i(15,"th",33),s(16,7),o(),i(17,"th",34),D(18,8),m(19,"p-sortIcon",35),y(),o(),i(20,"th",33),s(21,9),o(),i(22,"th",36),D(23,10),m(24,"p-sortIcon",37),y(),o()()),n&2){let e=p();a(17),l("ngbTooltip",e.sortTooltip),a(5),l("ngbTooltip",e.sortTooltip);}}function sd(n,r){if(n&1&&(i(0,"div",53),m(1,"my-global-icon",54),o()),n&2){let e=p().$implicit;l("title",e.state.label);}}function cd(n,r){if(n&1&&(i(0,"div",55),m(1,"my-global-icon",56),o()),n&2){let e=p().$implicit;l("title",e.state.label);}}function dd(n,r){if(n&1&&(i(0,"tr",38)(1,"td",39),m(2,"p-tableCheckbox",40),o(),i(3,"td",41),m(4,"my-table-expander-icon",42),o(),i(5,"td",43),m(6,"my-action-dropdown",44),o(),i(7,"td")(8,"div",45)(9,"div")(10,"span"),C(11),o(),i(12,"span",46),C(13),o()()()(),i(14,"td"),m(15,"my-user-email-info",47),o(),i(16,"td")(17,"div",45)(18,"div")(19,"span"),C(20),o(),i(21,"span",46),C(22),o()()()(),i(23,"td",48),C(24),o(),i(25,"td",49),u(26,sd,2,1,"div",50)(27,cd,2,1,"div",51),o(),i(28,"td",48),C(29),o(),i(30,"td",52),C(31),ie(32,"date"),o()()),n&2){let e=r.expanded,t=r.$implicit,_=p();l("pSelectableRow",t),a(2),l("value",t),a(2),l("pRowToggler",t)("expanded",e),a(2),l("ngClass",X(25,rd,e))("actions",_.registrationActions)("entry",t),a(5),I(t.username),a(2),I(t.accountDisplayName),a(2),l("entry",t)("showEmailVerifyInformation",_.requiresEmailVerification),a(5),I(t.channelHandle),a(2),I(t.channelDisplayName),a(),l("ngbTooltip",t.registrationReason),a(),w(" ",t.registrationReason," "),a(),l("pRowToggler",t),a(),l("ngIf",_.isRegistrationAccepted(t)),a(),l("ngIf",_.isRegistrationRejected(t)),a(),l("ngbTooltip",t.moderationResponse),a(),w(" ",t.moderationResponse," "),a(),l("pRowToggler",t),a(),I(_e(32,22,t.createdAt,"short"));}}function pd(n,r){if(n&1&&(i(0,"div")(1,"span",61),s(2,12),o(),m(3,"span",62),o()),n&2){let e=p().$implicit;a(3),l("innerHTML",e.moderationResponseHTML,an);}}function md(n,r){if(n&1&&(i(0,"tr")(1,"td",57)(2,"div",58)(3,"div",59)(4,"div",60)(5,"span",61),s(6,11),o(),m(7,"span",62),o(),u(8,pd,4,1,"div",63),o()()()()),n&2){let e=r.$implicit;a(7),l("innerHTML",e.registrationReasonHTML,an),a(),l("ngIf",e.moderationResponse);}}function ud(n,r){n&1&&(S(0),s(1,13),E());}function gd(n,r){n&1&&(S(0),s(1,14),E());}function Cd(n,r){if(n&1&&(i(0,"tr")(1,"td",57)(2,"div",64),u(3,ud,2,0,"ng-container",63)(4,gd,2,0,"ng-container",63),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var go=class go extends ze{constructor(e,t,_,d,g,O,R){super();this.route=e;this.router=t;this.server=_;this.notifier=d;this.markdownRenderer=g;this.confirmService=O;this.adminRegistrationService=R;c(this,"processRegistrationModal");c(this,"registrations",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"registrationActions",[]);c(this,"bulkActions",[]);c(this,"inputFilters",[]);c(this,"requiresEmailVerification");this.registrationActions=[[{label:"\u63A5\u53D7\u6B64\u8ACB\u6C42",handler:N=>this.openRegistrationRequestProcessModal(N,"accept"),isDisplayed:N=>N.state.id===Qo.PENDING},{label:"\u56DE\u7D55\u6B64\u8ACB\u6C42",handler:N=>this.openRegistrationRequestProcessModal(N,"reject"),isDisplayed:N=>N.state.id===Qo.PENDING},{label:"\u79FB\u9664\u6B64\u8ACB\u6C42",description:"\u5F9E\u6E05\u55AE\u4E2D\u79FB\u9664\u8ACB\u6C42\u3002\u4F7F\u7528\u8005\u53EF\u4EE5\u518D\u6B21\u8A3B\u518A\u3002",handler:N=>this.removeRegistrations([N])}]],this.bulkActions=[{label:"\u522A\u9664",handler:N=>this.removeRegistrations(N)}];}ngOnInit(){this.initialize(),this.server.getConfig().subscribe(e=>{this.requiresEmailVerification=e.signup.requiresEmailVerification;});}getIdentifier(){return"RegistrationListComponent";}isRegistrationAccepted(e){return e.state.id===Qo.ACCEPTED;}isRegistrationRejected(e){return e.state.id===Qo.REJECTED;}onRegistrationProcessed(){this.reloadData();}reloadDataInternal(){this.adminRegistrationService.listRegistrations({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>pe(this,null,function*(){this.totalRecords=e.total,this.registrations=e.data;for(let t of this.registrations)t.registrationReasonHTML=yield this.toHtml(t.registrationReason),t.moderationResponseHTML=yield this.toHtml(t.moderationResponse);}),error:e=>this.notifier.error(e.message)});}openRegistrationRequestProcessModal(e,t){this.processRegistrationModal.openModal(e,t);}removeRegistrations(e){return pe(this,null,function*(){let t={count:e.length,username:e[0].username},_=me("\u60A8\u771F\u7684\u60F3\u8981\u522A\u9664 {count, plural, =1 {{username} \u7684\u8A3B\u518A\u8ACB\u6C42\u55CE\uFF1F} other {{count} \u500B\u8A3B\u518A\u8ACB\u6C42\u55CE\uFF1F}}",t);(yield this.confirmService.confirm(_,"\u522A\u9664"))!==!1&&this.adminRegistrationService.removeRegistrations(e).subscribe({next:()=>{let g=me("\u5DF2\u79FB\u9664 {count, plural, =1 {{username} \u7684\u8A3B\u518A\u8ACB\u6C42} other {{count} \u500B\u8A3B\u518A\u8ACB\u6C42}}",t);this.notifier.success(g),this.reloadData();},error:g=>this.notifier.error(g.message)});});}toHtml(e){return this.markdownRenderer.textMarkdownToHTML({markdown:e});}};c(go,"\u0275fac",function(t){return new(t||go)(T(Qe),T(Ze),T(Ge),T(K),T(gi),T(xe),T(Rn));}),c(go,"\u0275cmp",h({type:go,selectors:[["my-registration-list"]],viewQuery:function(t,_){if(t&1&&gt(id,7),t&2){let d;Ct(d=St())&&(_.processRegistrationModal=d.first);}},standalone:!0,features:[ne,v],decls:12,vars:14,consts:()=>{let e;e="\u8A3B\u518A\u8ACB\u6C42";let t;t="\u6279\u6B21\u52D5\u4F5C";let _;_="\u9078\u53D6\u6240\u6709\u5217";let d;d="\u66F4\u591A\u8CC7\u8A0A";let g;g="\u52D5\u4F5C";let O;O="\u5E33\u865F";let R;R="\u96FB\u5B50\u90F5\u4EF6";let N;N="\u983B\u9053";let b;b="\u8A3B\u518A\u7406\u7531";let G;G="\u9673\u8FF0 "+"\uFFFD#19\uFFFD"+""+"\uFFFD/#19\uFFFD"+"";let F;F="\u5BE9\u6838\u56DE\u61C9";let L;L="\u8ACB\u6C42\u65BC "+"\uFFFD#24\uFFFD"+""+"\uFFFD/#24\uFFFD"+"";let $;$="\u9078\u53D6\u6B64\u5217";let H;H="\u52D5\u4F5C";let z;z="\u8A3B\u518A\u7406\u7531\uFF1A";let V;V="\u5BE9\u6838\u56DE\u61C9\uFF1A";let x;x="\u627E\u4E0D\u5230\u8207\u76EE\u524D\u904E\u6FFE\u689D\u4EF6\u76F8\u7B26\u7684\u8A3B\u518A\u3002";let Y;return Y="\u627E\u4E0D\u5230\u8A3B\u518A\u3002",[["processRegistrationModal",""],e,d,g,O,R,N,b,G,F,L,z,V,x,Y,["iconName","user","aria-hidden","true"],["dataKey","id",3,"onLazyLoad","selectionChange","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","lazyLoadOnInit","selection","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],[3,"registrationProcessed"],[1,"caption"],[1,"left-buttons"],["label",t,"theme","orange",3,"actions","entry",4,"ngIf"],[1,"ms-auto"],[3,"search"],["label",t,"theme","orange",3,"actions","entry"],["scope","col",2,"width","40px"],["ariaLabel",_],[1,"visually-hidden"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","state",2,"width","80px",3,"ngbTooltip"],["field","state"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[3,"pSelectableRow"],[1,"checkbox-cell"],["ariaLabel",$,3,"value"],[1,"expand-cell"],[3,"pRowToggler","expanded"],[1,"action-cell"],["placement","bottom-right top-right left auto","container","body","label",H,3,"ngClass","actions","entry"],[1,"chip","two-lines"],[1,"muted"],[3,"entry","showEmailVerifyInformation"],["container","body","placement","left auto",3,"ngbTooltip"],[1,"c-hand","abuse-states",3,"pRowToggler"],["class","pt-badge badge-success",3,"title",4,"ngIf"],["class","pt-badge badge-danger",3,"title",4,"ngIf"],[1,"c-hand",3,"pRowToggler"],[1,"pt-badge","badge-success",3,"title"],["iconName","tick"],[1,"pt-badge","badge-danger",3,"title"],["iconName","cross"],["myAutoColspan",""],[1,"moderation-expanded"],[1,"left"],[1,"d-flex"],[1,"moderation-expanded-label"],[1,"moderation-expanded-text",3,"innerHTML"],[4,"ngIf"],[1,"no-results"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1"),m(1,"my-global-icon",15),S(2),s(3,1),E(),o(),i(4,"p-table",16),M("onLazyLoad",function(O){return P(d),A(_.loadLazy(O));}),Oe("selectionChange",function(O){return P(d),Ie(_.selectedRows,O)||(_.selectedRows=O),A(O);}),u(5,_d,5,1,"ng-template",17)(6,ld,25,2,"ng-template",18)(7,dd,33,27,"ng-template",19)(8,md,9,2,"ng-template",20)(9,Cd,5,2,"ng-template",21),o(),i(10,"my-process-registration-modal",22,0),M("registrationProcessed",function(){return P(d),A(_.onRegistrationProcessed());}),o();}t&2&&(a(4),l("value",_.registrations)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1),Te("selection",_.selectedRows),l("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows));},dependencies:[de,ve,be,Ae,Fe,tn,ft,he,Lt,$t,Re,B,tt,nt,$e,Mt,le,uo,Ue,Wi,ye],styles:[".moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 960px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 960px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}","my-global-icon[_ngcontent-%COMP%]{width:24px;height:24px}"]}));var ji=go;var Co=class Co{};c(Co,"\u0275fac",function(e){return new(e||Co)();}),c(Co,"\u0275cmp",h({type:Co,selectors:[["ng-component"]],standalone:!0,features:[v],decls:9,vars:0,consts:()=>{let r;r="\u7AD9\u53F0\u76E3\u8996\u6587\u5B57\u6E05\u55AE";let e;e="\u5305\u542B\u4EFB\u4F55\u76E3\u8996\u55AE\u5B57\u7684\u5F71\u7247\u540D\u7A31/\u63CF\u8FF0\u8207\u7559\u8A00\u90FD\u6703\u81EA\u52D5\u4EE5\u6E05\u55AE\u540D\u7A31\u6A19\u8A18\u3002";let t;return t="\u9019\u4E9B\u81EA\u52D5\u6A19\u7C64\u53EF\u7528\u65BC\u904E\u6FFE\u7559\u8A00\u8207\u5F71\u7247\u3002",[r,e,t,["iconName","eye-open","aria-hidden","true"],[1,"d-block"],[1,"d-block","mb-3"],["mode","admin"]];},template:function(e,t){e&1&&(i(0,"h1"),m(1,"my-global-icon",3),S(2),s(3,0),E(),o(),i(4,"em",4),s(5,1),o(),i(6,"em",5),s(7,2),o(),m(8,"my-watched-words-list-admin-owner",6));},dependencies:[de,J_],encapsulation:2}));var Hi=Co;var Al=[{path:"moderation",children:[{path:"",redirectTo:"abuses/list",pathMatch:"full"},{path:"video-abuses",redirectTo:"abuses/list",pathMatch:"full"},{path:"video-abuses/list",redirectTo:"abuses/list",pathMatch:"full"},{path:"abuses/list",component:ki,canActivate:[De],data:{userRight:Q.MANAGE_ABUSES,meta:{title:"\u56DE\u5831"}}},{path:"video-blacklist",redirectTo:"video-blocks/list",pathMatch:"full"},{path:"video-auto-blacklist",redirectTo:"video-blocks/list",pathMatch:"full"},{path:"video-auto-blacklist/list",redirectTo:"video-blocks/list",pathMatch:"full"},{path:"video-blacklist",redirectTo:"video-blocks/list",pathMatch:"full"},{path:"video-blocks/list",component:Bi,canActivate:[De],data:{userRight:Q.MANAGE_VIDEO_BLACKLIST,meta:{title:"\u5DF2\u5C01\u9396\u7684\u5F71\u7247"}}},{path:"registrations/list",component:ji,canActivate:[De],data:{userRight:Q.MANAGE_REGISTRATIONS,meta:{title:"\u4F7F\u7528\u8005\u8A3B\u518A"}}},{path:"video-comments",redirectTo:"video-comments/list",pathMatch:"full"},{path:"video-comments/list",redirectTo:"/admin/comments/list",pathMatch:"full"},{path:"blocklist/accounts",component:zi,canActivate:[De],data:{userRight:Q.MANAGE_ACCOUNTS_BLOCKLIST,meta:{title:"\u5DF2\u975C\u97F3\u7684\u5E33\u865F"}}},{path:"blocklist/servers",component:Xi,canActivate:[De],data:{userRight:Q.MANAGE_SERVERS_BLOCKLIST,meta:{title:"\u5DF2\u975C\u97F3\u7684\u7AD9\u81FA"}}},{path:"watched-words/list",component:Hi,canActivate:[De],data:{userRight:Q.MANAGE_INSTANCE_WATCHED_WORDS,meta:{title:"\u5DF2\u89C0\u770B\u7684\u5F71\u7247"}}}]}];var mt=class mt{constructor(r,e,t,_){this.authHttp=r;this.restExtractor=e;this.restService=t;this.pluginService=_;}getPluginTypeLabel(r){return r===Qt.PLUGIN?"\u5916\u639B\u7A0B\u5F0F":"\u4F48\u666F\u4E3B\u984C";}getPlugins(r,e,t){let _=this.restService.componentToRestPagination(e),d=new Et();return d=this.restService.addRestGetParams(d,_,t),d=d.append("pluginType",r.toString()),this.authHttp.get(mt.BASE_PLUGIN_URL,{params:d}).pipe(ge(g=>this.restExtractor.handleError(g)));}searchAvailablePlugins(r,e,t,_){let d=this.restService.componentToRestPagination(e),g=new Et();return g=this.restService.addRestGetParams(g,d,t),g=g.append("pluginType",r.toString()),_&&(g=g.append("search",_)),this.authHttp.get(mt.BASE_PLUGIN_URL+"/available",{params:g}).pipe(ge(O=>this.restExtractor.handleError(O)));}getPlugin(r){let e=mt.BASE_PLUGIN_URL+"/"+r;return this.authHttp.get(e).pipe(ge(t=>this.restExtractor.handleError(t)));}getPluginRegisteredSettings(r,e){let t=this.pluginService.nameToNpmName(r,e),_=mt.BASE_PLUGIN_URL+"/"+t+"/registered-settings";return this.authHttp.get(_).pipe(ge(d=>this.restExtractor.handleError(d)));}updatePluginSettings(r,e,t){let _=this.pluginService.nameToNpmName(r,e),d=mt.BASE_PLUGIN_URL+"/"+_+"/settings";return this.authHttp.put(d,{settings:t}).pipe(ge(g=>this.restExtractor.handleError(g)));}uninstall(r,e){let t={npmName:this.pluginService.nameToNpmName(r,e)};return this.authHttp.post(mt.BASE_PLUGIN_URL+"/uninstall",t).pipe(ge(_=>this.restExtractor.handleError(_)));}update(r,e){let t={npmName:this.pluginService.nameToNpmName(r,e)};return this.authHttp.post(mt.BASE_PLUGIN_URL+"/update",t).pipe(ge(_=>this.restExtractor.handleError(_)));}install(r){let e={npmName:r};return this.authHttp.post(mt.BASE_PLUGIN_URL+"/install",e).pipe(ge(t=>this.restExtractor.handleError(t)));}getPluginOrThemeHref(r,e){return`https://www.npmjs.com/package/peertube-${r===Qt.PLUGIN?"plugin":"theme"}-${e}`;}};c(mt,"BASE_PLUGIN_URL",_t.apiUrl+"/api/v1/plugins"),c(mt,"\u0275fac",function(e){return new(e||mt)(Ee(lt),Ee(ct),Ee(vt),Ee(On));}),c(mt,"\u0275prov",qe({token:mt,factory:mt.ɵfac}));var Vt=mt;var Ed=[[["badges"]],[["buttons"]]],Td=["badges","buttons"],So=class So{constructor(r){this.pluginApiService=r;c(this,"plugin");c(this,"version");c(this,"pluginType");}getPluginOrThemeHref(r){return this.pluginApiService.getPluginOrThemeHref(this.pluginType,r);}};c(So,"\u0275fac",function(e){return new(e||So)(T(Vt));}),c(So,"\u0275cmp",h({type:So,selectors:[["my-plugin-card"]],inputs:{plugin:"plugin",version:"version",pluginType:"pluginType"},standalone:!0,features:[v],ngContentSelectors:Td,decls:17,vars:5,consts:()=>{let r;r="\u5916\u639B\u7A0B\u5F0F\u9996\u9801\uFF08\u65B0\u8996\u7A97\uFF09";let e;return e="\u5916\u639B\u7A0B\u5F0F\u9996\u9801\uFF08\u65B0\u8996\u7A97\uFF09",[[1,"card","plugin"],[1,"card-body"],[1,"first-row"],[1,"plugin-name"],[1,"plugin-version"],["target","_blank","rel","noopener noreferrer","title",r,1,"plugin-icon",3,"href"],["iconName","home"],["target","_blank","rel","noopener noreferrer","title",e,1,"plugin-icon",3,"href"],["iconName","npm"],[1,"buttons"],[1,"second-row"],["dir","auto",1,"description"]];},template:function(e,t){e&1&&(Xa(Ed),i(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),C(4),o(),i(5,"span",4),C(6),o(),i(7,"a",5),m(8,"my-global-icon",6),o(),i(9,"a",7),m(10,"my-global-icon",8),o(),Tr(11),i(12,"div",9),Tr(13,1),o()(),i(14,"div",10)(15,"div",11),C(16),o()()()()),e&2&&(a(4),I(t.plugin.name),a(2),I(t.version),a(),l("href",t.plugin.homepage,Xe),a(2),l("href",t.getPluginOrThemeHref(t.plugin.name),Xe),a(7),I(t.plugin.description));},dependencies:[de],styles:[".plugin[_ngcontent-%COMP%]{margin:15px 0;background-color:var(--submenuBackgroundColor)}.first-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.first-row[_ngcontent-%COMP%]   .plugin-name[_ngcontent-%COMP%]{font-weight:600;margin-inline-end:.625rem}.first-row[_ngcontent-%COMP%]   .plugin-version[_ngcontent-%COMP%]{opacity:.7}.first-row[_ngcontent-%COMP%]   .plugin-icon[_ngcontent-%COMP%]{margin-inline-start:.625rem}.first-row[_ngcontent-%COMP%]   .plugin-icon[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .first-row[_ngcontent-%COMP%]   .plugin-icon[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .first-row[_ngcontent-%COMP%]   .plugin-icon[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.first-row[_ngcontent-%COMP%]   .plugin-icon[_ngcontent-%COMP%]   my-global-icon[iconName=npm][_ngcontent-%COMP%]     svg path{fill:var(--greyForegroundColor)}.first-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{width:max-content;margin-inline-start:auto}.second-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;align-items:center;justify-content:space-between}.second-row[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{opacity:.8}.action-button[_ngcontent-%COMP%]{display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.action-button[_ngcontent-%COMP%]:hover, .action-button[_ngcontent-%COMP%]:focus, .action-button[_ngcontent-%COMP%]:active{text-decoration:none!important}.action-button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.action-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}.action-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;display:inline-block;width:21px;top:-2px;margin-inline-end:0}@media screen and (max-width: 800px){.first-row[_ngcontent-%COMP%]{flex-wrap:wrap}.first-row[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;margin-top:10px}}"]}));var Eo=So;var Rl=n=>({pluginType:n}),bl=n=>({active:n}),Id=()=>({pluginType:1}),Od=()=>({pluginType:2}),To=class To{constructor(){c(this,"pluginType");}};c(To,"\u0275fac",function(e){return new(e||To)();}),c(To,"\u0275cmp",h({type:To,selectors:[["my-plugin-navigation"]],inputs:{pluginType:"pluginType"},standalone:!0,features:[v],decls:11,vars:16,consts:()=>{let r;r="\u5728\u5DF2\u5B89\u88DD\u7684\u5916\u639B\u7A0B\u5F0F\u8207\u4F48\u666F\u4E3B\u984C\u9593\u700F\u89BD\u6216\u627E\u9EDE\u65B0\u7684";let e;e="\u5728\u5916\u639B\u7A0B\u5F0F\u8207\u4F48\u666F\u4E3B\u984C\u9593\u700F\u89BD";let t;t="\u5DF2\u5B89\u88DD";let _;_="\u641C\u5C0B";let d;d="\u5916\u639B\u7A0B\u5F0F";let g;return g="\u4F48\u666F\u4E3B\u984C",[t,_,d,g,[1,"root"],["role","group","aria-label",r,1,"btn-group","select-button"],["routerLink","/admin/plugins/list-installed","routerLinkActive","active",3,"queryParams"],["routerLink","/admin/plugins/search","routerLinkActive","active",3,"queryParams"],["role","group","aria-label",e,1,"btn-group","select-button"],["routerLink",".","queryParamsHandling","merge",1,"",3,"ngClass","queryParams"]];},template:function(e,t){e&1&&(i(0,"div",4)(1,"div",5)(2,"a",6),s(3,0),o(),i(4,"a",7),s(5,1),o()(),i(6,"div",8)(7,"a",9),s(8,2),o(),i(9,"a",9),s(10,3),o()()()),e&2&&(a(2),l("queryParams",X(6,Rl,t.pluginType)),a(2),l("queryParams",X(8,Rl,t.pluginType)),a(3),l("ngClass",X(10,bl,t.pluginType===1))("queryParams",Pt(12,Id)),a(2),l("ngClass",X(13,bl,t.pluginType===2))("queryParams",Pt(15,Od)));},dependencies:[Le,Ya,le],styles:[".root[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn-group[_ngcontent-%COMP%]:not(:last-child){margin-inline-end:.9375rem}"]}));var Io=To;function Nd(n,r){if(n&1&&(i(0,"div",4),C(1),o()),n&2){let e=p();a(),w(" ",e.getNoResultMessage(),`
`);}}function Md(n,r){if(n&1&&m(0,"my-edit-button",10),n&2){let e=p().$implicit,t=p();l("ptRouterLink",t.getShowRouterLink(e))("responsiveLabel",!0);}}function fd(n,r){if(n&1){let e=k();i(0,"my-button",11),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.update(_));}),o();}if(n&2){let e=p().$implicit,t=p();l("loading",t.isUpdating(e))("label",t.getUpdateLabel(e))("responsiveLabel",!0),It("disabled",t.isUpdating(e)||t.isUninstalling(e));}}function Pd(n,r){if(n&1){let e=k();S(0),i(1,"my-plugin-card",5)(2,"div",6),u(3,Md,1,2,"my-edit-button",7)(4,fd,1,4,"my-button",8),i(5,"my-delete-button",9),M("click",function(){let _=P(e).$implicit,d=p();return A(d.uninstall(_));}),o()()(),E();}if(n&2){let e=r.$implicit,t=p();a(),l("plugin",e)("version",e.version)("pluginType",t.pluginType),a(2),l("ngIf",!t.isTheme(e)),a(),l("ngIf",t.isUpdateAvailable(e)),a(),l("responsiveLabel",!0)("disabled",t.isUpdating(e)||t.isUninstalling(e));}}var Oo=class Oo{constructor(r,e,t,_,d,g){this.pluginService=r;this.pluginApiService=e;this.notifier=t;this.confirmService=_;this.router=d;this.route=g;c(this,"pluginType");c(this,"pagination",{currentPage:1,itemsPerPage:10,totalItems:null});c(this,"sort","name");c(this,"plugins",[]);c(this,"updating",{});c(this,"uninstalling",{});c(this,"onDataSubject",new Jo());}ngOnInit(){if(!this.route.snapshot.queryParams.pluginType){let r={pluginType:Qt.PLUGIN};this.router.navigate([],{queryParams:r,replaceUrl:!0});}this.route.queryParams.subscribe(r=>{r.pluginType&&(this.pluginType=parseInt(r.pluginType,10),this.reloadPlugins());});}reloadPlugins(){this.pagination.currentPage=1,this.plugins=[],this.loadMorePlugins();}loadMorePlugins(){this.pluginApiService.getPlugins(this.pluginType,this.pagination,this.sort).subscribe({next:r=>{this.plugins=this.plugins.concat(r.data),this.pagination.totalItems=r.total,this.onDataSubject.next(r.data);},error:r=>this.notifier.error(r.message)});}onNearOfBottom(){ui(this.pagination)&&(this.pagination.currentPage+=1,this.loadMorePlugins());}getNoResultMessage(){return this.pluginType===Qt.PLUGIN?"\u60A8\u5C1A\u672A\u5B89\u88DD\u5916\u639B\u7A0B\u5F0F\u3002":"\u60A8\u5C1A\u672A\u5B89\u88DD\u4F48\u666F\u4E3B\u984C\u3002";}isUpdateAvailable(r){return r.latestVersion&&i_(r.latestVersion,r.version)>0;}getUpdateLabel(r){return"\u66F4\u65B0\u5230 \n          "+r.latestVersion+"\n        ";}isUpdating(r){return!!this.updating[this.getPluginKey(r)];}isUninstalling(r){return!!this.uninstalling[this.getPluginKey(r)];}isTheme(r){return r.type===Qt.THEME;}uninstall(r){return pe(this,null,function*(){let e=this.getPluginKey(r);this.uninstalling[e]||(yield this.confirmService.confirm("\u60A8\u60F3\u8981\u89E3\u9664\u5B89\u88DD "+r.name+" \u55CE\uFF1F","\u89E3\u9664\u5B89\u88DD"))===!1||(this.uninstalling[e]=!0,this.pluginApiService.uninstall(r.name,r.type).subscribe({next:()=>{this.notifier.success("\n          "+r.name+" \u5DF2\u89E3\u9664\u5B89\u88DD\u3002\n        "),this.plugins=this.plugins.filter(_=>_.name!==r.name),this.pagination.totalItems--,this.uninstalling[e]=!1;},error:_=>{this.notifier.error(_.message),this.uninstalling[e]=!1;}}));});}update(r){return pe(this,null,function*(){let e=this.getPluginKey(r);this.updating[e]||this.isMajorUpgrade(r)&&(yield this.confirmService.confirm("\u9019\u662F\u4E3B\u8981\u7684\u5916\u639B\u7A0B\u5F0F\u5347\u7D1A\u3002\u8ACB\u5230\u5916\u639B\u7A0B\u5F0F\u7684\u9996\u9801\u6AA2\u67E5\u6F5B\u5728\u7684\u767C\u884C\u8AAA\u660E\u3002","\u5347\u7D1A","\u7E7C\u7E8C\u5347\u7D1A"))===!1||(this.updating[e]=!0,this.pluginApiService.update(r.name,r.type).pipe().subscribe({next:t=>{this.updating[e]=!1,this.notifier.success("\n          "+r.name+" \u5DF2\u66F4\u65B0\u3002\n        "),Object.assign(r,t);},error:t=>{this.notifier.error(t.message),this.updating[e]=!1;}}));});}getShowRouterLink(r){return["/admin","plugins","show",this.pluginService.nameToNpmName(r.name,r.type)];}getPluginOrThemeHref(r){return this.pluginApiService.getPluginOrThemeHref(this.pluginType,r);}getPluginKey(r){return r.name+r.type;}isMajorUpgrade(r){if(!r.latestVersion)return!1;let e=parseInt(r.latestVersion.split(".")[0]),t=parseInt(r.version.split(".")[0]);return e>t;}};c(Oo,"\u0275fac",function(e){return new(e||Oo)(T(On),T(Vt),T(K),T(xe),T(Ze),T(Qe));}),c(Oo,"\u0275cmp",h({type:Oo,selectors:[["my-plugin-list-installed"]],standalone:!0,features:[v],decls:4,vars:4,consts:()=>{let r;r="\u8A2D\u5B9A";let e;return e="\u89E3\u9664\u5B89\u88DD",[[3,"pluginType"],["class","no-results",4,"ngIf"],["myInfiniteScroller","",1,"plugins",3,"nearOfBottom","dataObservable"],[4,"ngFor","ngForOf"],[1,"no-results"],[3,"plugin","version","pluginType"],["ngProjectAs","buttons",5,["buttons"]],["label",r,3,"ptRouterLink","responsiveLabel",4,"ngIf"],["class","update-button","icon","refresh",3,"loading","label","responsiveLabel","click",4,"ngIf"],["label",e,3,"click","responsiveLabel","disabled"],["label",r,3,"ptRouterLink","responsiveLabel"],["icon","refresh",1,"update-button",3,"click","loading","label","responsiveLabel"]];},template:function(e,t){e&1&&(m(0,"my-plugin-navigation",0),u(1,Nd,2,1,"div",1),i(2,"div",2),M("nearOfBottom",function(){return t.onNearOfBottom();}),u(3,Pd,6,7,"ng-container",3),o()),e&2&&(l("pluginType",t.pluginType),a(),l("ngIf",t.pagination.totalItems===0),a(),l("dataObservable",t.onDataSubject.asObservable()),a(),l("ngForOf",t.plugins));},dependencies:[Io,B,Mi,Ne,Eo,bi,dt,fn],styles:[".update-button[disabled=true][_ngcontent-%COMP%]     .action-button{cursor:default!important}my-edit-button[_ngcontent-%COMP%], my-button[_ngcontent-%COMP%]{margin-inline-end:.625rem}"]}));var Ki=Oo;function Ad(n,r){n&1&&(i(0,"div",17),s(1,0),o());}function Rd(n,r){n&1&&(S(0),s(1,1),E());}function bd(n,r){n&1&&(S(0),s(1,2),E());}function Fd(n,r){if(n&1&&(S(0),m(1,"my-global-icon",18),u(2,Rd,2,0,"ng-container",11)(3,bd,2,0,"ng-container",11),E()),n&2){let e=p();a(2),l("ngIf",!e.isThemeSearch()),a(),l("ngIf",e.isThemeSearch());}}function hd(n,r){if(n&1&&(S(0),m(1,"my-global-icon",19),S(2),s(3,3),E()()),n&2){let e=p();a(3),W(e.pagination.totalItems)(e.pagination.totalItems)(e.search),j(3);}}function vd(n,r){n&1&&(i(0,"div",20),s(1,4),o());}function Dd(n,r){n&1&&(i(0,"span",29),s(1,5),o());}function yd(n,r){n&1&&(i(0,"span",30),s(1,6),o());}function Ld(n,r){n&1&&(i(0,"span",31),s(1,7),o());}function $d(n,r){if(n&1&&m(0,"my-edit-button",32),n&2){let e=p().$implicit,t=p();l("ptRouterLink",t.getShowRouterLink(e))("responsiveLabel",!0);}}function xd(n,r){if(n&1){let e=k();i(0,"my-button",33),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.install(_));}),o();}if(n&2){let e=p().$implicit,t=p();l("loading",t.isInstalling(e))("responsiveLabel",!0),It("disabled",t.isInstalling(e));}}function Gd(n,r){if(n&1&&(S(0),i(1,"my-plugin-card",21)(2,"div",22),u(3,Dd,2,0,"span",23)(4,yd,2,0,"span",24)(5,Ld,2,0,"span",25),o(),i(6,"div",26),u(7,$d,1,2,"my-edit-button",27)(8,xd,1,3,"my-button",28),o()(),E()),n&2){let e=r.$implicit,t=p();a(),l("plugin",e)("version",e.latestVersion)("pluginType",t.pluginType),a(2),l("ngIf",e.installed),a(),l("ngIf",e.official),a(),l("ngIf",e.recommended),a(2),l("ngIf",e.installed===!0&&!t.isThemeSearch()),a(),l("ngIf",e.installed===!1);}}var No=class No{constructor(r,e,t,_,d,g){this.pluginService=r;this.pluginApiService=e;this.notifier=t;this.confirmService=_;this.router=d;this.route=g;c(this,"pluginType");c(this,"pagination",{currentPage:1,itemsPerPage:10,totalItems:null});c(this,"sort","-trending");c(this,"search","");c(this,"isSearching",!1);c(this,"plugins",[]);c(this,"installing",{});c(this,"pluginInstalled",!1);c(this,"onDataSubject",new Jo());c(this,"searchSubject",new Jo());}ngOnInit(){if(!this.route.snapshot.queryParams.pluginType){let r={pluginType:Qt.PLUGIN};this.router.navigate([],{queryParams:r});}this.route.queryParams.subscribe(r=>{r.pluginType&&(this.pluginType=parseInt(r.pluginType,10),this.search=r.search||"",this.reloadPlugins());}),this.searchSubject.asObservable().pipe(ya(400),La()).subscribe(r=>this.router.navigate([],{queryParams:{search:r},queryParamsHandling:"merge"}));}onSearchChange(r){let e=r.target;this.searchSubject.next(e.value);}reloadPlugins(){this.pagination.currentPage=1,this.plugins=[],this.loadMorePlugins();}loadMorePlugins(){this.isSearching=!0,this.pluginApiService.searchAvailablePlugins(this.pluginType,this.pagination,this.sort,this.search).subscribe({next:r=>{this.isSearching=!1,this.plugins=this.plugins.concat(r.data),this.pagination.totalItems=r.total,this.onDataSubject.next(r.data);},error:r=>{kn.error(r);let e="\u5916\u639B\u7A0B\u5F0F\u7D22\u5F15\u4E0D\u53EF\u7528\u3002\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002";this.notifier.error(e);}});}onNearOfBottom(){ui(this.pagination)&&(this.pagination.currentPage+=1,this.loadMorePlugins());}isInstalling(r){return!!this.installing[r.npmName];}getShowRouterLink(r){return["/admin","plugins","show",this.pluginService.nameToNpmName(r.name,this.pluginType)];}isThemeSearch(){return this.pluginType===Qt.THEME;}install(r){return pe(this,null,function*(){this.installing[r.npmName]||(yield this.confirmService.confirm("\u8ACB\u53EA\u5B89\u88DD\u60A8\u4FE1\u4EFB\u7684\u5916\u639B\u7A0B\u5F0F\u6216\u4F48\u666F\u4E3B\u984C\uFF0C\u56E0\u70BA\u5B83\u5011\u53EF\u80FD\u6703\u5728\u60A8\u7684\u7AD9\u81FA\u4E0A\u57F7\u884C\u4EFB\u4F55\u7A0B\u5F0F\u78BC\u3002","\u5B89\u88DD "+r.name+"\uFF1F"))===!1||(this.installing[r.npmName]=!0,this.pluginApiService.install(r.npmName).subscribe({next:()=>{this.installing[r.npmName]=!1,this.pluginInstalled=!0,this.notifier.success("\n          "+r.name+" \u5DF2\u5B89\u88DD\u3002\n        "),r.installed=!0;},error:t=>{this.installing[r.npmName]=!1,this.notifier.error(t.message);}}));});}};c(No,"\u0275fac",function(e){return new(e||No)(T(On),T(Vt),T(K),T(xe),T(Ze),T(Qe));}),c(No,"\u0275cmp",h({type:No,selectors:[["my-plugin-search"]],standalone:!0,features:[v],decls:10,vars:7,consts:()=>{let r;r="\u641C\u5C0B\u2026\u2026";let e;e="\n  \u8981\u8F09\u5165\u60A8\u65B0\u7684\u5DF2\u5B89\u88DD\u5916\u639B\u7A0B\u5F0F\u6216\u4F48\u666F\u4E3B\u984C\uFF0C\u8ACB\u91CD\u65B0\u6574\u7406\u9801\u9762\u3002\n";let t;t="\u6D41\u884C\u7684\u5916\u639B\u7A0B\u5F0F";let _;_="\u6D41\u884C\u7684\u4F48\u666F\u4E3B\u984C";let d;d="{VAR_PLURAL, plural, =1 {result} other {results}}",d=Ce(d,{VAR_PLURAL:"\uFFFD1\uFFFD"});let g;g=""+"\uFFFD0\uFFFD"+" "+d+" \u9069\u7528\u65BC \u201C"+"\uFFFD2\uFFFD"+"\u201D ";let O;O="\n  \u6C92\u6709\u7D50\u679C\u3002\n";let R;R="\u6B64\u5916\u639B\u7A0B\u5F0F\u7531 Framasoft \u958B\u767C\uFF0C\u5176\u70BA\u958B\u767C PeerTube \u7684\u975E\u71DF\u5229\u7D44\u7E54";let N;N="\u6B64\u5916\u639B\u7A0B\u5F0F\u7531 Framasoft \u63A8\u85A6\uFF0C\u5176\u70BA\u958B\u767C PeerTube \u7684\u975E\u71DF\u5229\u7D44\u7E54";let b;b="\u8A2D\u5B9A";let G;G="\u5DF2\u5B89\u88DD";let F;F="\u5B98\u65B9";let L;return L="\u63A8\u85A6",[e,t,_,g,O,G,F,L,[3,"pluginType"],["class","alert pt-alert-primary",4,"ngIf"],[1,"result-and-search"],[4,"ngIf"],[1,"search-bar"],["type","text","placeholder",r,"myAutofocus","",3,"input"],["class","no-results",4,"ngIf"],["myInfiniteScroller","",1,"plugins",3,"nearOfBottom","dataObservable"],[4,"ngFor","ngForOf"],[1,"alert","pt-alert-primary"],["iconName","trending","aria-hidden","true"],["iconName","search"],[1,"no-results"],[3,"plugin","version","pluginType"],["ngProjectAs","badges",5,["badges"]],["class","pt-badge badge-success",4,"ngIf"],["class","pt-badge badge-primary","title",R,4,"ngIf"],["class","pt-badge badge-primary","title",N,4,"ngIf"],["ngProjectAs","buttons",5,["buttons"]],["label",b,3,"ptRouterLink","responsiveLabel",4,"ngIf"],["label","Install","icon","cloud-download",3,"loading","responsiveLabel","click",4,"ngIf"],[1,"pt-badge","badge-success"],["title",R,1,"pt-badge","badge-primary"],["title",N,1,"pt-badge","badge-primary"],["label",b,3,"ptRouterLink","responsiveLabel"],["label","Install","icon","cloud-download",3,"click","loading","responsiveLabel"]];},template:function(e,t){e&1&&(m(0,"my-plugin-navigation",8),u(1,Ad,2,0,"div",9),i(2,"div",10),u(3,Fd,4,2,"ng-container",11)(4,hd,4,3,"ng-container",11),i(5,"div",12)(6,"input",13),M("input",function(d){return t.onSearchChange(d);}),o()()(),u(7,vd,2,0,"div",14),i(8,"div",15),M("nearOfBottom",function(){return t.onNearOfBottom();}),u(9,Gd,9,8,"ng-container",16),o()),e&2&&(l("pluginType",t.pluginType),a(),l("ngIf",t.pluginInstalled),a(2),l("ngIf",!t.search),a(),l("ngIf",t.search&&!t.isSearching),a(3),l("ngIf",t.pagination.totalItems===0),a(),l("dataObservable",t.onDataSubject.asObservable()),a(),l("ngForOf",t.plugins));},dependencies:[Io,B,de,K_,Mi,Ne,Eo,bi,dt],styles:[".result-and-search[_ngcontent-%COMP%]{font-size:22px;font-weight:600;margin:30px 0 15px;display:flex}.result-and-search[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{margin-inline-end:.3125rem}.search-bar[_ngcontent-%COMP%]{margin-inline-start:auto}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:500px;max-width:500px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}.search-bar[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 540px){.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}}.pt-badge[_ngcontent-%COMP%]{font-size:13px;margin-inline-start:.9375rem}.alert[_ngcontent-%COMP%]{margin-top:15px}"]}));var Yi=No;function Ud(n,r){if(n&1&&(i(0,"div",7),m(1,"my-dynamic-form-field",8),o()),n&2){let e=r.$implicit,t=p(3);l("id",t.getWrapperId(e)),a(),l("hidden",t.isSettingHidden(e))("form",t.form)("setting",e)("formErrors",t.formErrors);}}function wd(n,r){if(n&1){let e=k();i(0,"form",4),M("ngSubmit",function(){P(e);let _=p(2);return A(_.formValidated());}),u(1,Ud,2,5,"div",5),m(2,"input",6),o();}if(n&2){let e=p(2);l("formGroup",e.form),a(),l("ngForOf",e.registeredSettings),a(),l("disabled",!e.form.valid);}}function Vd(n,r){if(n&1&&(i(0,"div",9),s(1,0),o()),n&2){let e=p(2);a(),W(e.pluginTypeLabel),j(1);}}function kd(n,r){if(n&1&&(S(0),i(1,"h2"),S(2),C(3),E(),C(4),o(),u(5,wd,3,3,"form",2)(6,Vd,2,1,"div",3),E()),n&2){let e=p();a(3),I(e.pluginTypeLabel),a(),w(" ",e.plugin.name," "),a(),l("ngIf",e.hasRegisteredSettings()),a(),l("ngIf",!e.hasRegisteredSettings());}}var Mo=class Mo extends yt{constructor(e,t,_,d,g,O){super();this.formReactiveService=e;this.pluginService=t;this.pluginAPIService=_;this.notifier=d;this.hooks=g;this.route=O;c(this,"plugin");c(this,"registeredSettings",[]);c(this,"pluginTypeLabel");c(this,"sub");c(this,"npmName");}ngOnInit(){this.sub=this.route.params.subscribe(e=>{this.npmName=e.npmName,this.loadPlugin(this.npmName);});}ngOnDestroy(){this.sub&&this.sub.unsubscribe();}formValidated(){let e=this.form.value;this.pluginAPIService.updatePluginSettings(this.plugin.name,this.plugin.type,e).subscribe({next:()=>{this.notifier.success("\u8A2D\u5B9A\u5DF2\u66F4\u65B0\u3002");},error:t=>this.notifier.error(t.message)});}hasRegisteredSettings(){return Array.isArray(this.registeredSettings)&&this.registeredSettings.length!==0;}isSettingHidden(e){let t=this.pluginService.getRegisteredSettingsScript(this.npmName);return t!=null&&t.isSettingHidden?t.isSettingHidden({setting:e,formValues:this.form.value}):!1;}getWrapperId(e){if(e.name)return e.name+"-wrapper";}loadPlugin(e){this.pluginAPIService.getPlugin(e).pipe(wn(t=>this.pluginAPIService.getPluginRegisteredSettings(t.name,t.type).pipe(Xt(_=>({plugin:t,registeredSettings:_.registeredSettings}))))).subscribe({next:d=>pe(this,[d],function*({plugin:t,registeredSettings:_}){this.plugin=t,this.registeredSettings=yield this.translateSettings(_),this.pluginTypeLabel=this.pluginAPIService.getPluginTypeLabel(this.plugin.type),this.buildSettingsForm();}),error:t=>this.notifier.error(t.message)});}buildSettingsForm(){let e={},t={};for(let _ of this.registeredSettings)e[_.name]=null,t[_.name]=this.getSetting(_.name);this.buildForm(e),this.form.patchValue(t),this.hooks.runAction("action:admin-plugin-settings.init","admin-plugin",{npmName:this.npmName});}getSetting(e){let t=this.plugin.settings;return(t==null?void 0:t[e])!==void 0?t[e]:this.registeredSettings.find(d=>d.name===e).default;}translateSettings(e){return pe(this,null,function*(){for(let t of e)yield this.pluginService.translateSetting(this.npmName,t);return e;});}};c(Mo,"\u0275fac",function(t){return new(t||Mo)(T(Nt),T(On),T(Vt),T(K),T(f_),T(Qe));}),c(Mo,"\u0275cmp",h({type:Mo,selectors:[["my-plugin-show-installed"]],standalone:!0,features:[ne,v],decls:1,vars:1,consts:()=>{let e;return e="\u6B64 "+"\uFFFD0\uFFFD"+" \u6C92\u6709\u8A2D\u5B9A\u3002 ",[e,[4,"ngIf"],["role","form",3,"formGroup","ngSubmit",4,"ngIf"],["class","no-settings",4,"ngIf"],["role","form",3,"ngSubmit","formGroup"],["class","form-group",3,"id",4,"ngFor","ngForOf"],["type","submit","value","Update plugin settings",3,"disabled"],[1,"form-group",3,"id"],[3,"hidden","form","setting","formErrors"],[1,"no-settings"]];},template:function(t,_){t&1&&u(0,kd,7,4,"ng-container",1),t&2&&l("ngIf",_.plugin);},dependencies:[B,ce,Ot,Me,Pe,fe,Ne,Y_],styles:["h2[_ngcontent-%COMP%]{margin-bottom:20px}input[type=submit][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{margin-top:10px;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible, button[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%], button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%], button[disabled][_ngcontent-%COMP%], button.disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc, button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}"]}));var qi=Mo;var Fl=[{path:"plugins",canActivate:[De],data:{userRight:Q.MANAGE_PLUGINS},children:[{path:"",redirectTo:"list-installed",pathMatch:"full"},{path:"list-installed",component:Ki,data:{meta:{title:"\u5217\u51FA\u5DF2\u5B89\u88DD\u7684\u5916\u639B\u7A0B\u5F0F"}}},{path:"search",component:Yi,data:{meta:{title:"\u641C\u5C0B\u5916\u639B\u7A0B\u5F0F"}}},{path:"show/:npmName",component:qi,data:{meta:{title:"\u986F\u793A\u5916\u639B\u7A0B\u5F0F"}}}]}];var sn=class sn{constructor(r,e){this.authHttp=r;this.restExtractor=e;}getDebug(){return this.authHttp.get(sn.BASE_DEBUG_URL).pipe(ge(r=>this.restExtractor.handleError(r)));}};c(sn,"BASE_DEBUG_URL",_t.apiUrl+"/api/v1/server/debug"),c(sn,"\u0275fac",function(e){return new(e||sn)(Ee(lt),Ee(ct));}),c(sn,"\u0275prov",qe({token:sn,factory:sn.ɵfac}));var fo=sn;var Po=class Po{constructor(r,e){this.debugService=r;this.notifier=e;c(this,"debug");}ngOnInit(){this.load();}load(){this.debugService.getDebug().subscribe({next:r=>this.debug=r,error:r=>this.notifier.error(r.message)});}};c(Po,"\u0275fac",function(e){return new(e||Po)(T(fo),T(K));}),c(Po,"\u0275cmp",h({type:Po,selectors:[["ng-component"]],standalone:!0,features:[v],decls:22,vars:1,consts:()=>{let r;r="IP \u4F4D\u7F6E";let e;e="PeerTube \u8A8D\u70BA\u60A8\u7684\u7DB2\u8DEF\u700F\u89BD\u5668\u7684\u516C\u958B IP \u70BA "+"\uFFFD#5\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#5\uFFFD"+"\u3002";let t;t="\u5982\u679C\u9019\u4E0D\u662F\u60A8\u6B63\u78BA\u7684\u516C\u958B IP\uFF0C\u8ACB\u8003\u616E\u4FEE\u5FA9\uFF0C\u56E0\u70BA\uFF1A";let _;_="\u89C0\u770B\u6B21\u6578\u4E0D\u6B63\u78BA\uFF08\u6BD4\u61C9\u6709\u7684\u6B21\u6578\u5C11\uFF09";let d;d="\u53CD\u66B4\u529B\u7834\u89E3\u7CFB\u7D71\u53EF\u80FD\u6709\u9EDE\u904E\u982D\u4E86";let g;g="P2P \u7CFB\u7D71\u7121\u6CD5\u6B63\u78BA\u904B\u4F5C";let O;O="\u8981\u4FEE\u5FA9\u7684\u8A71\uFF1A";let R;return R="\u6AA2\u67E5 "+"\uFFFD#21\uFFFD"+"trust_proxy"+"\uFFFD/#21\uFFFD"+" \u8A2D\u5B9A\u9375",[r,e,t,_,d,g,O,R,[1,"root"]];},template:function(e,t){e&1&&(i(0,"div",8)(1,"h4"),s(2,0),o(),i(3,"p"),D(4,1),m(5,"strong"),y(),o(),i(6,"p"),s(7,2),o(),i(8,"ul")(9,"li"),s(10,3),o(),i(11,"li"),s(12,4),o(),i(13,"li"),s(14,5),o()(),i(15,"p"),s(16,6),o(),m(17,"p"),i(18,"ul")(19,"li"),D(20,7),m(21,"code"),y(),o()()()),e&2&&(a(5),W(t.debug==null?null:t.debug.ip),j(4));},styles:["code[_ngcontent-%COMP%]{font-size:14px;font-weight:600}"]}));var Qi=Po;var cn=class cn{constructor(r,e,t){this.authHttp=r;this.restService=e;this.restExtractor=t;}listJobs(r){let{jobState:e,jobType:t,pagination:_,sort:d}=r,g=new Et();return g=this.restService.addRestGetParams(g,_,d),t!=="all"&&(g=g.append("jobType",t)),this.authHttp.get(cn.BASE_JOB_URL+`/${e||""}`,{params:g}).pipe(Xt(O=>this.restExtractor.convertResultListDateToHuman(O,["createdAt","processedOn","finishedOn"],"precise")),Xt(O=>this.restExtractor.applyToResultListData(O,this.prettyPrintData.bind(this))),Xt(O=>this.restExtractor.applyToResultListData(O,this.buildUniqId.bind(this))),ge(O=>this.restExtractor.handleError(O)));}prettyPrintData(r){let e=JSON.stringify(r.data,null,2);return Object.assign(r,{data:e});}buildUniqId(r){return Object.assign(r,{uniqId:`${r.id}-${r.type}`});}};c(cn,"BASE_JOB_URL",_t.apiUrl+"/api/v1/jobs"),c(cn,"\u0275fac",function(e){return new(e||cn)(Ee(lt),Ee(vt),Ee(ct));}),c(cn,"\u0275prov",qe({token:cn,factory:cn.ɵfac}));var Ao=cn;var Wd=()=>({"table-layout":"auto"}),jd=(n,r,e,t)=>[n,r,e,t];function Hd(n,r){if(n&1&&(i(0,"ng-option",30),C(1),o()),n&2){let e=r.$implicit;l("value",e),a(),I(e);}}function Jd(n,r){if(n&1&&(i(0,"ng-option",30)(1,"span",31),C(2),o()()),n&2){let e=r.$implicit,t=p();l("value",e),a(),l("ngClass",t.getJobStateClass(e)),a(),I(e);}}function Kd(n,r){n&1&&(i(0,"th",42),s(1,9),o());}function Yd(n,r){n&1&&(i(0,"th",43),s(1,10),o());}function qd(n,r){if(n&1&&(i(0,"tr")(1,"th",32)(2,"span",33),s(3,3),o()(),i(4,"th",34),s(5,4),o(),i(6,"th",35),s(7,5),o(),i(8,"th",36),D(9,6),m(10,"small"),y(),o(),u(11,Kd,2,0,"th",37)(12,Yd,2,0,"th",38),i(13,"th",39),D(14,7),m(15,"p-sortIcon",40),y(),o(),i(16,"th",41),s(17,8),o()()),n&2){let e=p();a(11),l("ngIf",e.jobState==="all"),a(),l("ngIf",e.hasGlobalProgress()),a(),l("ngbTooltip",e.sortTooltip);}}function Qd(n,r){if(n&1&&(i(0,"td",54)(1,"span",48),C(2),o()()),n&2){let e=p().$implicit,t=p();l("pRowToggler",e),a(),l("ngClass",t.getJobStateClass(e.state)),a(),I(e.state);}}function Zd(n,r){if(n&1&&(S(0),C(1),E()),n&2){let e=p(2).$implicit,t=p();a(),I(t.getProgress(e));}}function ep(n,r){if(n&1&&(i(0,"td",55),u(1,Zd,2,1,"ng-container",56),o()),n&2){let e=p().$implicit,t=p();l("pRowToggler",e),a(),l("ngIf",t.hasProgress(e));}}function tp(n,r){if(n&1&&(i(0,"tr")(1,"td",44),m(2,"my-table-expander-icon",45),o(),i(3,"td",46),C(4),o(),i(5,"td",47)(6,"span",48),C(7),o()(),i(8,"td",49),C(9),o(),u(10,Qd,3,3,"td",50)(11,ep,2,2,"td",51),i(12,"td",52),C(13),o(),i(14,"td",53)(15,"div"),C(16),o(),i(17,"div"),C(18),o()()()),n&2){let e=r.expanded,t=r.$implicit,_=p();a(2),l("pRowToggler",t)("expanded",e),a(),l("pRowToggler",t)("title",t.id),a(),I(t.id),a(),l("pRowToggler",t),a(),l("ngClass",_.getRandomJobTypeBadge(t.type)),a(),I(t.type),a(),l("pRowToggler",t),a(),I(t.priority),a(),l("ngIf",_.jobState==="all"),a(),l("ngIf",_.hasGlobalProgress()),a(),l("pRowToggler",t),a(),I(t.createdAt),a(3),I(t.processedOn),a(2),I(t.finishedOn);}}function np(n,r){if(n&1&&(i(0,"tr",58)(1,"td")(2,"pre"),C(3),o()()()),n&2){let e=p().$implicit,t=p();a(),It("colspan",t.getColspan()),a(2),I(e.error);}}function op(n,r){if(n&1&&(i(0,"tr")(1,"td")(2,"pre"),C(3),o()()(),i(4,"tr")(5,"td")(6,"pre"),C(7),o()()(),u(8,np,4,2,"tr",57)),n&2){let e=r.$implicit,t=p();a(),It("colspan",t.getColspan()),a(2),I(ja(5,jd,"Job: "+e.id,"Type: "+e.type,"Processed on "+(e.processedOn||"-"),"Finished on "+(e.finishedOn||"-")).join(`
`)),a(2),It("colspan",t.getColspan()),a(2),I(e.data),a(),l("ngIf",e.error);}}function ip(n,r){n&1&&(S(0),s(1,11),E());}function rp(n,r){if(n&1&&(S(0),D(1,12),m(2,"code"),y(),E()),n&2){let e=p(3);a(2),W(e.jobType),j(1);}}function ap(n,r){if(n&1&&(S(0),u(1,ip,2,0,"ng-container",56)(2,rp,3,1,"ng-container",56),E()),n&2){let e=p(2);a(),l("ngIf",e.jobType==="all"),a(),l("ngIf",e.jobType!=="all");}}function _p(n,r){if(n&1&&(S(0),D(1,13),m(2,"span",31),y(),E()),n&2){let e=p(3);a(2),l("ngClass",e.getJobStateClass(e.jobState)),W(e.jobState),j(1);}}function lp(n,r){if(n&1&&(S(0),D(1,14),m(2,"code")(3,"span",31),y(),E()),n&2){let e=p(3);a(3),l("ngClass",e.getJobStateClass(e.jobState)),W(e.jobType)(e.jobState),j(1);}}function sp(n,r){if(n&1&&(S(0),u(1,_p,3,2,"ng-container",56)(2,lp,4,3,"ng-container",56),E()),n&2){let e=p(2);a(),l("ngIf",e.jobType==="all"),a(),l("ngIf",e.jobType!=="all");}}function cp(n,r){if(n&1&&(i(0,"tr")(1,"td")(2,"div",59)(3,"div",60),u(4,ap,3,2,"ng-container",56)(5,sp,3,2,"ng-container",56),o()()()()),n&2){let e=p();a(),It("colspan",e.getColspan()),a(3),l("ngIf",e.jobState==="all"),a(),l("ngIf",e.jobState!=="all");}}var kt=class kt extends ze{constructor(e,t){super();this.notifier=e;this.jobsService=t;c(this,"jobState");c(this,"jobStates",["active","completed","failed","waiting","delayed"]);c(this,"jobType","all");c(this,"jobTypes",["all","activitypub-cleaner","activitypub-follow","activitypub-http-broadcast-parallel","activitypub-http-broadcast","activitypub-http-fetcher","activitypub-http-unicast","activitypub-refresher","actor-keys","after-video-channel-import","create-user-export","email","federate-video","generate-video-storyboard","manage-video-torrent","move-to-file-system","move-to-object-storage","notify","transcoding-job-builder","video-channel-import","video-file-import","video-import","video-live-ending","video-redundancy","video-studio-edition","video-transcoding","video-transcription","videos-views-stats"]);c(this,"jobs",[]);c(this,"totalRecords");c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});}ngOnInit(){this.loadJobStateAndType(),this.initialize();}getIdentifier(){return"JobsComponent";}getJobStateClass(e){switch(e){case"active":return"badge-blue";case"completed":return"badge-green";case"delayed":return"badge-brown";case"failed":return"badge-red";case"waiting":return"badge-yellow";}}getColspan(){return this.jobState==="all"&&this.hasGlobalProgress()?7:this.jobState==="all"||this.hasGlobalProgress()?6:5;}onJobStateOrTypeChanged(){this.pagination.start=0,this.reloadData(),this.saveJobStateAndType();}hasGlobalProgress(){return this.jobType==="all"||this.jobType==="video-transcoding";}hasProgress(e){return e.type==="video-transcoding";}getProgress(e){return e.state==="active"?e.progress+"%":"";}refresh(){this.jobs=[],this.totalRecords=0,this.reloadData();}getRandomJobTypeBadge(e){return this.getRandomBadge("type",e);}reloadDataInternal(){let e=this.jobState;this.jobState==="all"&&(e=null),this.jobsService.listJobs({jobState:e,jobType:this.jobType,pagination:this.pagination,sort:this.sort}).subscribe({next:t=>{this.jobs=t.data,this.totalRecords=t.total;},error:t=>this.notifier.error(t.message)});}loadJobStateAndType(){let e=In.getItem(kt.LOCAL_STORAGE_STATE);e&&(this.jobState=r_(e));let t=In.getItem(kt.LOCAL_STORAGE_TYPE);t&&(this.jobType=t);}saveJobStateAndType(){In.setItem(kt.LOCAL_STORAGE_STATE,this.jobState),In.setItem(kt.LOCAL_STORAGE_TYPE,this.jobType);}};c(kt,"LOCAL_STORAGE_STATE","jobs-list-state"),c(kt,"LOCAL_STORAGE_TYPE","jobs-list-type"),c(kt,"\u0275fac",function(t){return new(t||kt)(T(K),T(Ao));}),c(kt,"\u0275cmp",h({type:kt,selectors:[["my-jobs"]],standalone:!0,features:[ne,v],decls:21,vars:23,consts:()=>{let e;e="\u91CD\u65B0\u6574\u7406";let t;t="\u5DE5\u4F5C\u985E\u578B";let _;_="\u5DE5\u4F5C\u72C0\u614B";let d;d="\u4E0D\u62D8";let g;g="\u66F4\u591A\u8CC7\u8A0A";let O;O="ID";let R;R="\u985E\u578B";let N;N="\u512A\u5148\u7A0B\u5EA6 "+"\uFFFD#10\uFFFD"+"\uFF081 = \u6700\u9AD8\u512A\u5148\u5EA6\uFF09"+"\uFFFD/#10\uFFFD"+"";let b;b="\u5EFA\u7ACB "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let G;G="\u5DF2\u8655\u7406/\u7D50\u675F";let F;F="\u72C0\u614B";let L;L="\u9032\u5EA6";let $;$="\u627E\u4E0D\u5230\u5DE5\u4F5C\u3002";let H;H="\u627E\u4E0D\u5230 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+" \u5DE5\u4F5C\u3002";let z;z="\u627E\u4E0D\u5230 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+" \u5DE5\u4F5C\u3002";let V;return V="\u627E\u4E0D\u5230 "+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+" \u5DE5\u4F5C\u70BA "+"\uFFFD#3\uFFFD"+""+"\uFFFD1\uFFFD"+""+"\uFFFD/#3\uFFFD"+".",[t,_,d,g,O,R,N,b,G,F,L,$,H,z,V,[1,"admin-sub-header"],[1,"select-filter-block"],["for","jobType"],["labelForId","jobType",1,"select-job-type",3,"ngModelChange","ngModel","searchable","clearable"],[3,"value",4,"ngFor","ngForOf"],["for","jobState"],["labelForId","jobState",1,"select-job-state",3,"ngModelChange","ngModel","clearable","searchable"],["value","all"],[1,"button-filter-block"],["label",e,"icon","refresh",3,"click"],["dataKey","uniqId",3,"onLazyLoad","value","lazy","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","tableStyle","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],[3,"value"],[1,"pt-badge",3,"ngClass"],["scope","col",2,"width","40px"],[1,"visually-hidden"],["scope","col",1,"job-id"],["scope","col",1,"job-type",2,"width","200px"],["scope","col",1,"job-priority",2,"width","200px"],["scope","col","style","width: 200px","class","job-state",4,"ngIf"],["scope","col","style","width: 100px","class","job-progress",4,"ngIf"],["scope","col","container","body","pSortableColumn","createdAt",1,"job-date",2,"width","200px",3,"ngbTooltip"],["field","createdAt"],["scope","col",2,"width","230px"],["scope","col",1,"job-state",2,"width","200px"],["scope","col",1,"job-progress",2,"width","100px"],[1,"expand-cell"],[3,"pRowToggler","expanded"],[1,"job-id","c-hand",3,"pRowToggler","title"],[1,"job-type","c-hand",3,"pRowToggler"],[1,"pt-badge","ellipsis",3,"ngClass"],[1,"job-priority","c-hand",3,"pRowToggler"],["class","job-state c-hand",3,"pRowToggler",4,"ngIf"],["class","job-progress c-hand",3,"pRowToggler",4,"ngIf"],[1,"job-date","c-hand",3,"pRowToggler"],[1,"fs-7"],[1,"job-state","c-hand",3,"pRowToggler"],[1,"job-progress","c-hand",3,"pRowToggler"],[4,"ngIf"],["class","job-error",4,"ngIf"],[1,"job-error"],[1,"no-results"],[1,"d-block"]];},template:function(t,_){t&1&&(i(0,"div",15)(1,"div",16)(2,"label",17),s(3,0),o(),i(4,"ng-select",18),Oe("ngModelChange",function(g){return Ie(_.jobType,g)||(_.jobType=g),g;}),M("ngModelChange",function(){return _.onJobStateOrTypeChanged();}),u(5,Hd,2,2,"ng-option",19),o()(),i(6,"div",16)(7,"label",20),s(8,1),o(),i(9,"ng-select",21),Oe("ngModelChange",function(g){return Ie(_.jobState,g)||(_.jobState=g),g;}),M("ngModelChange",function(){return _.onJobStateOrTypeChanged();}),i(10,"ng-option",22)(11,"span"),s(12,2),o()(),u(13,Jd,3,3,"ng-option",19),o()(),i(14,"div",23)(15,"my-button",24),M("click",function(){return _.refresh();}),o()()(),i(16,"p-table",25),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(17,qd,18,3,"ng-template",26)(18,tp,19,16,"ng-template",27)(19,op,9,10,"ng-template",28)(20,cp,6,3,"ng-template",29),o()),t&2&&(a(4),Te("ngModel",_.jobType),l("searchable",!0)("clearable",!1),a(),l("ngForOf",_.jobTypes),a(4),Te("ngModel",_.jobState),l("clearable",!1)("searchable",!1),a(4),l("ngForOf",_.jobStates),a(3),l("value",_.jobs)("lazy",!0)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("first",_.pagination.start)("tableStyle",Pt(22,Wd))("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows));},dependencies:[ce,Se,At,Ne,Oi,Ii,Ti,le,dt,ve,be,Ae,Fe,ft,he,Re,B,$e,Mt],styles:['.select-job-state[_ngcontent-%COMP%]{min-width:120px}.select-job-type[_ngcontent-%COMP%]{min-width:240px}@media screen and (min-height: 500px){.select-job-type[_ngcontent-%COMP%]     .ng-dropdown-panel .ng-dropdown-panel-items{max-height:calc(90vh - 250px)}}@media screen and (min-width: 960px){.job-id[_ngcontent-%COMP%]{max-width:30vw!important}.job-type[_ngcontent-%COMP%], .job-state[_ngcontent-%COMP%], .job-priority[_ngcontent-%COMP%]{width:150px!important}.job-date[_ngcontent-%COMP%]{width:200px!important}}.admin-sub-header[_ngcontent-%COMP%]{flex-direction:row!important;justify-content:flex-end}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]:not(:last-child){margin-inline-end:.625rem}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:2px}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:auto;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: auto){.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:100%}}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}.admin-sub-header[_ngcontent-%COMP%]   .button-filter-block[_ngcontent-%COMP%]{align-self:flex-end}pre[_ngcontent-%COMP%]{font-size:11px}.job-error[_ngcontent-%COMP%]{color:red}']}));var Zi=kt;var er=class{constructor(r){c(this,"date");c(this,"localeDate");c(this,"level");c(this,"message");c(this,"meta");c(this,"by");c(this,"domain");c(this,"action");this.date=new Date(r.timestamp),this.localeDate=this.date.toLocaleString(),this.level=r.level,this.message=r.message;let e=pi(r,"timestamp","level","message","label");if(Object.keys(e).length!==0&&(this.meta=JSON.stringify(e,void 0,2)),r.level==="audit")try{let t=JSON.parse(r.message);this.by=t.user,this.domain=t.domain,this.action=t.action,this.meta=JSON.stringify(t,null,2),this.message="";}catch(t){kn.error("Cannot parse audit message.",t);}}};var Ht=class Ht{constructor(r,e,t){this.authHttp=r;this.restService=e;this.restExtractor=t;}getLogs(r){let{isAuditLog:e,startDate:t,endDate:_,tagsOneOf:d}=r,g=new Et();g=g.append("startDate",t),e||(g=g.append("level",r.level)),_&&(g=g.append("endDate",r.endDate)),d&&(g=this.restService.addArrayParams(g,"tagsOneOf",d));let O=e?Ht.BASE_AUDIT_LOG_URL:Ht.BASE_LOG_URL;return this.authHttp.get(O,{params:g}).pipe(Xt(R=>R.map(N=>new er(N))),ge(R=>this.restExtractor.handleError(R)));}};c(Ht,"BASE_LOG_URL",_t.apiUrl+"/api/v1/server/logs"),c(Ht,"BASE_AUDIT_LOG_URL",_t.apiUrl+"/api/v1/server/audit-logs"),c(Ht,"\u0275fac",function(e){return new(e||Ht)(Ee(lt),Ee(vt),Ee(ct));}),c(Ht,"\u0275prov",qe({token:Ht,factory:Ht.ɵfac}));var Ro=Ht;var pp=["logsElement"],mp=["logsContent"],up=(n,r)=>({error:n,warn:r});function gp(n,r){if(n&1&&(i(0,"option",18),C(1),o()),n&2){let e=r.$implicit;l("value",e.id),a(),I(e.label);}}function Cp(n,r){if(n&1&&(i(0,"ng-option",18),C(1),ie(2,"date"),i(3,"span"),s(4,2),o(),C(5,") "),o()),n&2){let e=r.$implicit;l("value",e.id),a(),_n(" ",e.label," (",_e(2,3,e.id,e.dateFormat)," - ");}}function Sp(n,r){if(n&1&&(i(0,"ng-option",18)(1,"span",19),C(2,"\u2B24"),o(),C(3),o()),n&2){let e=r.$implicit;l("value",e.id),a(),l("ngClass",e.id),a(2),w(" ",e.label," ");}}function Ep(n,r){if(n&1){let e=k();i(0,"ng-select",10),Oe("ngModelChange",function(_){P(e);let d=p();return Ie(d.level,_)||(d.level=_),A(_);}),M("ngModelChange",function(){P(e);let _=p();return A(_.refresh());}),u(1,Sp,4,3,"ng-option",9),o();}if(n&2){let e=p();Te("ngModel",e.level),l("clearable",!1)("searchable",!1),a(),l("ngForOf",e.levelChoices);}}function Tp(n,r){if(n&1){let e=k();i(0,"my-select-tags",20),Oe("ngModelChange",function(_){P(e);let d=p();return Ie(d.tagsOneOf,_)||(d.tagsOneOf=_),A(_);}),M("ngModelChange",function(){P(e);let _=p();return A(_.refresh());}),o();}if(n&2){let e=p();Te("ngModel",e.tagsOneOf);}}function Ip(n,r){n&1&&(i(0,"div"),s(1,3),o());}function Op(n,r){if(n&1&&m(0,"my-copy-button",21),n&2){p();let e=Cn(16);l("elementContent",e);}}function Np(n,r){n&1&&(i(0,"div"),s(1,4),o());}function Mp(n,r){if(n&1&&(i(0,"strong",27),s(1,5),o()),n&2){let e=p().$implicit;a(),W(e.by),j(1);}}function fp(n,r){if(n&1&&(i(0,"strong",28),C(1),o()),n&2){let e=p().$implicit;a(),_n("",e.domain," -> ",e.action,"");}}function Pp(n,r){if(n&1&&(i(0,"div",22)(1,"span",23),C(2),o(),i(3,"span",24),C(4),o(),u(5,Mp,2,1,"strong",25)(6,fp,2,2,"strong",26),C(7),i(8,"pre"),C(9),o()()),n&2){let e=r.$implicit;l("ngClass",Wa(7,up,e.level==="error",e.level==="warn")),a(2),I(e.level),a(2),w("[",e.localeDate,"]"),a(),l("ngIf",e.by),a(),l("ngIf",e.domain),a(),w(" ",e.message," "),a(2),I(e.meta);}}var dn=class dn{constructor(r,e,t){this.logsService=r;this.notifier=e;this.localStorage=t;c(this,"logsElement");c(this,"logsContent");c(this,"loading",!1);c(this,"rawLogs");c(this,"logs",[]);c(this,"timeChoices",[]);c(this,"levelChoices",[]);c(this,"logTypeChoices",[]);c(this,"startDate");c(this,"level");c(this,"logType");c(this,"tagsOneOf",[]);}ngOnInit(){this.buildTimeChoices(),this.buildLevelChoices(),this.buildLogTypeChoices(),this.loadPreviousChoices(),this.load();}refresh(){this.logs=[],this.localStorage.setItem(dn.LOCAL_STORAGE_LOG_TYPE_CHOICE_KEY,this.logType),this.load();}load(){this.loading=!0;let r=this.tagsOneOf.length!==0?this.tagsOneOf:void 0;this.logsService.getLogs({isAuditLog:this.isAuditLog(),level:this.level,startDate:this.startDate,tagsOneOf:r}).subscribe({next:e=>{this.logs=e,this.rawLogs=this.logs.map(t=>`${t.level} ${t.localeDate} ${t.message} ${t.meta}`).join(`
`),setTimeout(()=>{this.logsElement.nativeElement.scrollIntoView({block:"end",inline:"nearest"});});},error:e=>this.notifier.error(e.message),complete:()=>this.loading=!1});}isAuditLog(){return this.logType==="audit";}buildTimeChoices(){let r=new Date();r.setHours(r.getHours()-1);let e=new Date();e.setDate(e.getDate()-1);let t=new Date();t.setDate(t.getDate()-7),this.timeChoices=[{id:t.toISOString(),label:"\u4E0A\u9031",dateFormat:"shortDate"},{id:e.toISOString(),label:"\u6628\u5929",dateFormat:"short"},{id:r.toISOString(),label:"\u524D\u4E00\u500B\u5C0F\u6642",dateFormat:"mediumTime"}],this.startDate=r.toISOString();}buildLevelChoices(){this.levelChoices=[{id:"debug",label:"\u9664\u932F"},{id:"info",label:"\u8CC7\u8A0A"},{id:"warn",label:"\u8B66\u544A"},{id:"error",label:"\u932F\u8AA4"}],this.level="warn";}buildLogTypeChoices(){this.logTypeChoices=[{id:"standard",label:"\u6A19\u6E96\u65E5\u8A8C"},{id:"audit",label:"\u5BE9\u6838\u65E5\u8A8C"}];}loadPreviousChoices(){this.logType=this.localStorage.getItem(dn.LOCAL_STORAGE_LOG_TYPE_CHOICE_KEY),this.logType!=="standard"&&this.logType!=="audit"&&(this.logType="audit");}};c(dn,"LOCAL_STORAGE_LOG_TYPE_CHOICE_KEY","admin-logs-log-type-choice"),c(dn,"\u0275fac",function(e){return new(e||dn)(T(Ro),T(K),T(mi));}),c(dn,"\u0275cmp",h({type:dn,selectors:[["ng-component"]],viewQuery:function(e,t){if(e&1&&(gt(pp,7),gt(mp,7)),e&2){let _;Ct(_=St())&&(t.logsElement=_.first),Ct(_=St())&&(t.logsContent=_.first);}},standalone:!0,features:[v],decls:18,vars:12,consts:()=>{let r;r="\u6309\u6A19\u7C64\u904E\u6FFE\u7D00\u9304\u6A94";let e;e="\u91CD\u65B0\u6574\u7406";let t;t="\u5DF2\u8907\u88FD\u7D00\u9304\u6A94";let _;_="\u8907\u88FD\u7D00\u9304\u6A94";let d;d="\u73FE\u5728";let g;g="\u6B63\u5728\u8F09\u5165\u2026\u2026";let O;O="\u7121\u7D00\u9304\u6A94\u3002";let R;return R="\u7531 "+"\uFFFD0\uFFFD"+" ->",[["logsElement",""],["logsContent",""],d,g,O,R,[1,"header"],[1,"peertube-select-container"],[1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel","clearable","searchable"],[3,"ngModel","clearable","searchable","ngModelChange",4,"ngIf"],["placeholder",r,3,"ngModel","ngModelChange",4,"ngIf"],["label",e,"icon","refresh",3,"click"],[1,"logs"],[4,"ngIf"],["notification",t,"title",_,"withBorder","true",3,"elementContent",4,"ngIf"],["class","log-row",3,"ngClass",4,"ngFor","ngForOf"],[3,"value"],[1,"level-choice",3,"ngClass"],["placeholder",r,3,"ngModelChange","ngModel"],["notification",t,"title",_,"withBorder","true",3,"elementContent"],[1,"log-row",3,"ngClass"],[1,"log-level"],[1,"log-date"],["class","log-by",4,"ngIf"],["class","log-domain-action",4,"ngIf"],[1,"log-by"],[1,"log-domain-action"]];},template:function(e,t){if(e&1){let _=k();i(0,"div",6)(1,"div",7)(2,"select",8),Oe("ngModelChange",function(g){return P(_),Ie(t.logType,g)||(t.logType=g),A(g);}),M("ngModelChange",function(){return P(_),A(t.refresh());}),u(3,gp,2,2,"option",9),o()(),i(4,"ng-select",10),Oe("ngModelChange",function(g){return P(_),Ie(t.startDate,g)||(t.startDate=g),A(g);}),M("ngModelChange",function(){return P(_),A(t.refresh());}),u(5,Cp,6,6,"ng-option",9),o(),u(6,Ep,2,4,"ng-select",11)(7,Tp,1,1,"my-select-tags",12),i(8,"my-button",13),M("click",function(){return P(_),A(t.refresh());}),o()(),i(9,"div",14),u(10,Ip,2,0,"div",15),i(11,"div",null,0),u(13,Op,1,1,"my-copy-button",16)(14,Np,2,0,"div",15),i(15,"div",null,1),u(17,Pp,10,10,"div",17),o()()();}e&2&&(a(2),Te("ngModel",t.logType),a(),l("ngForOf",t.logTypeChoices),a(),Te("ngModel",t.startDate),l("clearable",!1)("searchable",!1),a(),l("ngForOf",t.timeChoices),a(),l("ngIf",!t.isAuditLog()),a(),l("ngIf",!t.isAuditLog()),a(3),l("ngIf",t.loading),a(3),l("ngIf",t.logs.length!==0),a(),l("ngIf",!t.loading&&t.logs.length===0),a(3),l("ngForOf",t.logs));},dependencies:[ce,Ft,ht,bt,Se,At,Ne,Oi,Ii,Ti,B,le,q_,dt,ye,Ci],styles:['.logs[_ngcontent-%COMP%]{font-family:monospace;font-size:13px;max-height:500px;overflow-y:auto;background:#00000008;padding:20px}.logs[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative}.logs[_ngcontent-%COMP%]   .log-row[_ngcontent-%COMP%]{margin-top:1px;word-break:break-word}.logs[_ngcontent-%COMP%]   .log-row[_ngcontent-%COMP%]:hover{background:#00000012}.logs[_ngcontent-%COMP%]   .log-level[_ngcontent-%COMP%]{font-weight:600;margin-inline-end:.3125rem}.logs[_ngcontent-%COMP%]   .log-by[_ngcontent-%COMP%]{margin:0 5px}.logs[_ngcontent-%COMP%]   .warn[_ngcontent-%COMP%]{color:var(--mainColor)}.logs[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red}.logs[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin-bottom:5px;white-space:pre-wrap;word-wrap:break-word}.header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:10px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:150px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.header[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.header[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 150px){.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:100%}}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}.header[_ngcontent-%COMP%]   my-select-tags[_ngcontent-%COMP%]{min-width:250px;max-width:400px}.header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-inline-start:.625rem}.level-choice[_ngcontent-%COMP%]{font-size:80%;vertical-align:text-top}.level-choice.debug[_ngcontent-%COMP%]{color:#c5c5c5}.level-choice.info[_ngcontent-%COMP%]{color:#88ccf7}.level-choice.warn[_ngcontent-%COMP%]{color:#fca607}.level-choice.error[_ngcontent-%COMP%]{color:#fa0505}my-copy-button[_ngcontent-%COMP%]{position:absolute;right:5px;background:var(--mainBackgroundHoverColor)}@media screen and (max-width: 1040px){.main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]{flex-direction:column}.main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%], .main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   ng-select[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   ng-select[_ngcontent-%COMP%], .main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%]{width:100%!important;margin-bottom:10px!important;margin-inline-start:0!important}.main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%]{text-align:center}}@media screen and (max-width: 800px){.main-col.expanded[_nghost-%COMP%]   .header[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]{flex-direction:column}.main-col.expanded[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%], .main-col.expanded[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   ng-select[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   ng-select[_ngcontent-%COMP%], .main-col.expanded[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%]{width:100%!important;margin-bottom:10px!important;margin-inline-start:0!important}.main-col.expanded[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%]{text-align:center}}']}));var tr=dn;var ut=class ut{constructor(r,e,t,_){this.authHttp=r;this.server=e;this.restService=t;this.restExtractor=_;}listRegistrationTokens(r){let{pagination:e,sort:t}=r,_=new Et();return _=this.restService.addRestGetParams(_,e,t),this.authHttp.get(ut.BASE_RUNNER_URL+"/registration-tokens",{params:_}).pipe(ge(d=>this.restExtractor.handleError(d)));}generateToken(){return this.authHttp.post(ut.BASE_RUNNER_URL+"/registration-tokens/generate",{}).pipe(ge(r=>this.restExtractor.handleError(r)));}removeToken(r){return this.authHttp.delete(ut.BASE_RUNNER_URL+"/registration-tokens/"+r.id).pipe(ge(e=>this.restExtractor.handleError(e)));}listRunnerJobs(r){let{pagination:e,sort:t,search:_}=r,d=new Et();return d=this.restService.addRestGetParams(d,e,t),_&&(d=this.buildParamsFromSearch(_,d)),Un([this.authHttp.get(ut.BASE_RUNNER_URL+"/jobs",{params:d}),this.server.getServerLocale()]).pipe(Xt(([g,O])=>{let R=g.data.map(N=>Yt(zt({},N),{state:{id:N.state.id,label:ti(N.state.label,O)},payload:JSON.stringify(N.payload,null,2),privatePayload:JSON.stringify(N.privatePayload,null,2)}));return{total:g.total,data:R};}),Xt(g=>this.restExtractor.convertResultListDateToHuman(g,["createdAt","startedAt","finishedAt"],"precise")),ge(g=>this.restExtractor.handleError(g)));}buildParamsFromSearch(r,e){let t=this.restService.parseQueryStringFilter(r,{stateOneOf:{prefix:"state:",multiple:!0,handler:_=>{if(_==="completed")return st.COMPLETED;if(_==="processing")return st.PROCESSING;if(_==="errored")return st.ERRORED;if(_==="pending")return st.PENDING;if(_==="waiting-for-parent-job")return st.WAITING_FOR_PARENT_JOB;if(_==="parent-errored")return st.PARENT_ERRORED;}}});return this.restService.addObjectParams(e,t);}cancelJobs(r){let e=ei(r);return Ko(e).pipe(qo(t=>this.authHttp.post(ut.BASE_RUNNER_URL+"/jobs/"+t.uuid+"/cancel",{})),Yo(),ge(t=>this.restExtractor.handleError(t)));}removeJobs(r){let e=ei(r);return Ko(e).pipe(qo(t=>this.authHttp.delete(ut.BASE_RUNNER_URL+"/jobs/"+t.uuid)),Yo(),ge(t=>this.restExtractor.handleError(t)));}listRunners(r){let{pagination:e,sort:t}=r,_=new Et();return _=this.restService.addRestGetParams(_,e,t),this.authHttp.get(ut.BASE_RUNNER_URL+"/",{params:_}).pipe(ge(d=>this.restExtractor.handleError(d)));}deleteRunner(r){return this.authHttp.delete(ut.BASE_RUNNER_URL+"/"+r.id).pipe(ge(e=>this.restExtractor.handleError(e)));}};c(ut,"BASE_RUNNER_URL",_t.apiUrl+"/api/v1/runners"),c(ut,"\u0275fac",function(e){return new(e||ut)(Ee(lt),Ee(Ge),Ee(vt),Ee(ct));}),c(ut,"\u0275prov",qe({token:ut,factory:ut.ɵfac}));var rn=ut;function Ap(n,r){if(n&1&&(i(0,"tr")(1,"th",26),m(2,"p-tableHeaderCheckbox",27),o(),i(3,"th",26)(4,"span",28),s(5,2),o()(),i(6,"th",29)(7,"span",28),s(8,3),o()(),i(9,"th",30),s(10,4),o(),i(11,"th",30),s(12,5),o(),i(13,"th",31),D(14,6),m(15,"p-sortIcon",32),y(),o(),i(16,"th",33),D(17,7),m(18,"p-sortIcon",34),y(),o(),i(19,"th",35),D(20,8),m(21,"p-sortIcon",36),y(),o(),i(22,"th",37),s(23,9),o(),i(24,"th",38),D(25,10),m(26,"p-sortIcon",39),y(),o(),i(27,"th",40),s(28,11),o()()),n&2){let e=p();a(13),l("ngbTooltip",e.sortTooltip),a(3),l("ngbTooltip",e.sortTooltip),a(3),l("ngbTooltip",e.sortTooltip),a(5),l("ngbTooltip",e.sortTooltip);}}function Rp(n,r){if(n&1&&m(0,"my-action-dropdown",47),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function bp(n,r){if(n&1){let e=k();i(0,"div",41)(1,"div",42),u(2,Rp,1,2,"my-action-dropdown",43),o(),i(3,"div",44)(4,"my-advanced-input-filter",45),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o(),i(5,"my-button",46),M("click",function(){P(e);let _=p();return A(_.reloadData());}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode()),a(2),l("filters",e.inputFilters);}}function Fp(n,r){if(n&1&&(S(0),C(1),E()),n&2){let e=p().$implicit;a(),w("",e.progress,"%");}}function hp(n,r){if(n&1&&(i(0,"div",59),C(1),o()),n&2){let e=p().$implicit,t=p();l("ngClass",t.getRandomRunnerNameBadge(e.runner.name)),a(),w(" ",e.runner.name," ");}}function vp(n,r){if(n&1&&(i(0,"tr",48)(1,"td",49),m(2,"p-tableCheckbox",50),o(),i(3,"td",51),m(4,"my-table-expander-icon",52),o(),i(5,"td",53),m(6,"my-action-dropdown",54),o(),i(7,"td"),C(8),o(),i(9,"td")(10,"span",55),C(11),o()(),i(12,"td")(13,"span",55),C(14),o()(),i(15,"td"),C(16),o(),i(17,"td"),u(18,Fp,2,1,"ng-container",56),o(),i(19,"td"),u(20,hp,2,2,"div",57),o(),i(21,"td"),C(22),o(),i(23,"td",58)(24,"div"),C(25),o(),i(26,"div"),C(27),o()()()),n&2){let e=r.expanded,t=r.$implicit,_=p();l("pSelectableRow",t),a(2),l("value",t),a(2),l("pRowToggler",t)("expanded",e),a(2),l("actions",_.actions)("entry",t),a(2),I(t.uuid),a(2),l("ngClass",_.getRandomRunnerTypeBadge(t.type)),a(),I(t.type),a(2),l("ngClass",_.getStateBadgeColor(t)),a(),I(t.state.label),a(2),I(t.priority),a(2),l("ngIf",t.progress),a(2),l("ngIf",t.runner==null?null:t.runner.name),a(2),I(t.createdAt),a(3),I(t.startedAt),a(2),I(t.finishedAt);}}function Dp(n,r){if(n&1&&(i(0,"pre",64),C(1),o()),n&2){let e=p().$implicit;a(),I(e.error);}}function yp(n,r){if(n&1&&(i(0,"tr")(1,"td",60)(2,"div",61),C(3),m(4,"br"),C(5),m(6,"br"),C(7),m(8,"br"),o(),i(9,"div",62)(10,"strong"),s(11,12),o(),i(12,"pre"),C(13),o()(),i(14,"div",62)(15,"strong"),s(16,13),o(),i(17,"pre"),C(18),o()(),u(19,Dp,2,1,"pre",63),o()()),n&2){let e=r.$implicit;a(3),w(" Parent job: ",(e.parent==null?null:e.parent.uuid)||"-"," "),a(2),w(" Processed on ",e.startedAt||"-"," "),a(2),w(" Finished on ",e.finishedAt||"-"," "),a(6),I(e.payload),a(5),I(e.privatePayload),a(),l("ngIf",e.error);}}function Lp(n,r){n&1&&(i(0,"tr")(1,"td",60)(2,"div",65),S(3),s(4,14),E(),o()()());}var bo=class bo extends ze{constructor(e,t,_){super();this.runnerService=e;this.notifier=t;this.confirmService=_;c(this,"runnerJobs",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"actions",[]);c(this,"bulkActions",[]);c(this,"inputFilters",[{title:"\u9032\u968E\u7BE9\u9078\u689D\u4EF6",children:[{value:"state:completed",label:"\u5DF2\u5B8C\u6210\u7684\u4F5C\u696D"},{value:"state:pending state:waiting-for-parent-job",label:"\u64F1\u7F6E\u4E2D\u7684\u4F5C\u696D"},{value:"state:processing",label:"\u6B63\u5728\u8655\u7406\u7684\u4F5C\u696D"},{value:"state:errored state:parent-errored",label:"\u5931\u6557\u7684\u4F5C\u696D"}]}]);}ngOnInit(){this.actions=[[{label:"\u53D6\u6D88\u6B64\u4F5C\u696D",handler:e=>this.cancelJobs([e]),isDisplayed:e=>this.canCancelJob(e)}],[{label:"\u522A\u9664\u6B64\u4F5C\u696D",handler:e=>this.removeJobs([e])}]],this.bulkActions=[[{label:"\u53D6\u6D88",handler:e=>this.cancelJobs(e),isDisplayed:e=>e.every(t=>this.canCancelJob(t))}],[{label:"\u522A\u9664",handler:e=>this.removeJobs(e)}]],this.initialize();}getIdentifier(){return"RunnerJobListComponent";}cancelJobs(e){return pe(this,null,function*(){let t=me("\u60A8\u771F\u7684\u60F3\u8981\u53D6\u6D88{count, plural, =1 {\u6B64\u5DE5\u4F5C} other {{count}\u500B\u5DE5\u4F5C}}\u55CE\uFF1F\u5B50\u5DE5\u4F5C\u4E5F\u5C07\u6703\u88AB\u53D6\u6D88\u3002",{count:e.length});(yield this.confirmService.confirm(t,"\u53D6\u6D88"))!==!1&&this.runnerService.cancelJobs(e).subscribe({next:()=>{this.reloadData(),this.notifier.success(me("{count, plural, =1 {\u500B\u5DE5\u4F5C\u5DF2\u53D6\u6D88} other {{count} \u500B\u5DE5\u4F5C\u5DF2\u53D6\u6D88}}",{count:e.length}));},error:d=>this.notifier.error(d.message)});});}removeJobs(e){return pe(this,null,function*(){let t=me("\u60A8\u771F\u7684\u60F3\u8981\u79FB\u9664 {count, plural, =1 {\u6B64\u4F5C\u696D} other {{count} \u500B\u4F5C\u696D}}\u55CE\uFF1F\u4E0B\u5C64\u4F5C\u696D\u4E5F\u6703\u88AB\u79FB\u9664\u3002",{count:e.length});(yield this.confirmService.confirm(t,"\u79FB\u9664"))!==!1&&this.runnerService.removeJobs(e).subscribe({next:()=>{this.reloadData(),this.notifier.success(me("{count, plural, =1 {\u500B\u5DE5\u4F5C\u5DF2\u79FB\u9664} other {{count} \u500B\u5DE5\u4F5C\u5DF2\u79FB\u9664}}",{count:e.length}));},error:d=>this.notifier.error(d.message)});});}getStateBadgeColor(e){switch(e.state.id){case st.ERRORED:case st.PARENT_ERRORED:return"badge-danger";case st.COMPLETED:return"badge-success";case st.PENDING:case st.WAITING_FOR_PARENT_JOB:return"badge-warning";default:return"badge-info";}}getRandomRunnerNameBadge(e){return this.getRandomBadge("runner",e);}getRandomRunnerTypeBadge(e){return this.getRandomBadge("type",e);}reloadDataInternal(){this.runnerService.listRunnerJobs({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>{this.runnerJobs=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}canCancelJob(e){return e.state.id===st.PENDING||e.state.id===st.PROCESSING||e.state.id===st.WAITING_FOR_PARENT_JOB;}};c(bo,"\u0275fac",function(t){return new(t||bo)(T(rn),T(K),T(xe));}),c(bo,"\u0275cmp",h({type:bo,selectors:[["my-runner-job-list"]],standalone:!0,features:[ne,v],decls:15,vars:14,consts:()=>{let e;e="\u57F7\u884C\u5668\u4F5C\u696D";let t;t="\u9060\u7AEF\u57F7\u884C\u5668";let _;_="\u9078\u53D6\u6240\u6709\u5217";let d;d="\u66F4\u591A\u8CC7\u8A0A";let g;g="\u52D5\u4F5C";let O;O="UUID";let R;R="\u985E\u578B";let N;N="\u9673\u8FF0 "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let b;b="\u512A\u5148\u7A0B\u5EA6 "+"\uFFFD#18\uFFFD"+""+"\uFFFD/#18\uFFFD"+"";let G;G="\u9032\u5EA6 "+"\uFFFD#21\uFFFD"+""+"\uFFFD/#21\uFFFD"+"";let F;F="\u57F7\u884C\u5668";let L;L="\u5EFA\u7ACB "+"\uFFFD#26\uFFFD"+""+"\uFFFD/#26\uFFFD"+"";let $;$="\u5DF2\u8655\u7406/\u7D50\u675F";let H;H="\u6279\u6B21\u52D5\u4F5C";let z;z="\u91CD\u65B0\u6574\u7406";let V;V="\u9078\u53D6\u6B64\u5217";let x;x="\u52D5\u4F5C";let Y;Y="\u916C\u8F09\uFF1A";let oe;oe="\u79C1\u4EBA\u916C\u8F09\uFF1A";let we;return we="\u627E\u4E0D\u5230\u57F7\u884C\u5668\u4F5C\u696D\u3002",[e,t,d,g,O,R,N,b,G,F,L,$,Y,oe,we,[1,"d-flex","justify-content-between"],[1,"text-nowrap","me-2"],["iconName","globe","aria-hidden","true"],["routerLink","/admin/system/runners/runners-list",1,"peertube-button-link","peertube-button-icon","grey-button"],["iconName","codesandbox","aria-hidden","true"],["dataKey","uuid",3,"onLazyLoad","selectionChange","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","lazyLoadOnInit","selection","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","header"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["scope","col",2,"width","40px"],["ariaLabel",_],[1,"visually-hidden"],["scope","col",2,"width","120px"],["scope","col"],["scope","col","container","body","pSortableColumn","state",2,"width","150px",3,"ngbTooltip"],["field","state"],["scope","col","container","body","pSortableColumn","priority",2,"width","100px",3,"ngbTooltip"],["field","priority"],["scope","col","container","body","pSortableColumn","progress",2,"width","100px",3,"ngbTooltip"],["field","progress"],["scope","col",2,"width","100px"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","200px",3,"ngbTooltip"],["field","createdAt"],["scope","col",2,"width","230px"],[1,"caption"],[1,"left-buttons"],["label",H,"theme","orange",3,"actions","entry",4,"ngIf"],[1,"ms-auto","d-flex"],[1,"me-2",3,"search","filters"],["label",z,"icon","refresh",3,"click"],["label",H,"theme","orange",3,"actions","entry"],[3,"pSelectableRow"],[1,"checkbox-cell"],["ariaLabel",V,3,"value"],[1,"expand-cell"],[3,"pRowToggler","expanded"],[1,"action-cell"],["placement","bottom-right top-right left auto","container","body","label",x,3,"actions","entry"],[1,"pt-badge","ellipsis",3,"ngClass"],[4,"ngIf"],["class","pt-badge",3,"ngClass",4,"ngIf"],[1,"fs-7"],[1,"pt-badge",3,"ngClass"],["myAutoColspan",""],[1,"mt-2","fs-7","font-monospace"],[1,"mt-2"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"no-results"]];},template:function(t,_){t&1&&(i(0,"h1",15)(1,"span",16),m(2,"my-global-icon",17),i(3,"span"),s(4,0),o()(),i(5,"a",18),m(6,"my-global-icon",19),S(7),s(8,1),E(),o()(),i(9,"p-table",20),M("onLazyLoad",function(g){return _.loadLazy(g);}),Oe("selectionChange",function(g){return Ie(_.selectedRows,g)||(_.selectedRows=g),g;}),u(10,Ap,29,4,"ng-template",21)(11,bp,6,2,"ng-template",22)(12,vp,28,17,"ng-template",23)(13,yp,20,6,"ng-template",24)(14,Lp,5,0,"ng-template",25),o()),t&2&&(a(9),l("value",_.runnerJobs)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1),Te("selection",_.selectedRows),l("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows));},dependencies:[de,Le,ve,be,Ae,Fe,tn,ft,he,Lt,$t,Re,$e,B,tt,nt,dt,Mt,le,Ue],encapsulation:2}));var nr=bo;function $p(n,r){if(n&1&&(i(0,"tr")(1,"th",18)(2,"span",19),s(3,2),o()(),i(4,"th",20),s(5,3),o(),i(6,"th",20),s(7,4),o(),i(8,"th",20),s(9,5),o(),i(10,"th",20),s(11,6),o(),i(12,"th",21),D(13,7),m(14,"p-sortIcon",22),y(),o()()),n&2){let e=p();a(12),l("ngbTooltip",e.sortTooltip);}}function xp(n,r){if(n&1&&(i(0,"tr")(1,"td",23),m(2,"my-action-dropdown",24),o(),i(3,"td"),C(4),o(),i(5,"td"),C(6),o(),i(7,"td"),C(8),o(),i(9,"td"),C(10),ie(11,"date"),o(),i(12,"td"),C(13),ie(14,"date"),o()()),n&2){let e=r.$implicit,t=p();a(2),l("actions",t.actions)("entry",e),a(2),I(e.name),a(2),I(e.description),a(2),I(e.ip),a(2),I(_e(11,7,e.lastContact,"short")),a(3),I(_e(14,10,e.createdAt,"short"));}}function Gp(n,r){n&1&&(i(0,"tr")(1,"td",25)(2,"div",26),S(3),s(4,8),E(),o()()());}var Fo=class Fo extends ze{constructor(e,t,_){super();this.runnerService=e;this.notifier=t;this.confirmService=_;c(this,"runners",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"actions",[]);}ngOnInit(){this.actions=[[{label:"\u79FB\u9664",handler:e=>this.deleteRunner(e)}]],this.initialize();}getIdentifier(){return"RunnerListComponent";}deleteRunner(e){return pe(this,null,function*(){(yield this.confirmService.confirm("\u60A8\u771F\u7684\u8981\u522A\u9664\u6B64\u57F7\u884C\u5668\u55CE\uFF1F\u5176\u5C07\u7121\u6CD5\u518D\u8655\u7406\u4F5C\u696D\u3002","\u79FB\u9664 "+e.name+""))!==!1&&this.runnerService.deleteRunner(e).subscribe({next:()=>{this.reloadData(),this.notifier.success("\u57F7\u884C\u5668\u5DF2\u79FB\u9664\u3002");},error:_=>this.notifier.error(_.message)});});}reloadDataInternal(){this.runnerService.listRunners({pagination:this.pagination,sort:this.sort}).subscribe({next:e=>{this.runners=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}};c(Fo,"\u0275fac",function(t){return new(t||Fo)(T(rn),T(K),T(xe));}),c(Fo,"\u0275cmp",h({type:Fo,selectors:[["my-runner-list"]],standalone:!0,features:[ne,v],decls:13,vars:11,consts:()=>{let e;e="\u9060\u7AEF\u57F7\u884C\u5668";let t;t="\u57F7\u884C\u5668\u8A3B\u518A\u6B0A\u6756";let _;_="\u52D5\u4F5C";let d;d="\u540D\u7A31";let g;g="\u63CF\u8FF0";let O;O="IP";let R;R="\u6700\u5F8C\u63A5\u89F8";let N;N="\u5EFA\u7ACB "+"\uFFFD#14\uFFFD"+""+"\uFFFD/#14\uFFFD"+"";let b;b="\u52D5\u4F5C";let G;return G="\u627E\u4E0D\u5230\u9060\u7AEF\u57F7\u884C\u5668\u3002",[e,t,_,d,g,O,R,N,G,[1,"d-flex","justify-content-between"],[1,"text-nowrap","me-2"],["iconName","codesandbox","aria-hidden","true"],["routerLink","/admin/system/runners/registration-tokens-list",1,"peertube-button-link","peertube-button-icon","grey-button"],["iconName","cog","aria-hidden","true"],[3,"onLazyLoad","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["scope","col",2,"width","120px"],[1,"visually-hidden"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],["placement","bottom-right top-right left auto","container","body","label",b,3,"actions","entry"],["myAutoColspan",""],[1,"no-results"]];},template:function(t,_){t&1&&(i(0,"h1",9)(1,"span",10),m(2,"my-global-icon",11),S(3),s(4,0),E(),o(),i(5,"a",12),m(6,"my-global-icon",13),S(7),s(8,1),E(),o()(),i(9,"p-table",14),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(10,$p,15,1,"ng-template",15)(11,xp,15,13,"ng-template",16)(12,Gp,5,0,"ng-template",17),o()),t&2&&(a(9),l("value",_.runners)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()));},dependencies:[de,Le,ve,be,Ae,Fe,he,Re,$e,tt,Ue,ye],encapsulation:2}));var or=Fo;function Up(n,r){if(n&1&&(i(0,"tr")(1,"th",17)(2,"span",18),s(3,2),o()(),i(4,"th",19),s(5,3),o(),i(6,"th",20),D(7,4),m(8,"p-sortIcon",21),y(),o(),i(9,"th",22),s(10,5),o()()),n&2){let e=p();a(6),l("ngbTooltip",e.sortTooltip);}}function wp(n,r){if(n&1){let e=k();i(0,"div",23)(1,"div",24)(2,"my-button",25),M("click",function(){P(e);let _=p();return A(_.generateToken());}),o()()();}}function Vp(n,r){if(n&1&&(i(0,"tr")(1,"td",26),m(2,"my-action-dropdown",27),o(),i(3,"td"),C(4),m(5,"my-copy-button",28),o(),i(6,"td"),C(7),ie(8,"date"),o(),i(9,"td"),C(10),o()()),n&2){let e=r.$implicit,t=p();a(2),l("actions",t.actions)("entry",e),a(2),w(" ",e.registrationToken," "),a(),l("value",e.registrationToken),a(2),I(_e(8,6,e.createdAt,"short")),a(3),I(e.registeredRunnersCount);}}function kp(n,r){n&1&&(i(0,"tr")(1,"td",29)(2,"div",30),S(3),s(4,6),E(),o()()());}var ho=class ho extends ze{constructor(e,t,_){super();this.runnerService=e;this.notifier=t;this.confirmService=_;c(this,"registrationTokens",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"actions",[]);}ngOnInit(){this.actions=[[{label:"\u79FB\u9664\u6B64\u6B0A\u6756",handler:e=>this.removeToken(e)}]],this.initialize();}getIdentifier(){return"RunnerRegistrationTokenListComponent";}generateToken(){this.runnerService.generateToken().subscribe({next:()=>{this.reloadData(),this.notifier.success("\u8A3B\u518A\u6B0A\u6756\u5DF2\u7522\u751F\u3002");},error:e=>this.notifier.error(e.message)});}removeToken(e){return pe(this,null,function*(){(yield this.confirmService.confirm("\u60A8\u771F\u7684\u60F3\u8981\u79FB\u9664\u6B64\u8A3B\u518A\u6B0A\u6756\u55CE\uFF1F\u6240\u6709\u76F8\u95DC\u7684\u57F7\u884C\u5668\u4E5F\u5C07\u6703\u88AB\u79FB\u9664\u3002","\u79FB\u9664\u8A3B\u518A\u6B0A\u6756"))!==!1&&this.runnerService.removeToken(e).subscribe({next:()=>{this.reloadData(),this.notifier.success("\u8A3B\u518A\u6B0A\u6756\u5DF2\u79FB\u9664\u3002");},error:_=>this.notifier.error(_.message)});});}reloadDataInternal(){this.runnerService.listRegistrationTokens({pagination:this.pagination,sort:this.sort}).subscribe({next:e=>{this.registrationTokens=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}};c(ho,"\u0275fac",function(t){return new(t||ho)(T(rn),T(K),T(xe));}),c(ho,"\u0275cmp",h({type:ho,selectors:[["my-runner-registration-token-list"]],standalone:!0,features:[ne,v],decls:15,vars:11,consts:()=>{let e;e="\u57F7\u884C\u5668\u8A3B\u518A\u6B0A\u6756";let t;t="\u9060\u7AEF\u57F7\u884C\u5668";let _;_="\u52D5\u4F5C";let d;d="\u6B0A\u6756";let g;g="\u5EFA\u7ACB "+"\uFFFD#8\uFFFD"+""+"\uFFFD/#8\uFFFD"+"";let O;O="\u76F8\u95DC\u57F7\u884C\u5668";let R;R="\u7522\u751F\u6B0A\u6756";let N;N="\u52D5\u4F5C";let b;b="\u5DF2\u8907\u88FD\u8A3B\u518A\u6B0A\u6756";let G;G="\u8907\u88FD\u8A3B\u518A\u6B0A\u6756";let F;return F="\u627E\u4E0D\u5230\u9060\u7AEF\u57F7\u884C\u5668\u7684\u8A3B\u518A\u6B0A\u6756\u3002",[e,t,_,d,g,O,F,[1,"d-flex","justify-content-between"],[1,"text-nowrap","me-2"],["iconName","cog","aria-hidden","true"],["routerLink","/admin/system/runners/runners-list",1,"peertube-button-link","peertube-button-icon","grey-button"],["iconName","codesandbox","aria-hidden","true"],[3,"onLazyLoad","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","header"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["scope","col",2,"width","120px"],[1,"visually-hidden"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],["scope","col",2,"width","160px"],[1,"caption"],[1,"left-buttons"],["theme","orange","label",R,"icon","add",3,"click"],[1,"action-cell"],["placement","bottom-right top-right left auto","container","body","label",N,3,"actions","entry"],["notification",b,"title",G,3,"value"],["myAutoColspan",""],[1,"no-results"]];},template:function(t,_){t&1&&(i(0,"h1",7)(1,"span",8),m(2,"my-global-icon",9),S(3),s(4,0),E(),o(),i(5,"div")(6,"a",10),m(7,"my-global-icon",11),S(8),s(9,1),E(),o()()(),i(10,"p-table",12),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(11,Up,11,1,"ng-template",13)(12,wp,3,0,"ng-template",14)(13,Vp,11,9,"ng-template",15)(14,kp,5,0,"ng-template",16),o()),t&2&&(a(10),l("value",_.registrationTokens)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()));},dependencies:[de,Le,ve,be,Ae,Fe,he,Re,$e,dt,tt,Ci,Ue,ye],styles:["my-copy-button[_ngcontent-%COMP%]{margin-inline-start:.1875rem}tr[_ngcontent-%COMP%]:not(:hover)   my-copy-button[_ngcontent-%COMP%]{opacity:0}"]}));var ir=ho;var hl=[{path:"runners",canActivate:[De],data:{userRight:Q.MANAGE_RUNNERS},children:[{path:"",redirectTo:"jobs-list",pathMatch:"full"},{path:"jobs-list",component:nr,data:{meta:{title:"\u5217\u51FA\u57F7\u884C\u5668\u4F5C\u696D"}}},{path:"runners-list",component:or,data:{meta:{title:"\u5217\u51FA\u9060\u7AEF\u57F7\u884C\u5668"}}},{path:"registration-tokens-list",component:ir,data:{meta:{title:"\u5217\u51FA\u8A3B\u518A\u57F7\u884C\u5668\u6B0A\u6756"}}}]}];var vl=[{path:"system",children:[{path:"",redirectTo:"jobs",pathMatch:"full"},{path:"jobs",canActivate:[De],component:Zi,data:{meta:{userRight:Q.MANAGE_JOBS,title:"\u5DE5\u4F5C"}}},{path:"logs",canActivate:[De],component:tr,data:{meta:{userRight:Q.MANAGE_LOGS,title:"\u7D00\u9304"}}},{path:"debug",canActivate:[De],component:Qi,data:{meta:{userRight:Q.MANAGE_DEBUG,title:"\u9664\u932F"}}},...hl]}];var zp=n=>({"sub-menu-offset-content":n}),vo=class vo{constructor(r,e,t){this.auth=r;this.screen=e;this.server=t;c(this,"items",[]);c(this,"menuEntries",[]);}get isBroadcastMessageDisplayed(){return this.screen.isBroadcastMessageDisplayed;}ngOnInit(){this.server.configReloaded.subscribe(()=>this.buildMenu()),this.buildMenu();}buildMenu(){this.menuEntries=[],this.buildOverviewItems(),this.buildFederationItems(),this.buildModerationItems(),this.buildConfigurationItems(),this.buildPluginItems(),this.buildSystemItems();}buildOverviewItems(){let r={label:"\u6982\u89BD",children:[]};this.hasRight(Q.MANAGE_USERS)&&r.children.push({label:"\u4F7F\u7528\u8005",routerLink:"/admin/users",iconName:"user"}),this.hasRight(Q.SEE_ALL_VIDEOS)&&r.children.push({label:"\u5F71\u7247",routerLink:"/admin/videos",queryParams:{search:"isLocal:true"},iconName:"videos"}),this.hasRight(Q.SEE_ALL_COMMENTS)&&r.children.push({label:"\u7559\u8A00",routerLink:"/admin/comments",iconName:"message-circle"}),r.children.length!==0&&this.menuEntries.push(r);}buildFederationItems(){this.hasRight(Q.MANAGE_SERVER_FOLLOW)&&this.menuEntries.push({label:"\u806F\u76DF",children:[{label:"\u6B63\u5728\u8FFD\u8E64",routerLink:"/admin/follows/following-list",iconName:"following"},{label:"\u8FFD\u8E64\u8005",routerLink:"/admin/follows/followers-list",iconName:"follower"},{label:"\u91CD\u8907\u5F71\u7247",routerLink:"/admin/follows/video-redundancies-list",iconName:"videos"}]});}buildModerationItems(){let r={label:"\u7BA1\u7406",children:[]};this.hasRight(Q.MANAGE_REGISTRATIONS)&&r.children.push({label:"\u8A3B\u518A",routerLink:"/admin/moderation/registrations/list",iconName:"user"}),this.hasRight(Q.MANAGE_ABUSES)&&r.children.push({label:"\u56DE\u5831",routerLink:"/admin/moderation/abuses/list",iconName:"flag"}),this.hasRight(Q.MANAGE_VIDEO_BLACKLIST)&&r.children.push({label:"\u5F71\u7247\u5C01\u9396",routerLink:"/admin/moderation/video-blocks/list",iconName:"cross"}),this.hasRight(Q.MANAGE_ACCOUNTS_BLOCKLIST)&&r.children.push({label:"\u5DF2\u975C\u97F3\u7684\u5E33\u865F",routerLink:"/admin/moderation/blocklist/accounts",iconName:"user-x"}),this.hasRight(Q.MANAGE_SERVERS_BLOCKLIST)&&r.children.push({label:"\u5DF2\u975C\u97F3\u4F3A\u670D\u5668",routerLink:"/admin/moderation/blocklist/servers",iconName:"peertube-x"}),this.hasRight(Q.MANAGE_INSTANCE_WATCHED_WORDS)&&r.children.push({label:"\u5DF2\u89C0\u770B\u7684\u5F71\u7247",routerLink:"/admin/moderation/watched-words/list",iconName:"eye-open"}),r.children.length!==0&&this.menuEntries.push(r);}buildConfigurationItems(){this.hasRight(Q.MANAGE_CONFIGURATION)&&this.menuEntries.push({label:"\u8A2D\u5B9A",routerLink:"/admin/config"});}buildPluginItems(){this.hasRight(Q.MANAGE_PLUGINS)&&this.menuEntries.push({label:"\u5916\u639B\u7A0B\u5F0F\uFF0F\u4F48\u666F\u4E3B\u984C",routerLink:"/admin/plugins"});}buildSystemItems(){let r={label:"\u7CFB\u7D71",children:[]};this.isRemoteRunnersEnabled()&&this.hasRight(Q.MANAGE_RUNNERS)&&(r.children.push({label:"\u9060\u7AEF\u57F7\u884C\u5668",iconName:"codesandbox",routerLink:"/admin/system/runners/runners-list"}),r.children.push({label:"\u57F7\u884C\u5668\u4F5C\u696D",iconName:"globe",routerLink:"/admin/system/runners/jobs-list"})),this.hasRight(Q.MANAGE_JOBS)&&r.children.push({label:"\u672C\u6A5F\u4F5C\u696D",iconName:"circle-tick",routerLink:"/admin/system/jobs"}),this.hasRight(Q.MANAGE_LOGS)&&r.children.push({label:"\u7D00\u9304",iconName:"playlists",routerLink:"/admin/system/logs"}),this.hasRight(Q.MANAGE_DEBUG)&&r.children.push({label:"\u9664\u932F",iconName:"cog",routerLink:"/admin/system/debug"}),r.children.length!==0&&this.menuEntries.push(r);}hasRight(r){return this.auth.getUser().hasRight(r);}isRemoteRunnersEnabled(){let r=this.server.getHTMLConfig();return r.transcoding.remoteRunners.enabled||r.live.transcoding.remoteRunners.enabled||r.videoStudio.remoteRunners.enabled||r.videoTranscription.remoteRunners.enabled;}};c(vo,"\u0275fac",function(e){return new(e||vo)(T(Zt),T(zn),T(Ge));}),c(vo,"\u0275cmp",h({type:vo,selectors:[["ng-component"]],standalone:!0,features:[v],decls:4,vars:4,consts:[[1,"root"],[3,"menuEntries"],[1,"margin-content",3,"ngClass"]],template:function(e,t){e&1&&(i(0,"div",0),m(1,"my-top-menu-dropdown",1),i(2,"div",2),m(3,"router-outlet"),o()()),e&2&&(a(),l("menuEntries",t.menuEntries),a(),l("ngClass",X(2,zp,!t.isBroadcastMessageDisplayed)));},dependencies:[Q_,le,Ka],styles:["my-top-menu-dropdown[_ngcontent-%COMP%]{flex-grow:1}.root[_ngcontent-%COMP%]     h1{font-size:1.3rem;border-bottom:2px solid #E5E5E5;padding-bottom:15px;margin-bottom:30px}.root[_ngcontent-%COMP%]     h1>span>my-global-icon, .root[_ngcontent-%COMP%]     h1>my-global-icon{width:24px;height:24px;position:relative;top:-2px;margin-inline-end:.625rem}.root[_ngcontent-%COMP%]     h1 .pt-badge{vertical-align:top;margin-inline-start:.4375rem}"]}));var rr=vo;function Xp(n,r){if(n&1&&m(0,"my-action-dropdown",22),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function Bp(n,r){if(n&1){let e=k();i(0,"div",17)(1,"div",18),u(2,Xp,1,2,"my-action-dropdown",19),o(),i(3,"div",20)(4,"my-advanced-input-filter",21),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode()),a(2),l("filters",e.searchFilters);}}function Wp(n,r){if(n&1&&(i(0,"tr")(1,"th",23),m(2,"p-tableHeaderCheckbox",24),o(),i(3,"th",25),s(4,1),o(),i(5,"th",26),s(6,2),o(),i(7,"th",27),D(8,3),m(9,"p-sortIcon",28),y(),o(),i(10,"th",29),D(11,4),m(12,"p-sortIcon",30),y(),o(),i(13,"th",31),D(14,5),m(15,"p-sortIcon",32),y(),o()()),n&2){let e=p();a(7),l("ngbTooltip",e.sortTooltip),a(3),l("ngbTooltip",e.sortTooltip),a(3),l("ngbTooltip",e.sortTooltip);}}function jp(n,r){if(n&1){let e=k();i(0,"my-button",44),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.acceptFollower([_]));}),o();}}function Hp(n,r){if(n&1){let e=k();i(0,"my-button",45),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.rejectFollower([_]));}),o();}}function Jp(n,r){if(n&1){let e=k();i(0,"my-delete-button",46),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.deleteFollowers([_]));}),o();}}function Kp(n,r){n&1&&(i(0,"span",47),s(1,6),o());}function Yp(n,r){n&1&&(i(0,"span",48),s(1,7),o());}function qp(n,r){n&1&&(i(0,"span",49),s(1,8),o());}function Qp(n,r){if(n&1&&(i(0,"tr")(1,"td",33),m(2,"p-tableCheckbox",34),o(),i(3,"td",35),u(4,jp,1,0,"my-button",36)(5,Hp,1,0,"my-button",37)(6,Jp,1,0,"my-delete-button",38),o(),i(7,"td")(8,"a",39),C(9),m(10,"my-global-icon",40),o()(),i(11,"td"),u(12,Kp,2,0,"span",41)(13,Yp,2,0,"span",42)(14,qp,2,0,"span",43),o(),i(15,"td"),C(16),o(),i(17,"td"),C(18),ie(19,"date"),o()()),n&2){let e=r.$implicit,t=p();a(2),l("value",e),a(2),l("ngIf",e.state!=="accepted"),a(),l("ngIf",e.state!=="rejected"),a(),l("ngIf",e.state==="rejected"),a(2),l("href",e.follower.url,Xe),a(),w(" ",t.buildFollowerName(e)," "),a(3),l("ngIf",e.state==="accepted"),a(),l("ngIf",e.state==="pending"),a(),l("ngIf",e.state==="rejected"),a(2),I(e.score),a(2),I(_e(19,11,e.createdAt,"short"));}}function Zp(n,r){n&1&&(S(0),s(1,9),E());}function em(n,r){n&1&&(S(0),s(1,10),E());}function tm(n,r){if(n&1&&(i(0,"tr")(1,"td",50)(2,"div",51),u(3,Zp,2,0,"ng-container",52)(4,em,2,0,"ng-container",52),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var Do=class Do extends ze{constructor(e,t,_){super();this.confirmService=e;this.notifier=t;this.followService=_;c(this,"followers",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"searchFilters",[]);c(this,"bulkActions",[]);}ngOnInit(){this.initialize(),this.searchFilters=this.followService.buildFollowsListFilters(),this.bulkActions=[{label:"\u62D2\u7D55",handler:e=>this.rejectFollower(e),isDisplayed:e=>e.every(t=>t.state!=="rejected")},{label:"\u63A5\u53D7",handler:e=>this.acceptFollower(e),isDisplayed:e=>e.every(t=>t.state!=="accepted")},{label:"\u522A\u9664",handler:e=>this.deleteFollowers(e),isDisplayed:e=>e.every(t=>t.state==="rejected")}];}getIdentifier(){return"FollowersListComponent";}acceptFollower(e){this.followService.acceptFollower(e).subscribe({next:()=>{let t=me("\u5DF2\u63A5\u53D7 {count, plural, =1 {{followerName} \u500B\u8FFD\u8E64\u8ACB\u6C42} other {{count} \u500B\u8FFD\u8E64\u8ACB\u6C42}}",{count:e.length,followerName:this.buildFollowerName(e[0])});this.notifier.success(t),this.reloadData();},error:t=>this.notifier.error(t.message)});}rejectFollower(e){return pe(this,null,function*(){let t=me("\u60A8\u771F\u7684\u60F3\u8981\u56DE\u7D55 {count, plural, =1 {{followerName} \u500B\u8FFD\u8E64\u8ACB\u6C42\u55CE\uFF1F} other {{count} \u500B\u8FFD\u8E64\u8ACB\u6C42\u55CE\uFF1F}}",{count:e.length,followerName:this.buildFollowerName(e[0])});(yield this.confirmService.confirm(t,"\u62D2\u7D55"))!==!1&&this.followService.rejectFollower(e).subscribe({next:()=>{let d=me("\u5DF2\u56DE\u7D55 {count, plural, =1 {{followerName} \u500B\u8FFD\u8E64\u8ACB\u6C42} other {{count} \u500B\u8FFD\u8E64\u8ACB\u6C42}}",{count:e.length,followerName:this.buildFollowerName(e[0])});this.notifier.success(d),this.reloadData();},error:d=>this.notifier.error(d.message)});});}deleteFollowers(e){return pe(this,null,function*(){let t={count:e.length,followerName:this.buildFollowerName(e[0])},_="\u5DF2\u522A\u9664\u7684\u8FFD\u8E64\u8005\u5C07\u53EF\u518D\u6B21\u50B3\u9001\u8FFD\u8E64\u8ACB\u6C42\u3002";_+="<br /><br />",_+=me("\u60A8\u771F\u7684\u60F3\u8981\u522A\u9664 {count, plural, =1 {{followerName} \u500B\u8FFD\u8E64\u8ACB\u6C42\u55CE\uFF1F} other {{count} \u500B\u8FFD\u8E64\u8ACB\u6C42\u55CE\uFF1F}}",t),(yield this.confirmService.confirm(_,"\u522A\u9664"))!==!1&&this.followService.removeFollower(e).subscribe({next:()=>{let g=me("\u5DF2\u79FB\u9664 {count, plural, =1 {{followerName} \u500B\u8FFD\u8E64\u8ACB\u6C42} other {{count} \u500B\u8FFD\u8E64\u8ACB\u6C42}}",t);this.notifier.success(g),this.reloadData();},error:g=>this.notifier.error(g.message)});});}buildFollowerName(e){return e.follower.name+"@"+e.follower.host;}reloadDataInternal(){this.followService.getFollowers({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>{this.followers=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}};c(Do,"\u0275fac",function(t){return new(t||Do)(T(xe),T(K),T(Pn));}),c(Do,"\u0275cmp",h({type:Do,selectors:[["my-followers-list"]],standalone:!0,features:[ne,v],decls:9,vars:13,consts:()=>{let e;e="\u60A8\u7AD9\u53F0\u7684\u8FFD\u8E64\u8005";let t;t="\u6279\u6B21\u52D5\u4F5C";let _;_="\u9078\u53D6\u6240\u6709\u5217";let d;d="\u52D5\u4F5C";let g;g="\u8FFD\u8E64\u8005";let O;O="\u9673\u8FF0 "+"\uFFFD#9\uFFFD"+""+"\uFFFD/#9\uFFFD"+"";let R;R="\u5206\u6578 "+"\uFFFD#12\uFFFD"+""+"\uFFFD/#12\uFFFD"+"";let N;N="\u5EFA\u7ACB "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let b;b="\u9078\u53D6\u6B64\u5217";let G;G="\u63A5\u53D7";let F;F="\u62D2\u7D55";let L;L="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u52D5\u4F5C\u9801\u9762";let $;$="\u5DF2\u63A5\u53D7";let H;H="\u64F1\u7F6E\u4E2D";let z;z="\u5DF2\u56DE\u7D55";let V;V="\u6C92\u6709\u7B26\u5408\u76EE\u524D\u904E\u6FFE\u5668\u7684\u8FFD\u96A8\u8005\u3002";let x;return x="\u60A8\u7684\u7AD9\u81FA\u6C92\u6709\u4EFB\u4F55\u8FFD\u96A8\u8005\u3002",[e,d,g,O,R,N,$,H,z,V,x,["iconName","follower","aria-hidden","true"],[3,"onLazyLoad","selectionChange","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate","selection"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"caption"],[1,"left-buttons"],["label",t,"theme","orange",3,"actions","entry",4,"ngIf"],[1,"ms-auto"],[3,"search","filters"],["label",t,"theme","orange",3,"actions","entry"],["scope","col",2,"width","40px"],["ariaLabel",_],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","state",2,"width","100px",3,"ngbTooltip"],["field","state"],["scope","col","container","body","pSortableColumn","score",2,"width","100px",3,"ngbTooltip"],["field","score"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"checkbox-cell"],["ariaLabel",b,3,"value"],[1,"action-cell"],["title",G,"icon","tick",3,"click",4,"ngIf"],["title",F,"icon","cross",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["title",L,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["class","pt-badge badge-green",4,"ngIf"],["class","pt-badge badge-yellow",4,"ngIf"],["class","pt-badge badge-red",4,"ngIf"],["title",G,"icon","tick",3,"click"],["title",F,"icon","cross",3,"click"],[3,"click"],[1,"pt-badge","badge-green"],[1,"pt-badge","badge-yellow"],[1,"pt-badge","badge-red"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(t,_){t&1&&(i(0,"h1"),m(1,"my-global-icon",11),S(2),s(3,0),E(),o(),i(4,"p-table",12),M("onLazyLoad",function(g){return _.loadLazy(g);}),Oe("selectionChange",function(g){return Ie(_.selectedRows,g)||(_.selectedRows=g),g;}),u(5,Bp,5,2,"ng-template",13)(6,Wp,16,3,"ng-template",14)(7,Qp,20,14,"ng-template",15)(8,tm,5,2,"ng-template",16),o()),t&2&&(a(4),l("value",_.followers)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()),Te("selection",_.selectedRows));},dependencies:[de,ve,be,Ae,Fe,he,Lt,$t,Re,B,tt,nt,$e,dt,fn,Ue,ye],styles:["a[_ngcontent-%COMP%]{display:inline-block}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none!important}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:80%;color:var(--inputPlaceholderColor)}.action-cell[_ngcontent-%COMP%]   my-button[_ngcontent-%COMP%]:first-child{margin-inline-end:.625rem}my-delete-button[_ngcontent-%COMP%]{max-width:130px}"]}));var ar=Do;var nm=["modal"],om=n=>({"input-error":n});function im(n,r){if(n&1&&(i(0,"div"),C(1),o()),n&2){let e=p(3);a(),w(" ",e.form.controls.hostsOrHandles.errors.validHostsOrHandles.value," ");}}function rm(n,r){if(n&1&&(i(0,"div",18),C(1),u(2,im,2,1,"div",19),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.hostsOrHandles," "),a(),l("ngIf",e.form.controls.hostsOrHandles.errors.validHostsOrHandles);}}function am(n,r){n&1&&(i(0,"div",20),s(1,3),o());}function _m(n,r){if(n&1){let e=k();i(0,"div",4)(1,"h4",5),s(2,1),o(),i(3,"button",6),M("click",function(){P(e);let _=p();return A(_.hide());}),m(4,"my-global-icon",7),o()(),i(5,"div",8)(6,"form",9),M("ngSubmit",function(){P(e);let _=p();return A(_.submit());}),i(7,"div",10)(8,"label",11),s(9,2),o(),m(10,"textarea",12),u(11,rm,3,2,"div",13),o(),u(12,am,2,0,"div",14),i(13,"div",15)(14,"input",16),M("click",function(){P(e);let _=p();return A(_.hide());})("key.enter",function(){P(e);let _=p();return A(_.hide());}),o(),m(15,"input",17),o()()();}if(n&2){let e=p();a(6),l("formGroup",e.form),a(4),l("placeholder",e.placeholder)("ngClass",X(6,om,e.formErrors.hostsOrHandles)),a(),l("ngIf",e.formErrors.hostsOrHandles),a(),l("ngIf",e.httpEnabled()===!1),a(3),l("disabled",!e.form.valid);}}var yo=class yo extends yt{constructor(e,t,_,d){super();this.formReactiveService=e;this.modalService=t;this.followService=_;this.notifier=d;c(this,"modal");c(this,"newFollow",new ai());c(this,"placeholder",`example.com
chocobozzz@example.com
chocobozzz_channel@example.com`);c(this,"openedModal");}ngOnInit(){this.buildForm({hostsOrHandles:B_});}openModal(){this.openedModal=this.modalService.open(this.modal,{centered:!0});}hide(){this.openedModal.close();}submit(){this.addFollowing(),this.form.reset(),this.hide();}httpEnabled(){return window.location.protocol==="https:";}addFollowing(){let e=I_(this.form.value.hostsOrHandles);this.followService.follow(e).subscribe({next:()=>{this.notifier.success(me("{count, plural, =1 {\u8FFD\u8E64\u8ACB\u6C42\u5DF2\u50B3\u9001\uFF01} other {\u8FFD\u8E64\u8ACB\u6C42\u5DF2\u50B3\u9001\uFF01}}",{count:e.length})),this.newFollow.emit();},error:t=>this.notifier.error(t.message)});}};c(yo,"\u0275fac",function(t){return new(t||yo)(T(Nt),T(di),T(Pn),T(K));}),c(yo,"\u0275cmp",h({type:yo,selectors:[["my-follow-modal"]],viewQuery:function(t,_){if(t&1&&gt(nm,7),t&2){let d;Ct(d=St())&&(_.modal=d.first);}},outputs:{newFollow:"newFollow"},standalone:!0,features:[ne,v],decls:2,vars:0,consts:()=>{let e;e="\u95DC\u9589\u6B64\u6A21\u5F0F";let t;t="\u53D6\u6D88";let _;_="\u8FFD\u8E64";let d;d="\u8FFD\u8E64";let g;g="1 \u500B\u4E3B\u6A5F\uFF08\u4E0D\u5305\u542B \"http://\"\uFF09\uFF0C\u6BCF\u884C\u4E00\u500B\u5E33\u865F\u6216\u983B\u9053";let O;return O="\u770B\u8D77\u4F86\u60A8\u4F3C\u4E4E\u4E0D\u5728 HTTPS \u4F3A\u670D\u5668\u4E0A\u3002\u60A8\u7684\u7DB2\u8DEF\u4F3A\u670D\u5668\u5FC5\u9808\u555F\u7528 TLS \u624D\u80FD\u8FFD\u8E64\u4F3A\u670D\u5668\u3002",[["modal",""],d,g,O,[1,"modal-header"],[1,"modal-title"],["title",e,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","hostsOrHandles"],["formControlName","hostsOrHandles","type","text","id","hostsOrHandles","name","hostsOrHandles","ngbAutofocus","",1,"form-control",3,"placeholder","ngClass"],["class","form-error","role","alert",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",t,1,"peertube-button","grey-button",3,"click","key.enter"],["type","submit","value",_,1,"peertube-button","orange-button",3,"disabled"],["role","alert",1,"form-error"],[4,"ngIf"],[1,"alert","alert-warning"]];},template:function(t,_){t&1&&u(0,_m,16,8,"ng-template",null,0,Sn);},dependencies:[de,ce,Ot,Ve,Se,Me,Pe,fe,ke,le,B],styles:["textarea[_ngcontent-%COMP%]{height:200px}"]}));var _r=yo;var Lo=class Lo{constructor(r,e){this.notifier=r;this.redundancyService=e;c(this,"redundancyAllowed");c(this,"host");}updateRedundancyState(){this.redundancyService.updateRedundancy(this.host,this.redundancyAllowed).subscribe({next:()=>{let r=this.redundancyAllowed?"\u5DF2\u555F\u7528":"\u5DF2\u505C\u7528";this.notifier.success("\u5197\u9918 "+this.host+" \u70BA "+r+"");},error:r=>this.notifier.error(r.message)});}};c(Lo,"\u0275fac",function(e){return new(e||Lo)(T(K),T(hi));}),c(Lo,"\u0275cmp",h({type:Lo,selectors:[["my-redundancy-checkbox"]],inputs:{redundancyAllowed:"redundancyAllowed",host:"host"},standalone:!0,features:[v],decls:1,vars:2,consts:[[3,"ngModelChange","inputName","ngModel"]],template:function(e,t){e&1&&(i(0,"my-peertube-checkbox",0),Oe("ngModelChange",function(d){return Ie(t.redundancyAllowed,d)||(t.redundancyAllowed=d),d;}),M("ngModelChange",function(){return t.updateRedundancyState();}),o()),e&2&&(l("inputName",t.host+"-redundancy-allowed"),Te("ngModel",t.redundancyAllowed));},dependencies:[et,ce,Se,At],encapsulation:2}));var lr=Lo;var sm=["followModal"];function cm(n,r){if(n&1&&m(0,"my-action-dropdown",25),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function dm(n,r){if(n&1){let e=k();i(0,"button",26),M("click",function(){P(e);let _=p(2);return A(_.openFollowModal());}),m(1,"my-global-icon",13),S(2),s(3,2),E(),o();}}function pm(n,r){if(n&1){let e=k();i(0,"div",19)(1,"div",20),u(2,cm,1,2,"my-action-dropdown",21)(3,dm,4,0,"button",22),o(),i(4,"div",23)(5,"my-advanced-input-filter",24),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode()),a(),l("ngIf",!e.isInSelectionMode()),a(2),l("filters",e.searchFilters);}}function mm(n,r){n&1&&(i(0,"tr")(1,"th",27),m(2,"p-tableHeaderCheckbox",28),o(),i(3,"th",29),s(4,3),o(),i(5,"th",30),s(6,4),o(),i(7,"th",31),D(8,5),m(9,"p-sortIcon",32),y(),o(),i(10,"th",33),D(11,6),m(12,"p-sortIcon",34),y(),o(),i(13,"th",35),D(14,7),m(15,"p-sortIcon",36),y(),o()());}function um(n,r){n&1&&(i(0,"span",48),s(1,8),o());}function gm(n,r){n&1&&(i(0,"span",49),s(1,9),o());}function Cm(n,r){n&1&&(i(0,"span",50),s(1,10),o());}function Sm(n,r){if(n&1&&m(0,"my-redundancy-checkbox",51),n&2){let e=p().$implicit;l("host",e.following.host)("redundancyAllowed",e.following.hostRedundancyAllowed);}}function Em(n,r){if(n&1){let e=k();i(0,"tr",37)(1,"td",38),m(2,"p-tableCheckbox",39),o(),i(3,"td",40)(4,"my-delete-button",41),M("click",function(){let _=P(e).$implicit,d=p();return A(d.removeFollowing([_]));}),o()(),i(5,"td")(6,"a",42),C(7),m(8,"my-global-icon",43),o()(),i(9,"td"),u(10,um,2,0,"span",44)(11,gm,2,0,"span",45)(12,Cm,2,0,"span",46),o(),i(13,"td"),C(14),ie(15,"date"),o(),i(16,"td"),u(17,Sm,1,2,"my-redundancy-checkbox",47),o()();}if(n&2){let e=r.$implicit,t=p();a(2),l("value",e),a(4),l("href",e.following.url,Xe),a(),w(" ",t.buildFollowingName(e)," "),a(3),l("ngIf",e.state==="accepted"),a(),l("ngIf",e.state==="pending"),a(),l("ngIf",e.state==="rejected"),a(2),I(_e(15,8,e.createdAt,"short")),a(3),l("ngIf",t.isInstanceFollowing(e));}}function Tm(n,r){n&1&&(S(0),s(1,11),E());}function Im(n,r){n&1&&(S(0),s(1,12),E());}function Om(n,r){if(n&1&&(i(0,"tr")(1,"td",52)(2,"div",53),u(3,Tm,2,0,"ng-container",54)(4,Im,2,0,"ng-container",54),o()()()),n&2){let e=p();a(3),l("ngIf",e.search),a(),l("ngIf",!e.search);}}var $o=class $o extends ze{constructor(e,t,_){super();this.notifier=e;this.confirmService=t;this.followService=_;c(this,"followModal");c(this,"following",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"searchFilters",[]);c(this,"bulkActions",[]);}ngOnInit(){this.initialize(),this.searchFilters=this.followService.buildFollowsListFilters(),this.bulkActions=[{label:"\u522A\u9664",handler:e=>this.removeFollowing(e)}];}getIdentifier(){return"FollowingListComponent";}openFollowModal(){this.followModal.openModal();}isInstanceFollowing(e){return e.following.name==="peertube";}buildFollowingName(e){return e.following.name+"@"+e.following.host;}removeFollowing(e){return pe(this,null,function*(){let t={count:e.length,entryName:this.buildFollowingName(e[0])},_=me("\u60A8\u771F\u7684\u60F3\u8981\u53D6\u6D88\u8FFD\u8E64 {count, plural, =1 {{entryName}?} other {{count} \u689D\u76EE\u55CE\uFF1F}}",t);(yield this.confirmService.confirm(_,"\u53D6\u6D88\u8FFD\u8E64"))!==!1&&this.followService.unfollow(e).subscribe({next:()=>{let g=me("\u60A8\u4E0D\u518D\u8FFD\u8E64 {count, plural, =1 {{entryName} \u4E86\u3002} other {\u9019\u4E9B {count} \u689D\u76EE\u4E86\u3002}}",t);this.notifier.success(g),this.reloadData();},error:g=>this.notifier.error(g.message)});});}reloadDataInternal(){this.followService.getFollowing({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>{this.following=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}};c($o,"\u0275fac",function(t){return new(t||$o)(T(K),T(xe),T(Pn));}),c($o,"\u0275cmp",h({type:$o,selectors:[["ng-component"]],viewQuery:function(t,_){if(t&1&&gt(sm,5),t&2){let d;Ct(d=St())&&(_.followModal=d.first);}},standalone:!0,features:[ne,v],decls:11,vars:13,consts:()=>{let e;e="\u60A8\u7AD9\u53F0\u7684\u8A02\u95B1";let t;t="\u6279\u6B21\u52D5\u4F5C";let _;_="\u8FFD\u8E64";let d;d="\u9078\u53D6\u6240\u6709\u5217";let g;g="\u52D5\u4F5C";let O;O="\u6B63\u5728\u8FFD\u8E64";let R;R="\u9673\u8FF0 "+"\uFFFD#9\uFFFD"+""+"\uFFFD/#9\uFFFD"+"";let N;N="\u5EFA\u7ACB "+"\uFFFD#12\uFFFD"+""+"\uFFFD/#12\uFFFD"+"";let b;b="\u5141\u8A31\u5197\u9918 "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let G;G="\u9078\u53D6\u6B64\u5217";let F;F="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u7AD9\u81FA";let L;L="\u5DF2\u63A5\u53D7";let $;$="\u64F1\u7F6E\u4E2D";let H;H="\u5DF2\u56DE\u7D55";let z;z="\u6C92\u6709\u4E3B\u6A5F\u7B26\u5408\u76EE\u524D\u7684\u904E\u6FFE\u5668\u3002";let V;return V="\u60A8\u7684\u7AD9\u81FA\u4E26\u672A\u8FFD\u8E64\u4EFB\u4F55\u4EBA\u3002",[["followModal",""],e,_,g,O,R,N,b,L,$,H,z,V,["iconName","following","aria-hidden","true"],[3,"onLazyLoad","selectionChange","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate","selection"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"caption"],[1,"left-buttons"],["label",t,"theme","orange",3,"actions","entry",4,"ngIf"],["class","peertube-create-button",3,"click",4,"ngIf"],[1,"ms-auto"],[3,"search","filters"],["label",t,"theme","orange",3,"actions","entry"],[1,"peertube-create-button",3,"click"],["scope","col",2,"width","40px"],["ariaLabel",d],["scope","col",2,"width","150px"],["scope","col"],["scope","col","pSortableColumn","state",2,"width","100px"],["field","state"],["scope","col","pSortableColumn","createdAt",2,"width","150px"],["field","createdAt"],["scope","col","pSortableColumn","redundancyAllowed",2,"width","160px"],["field","redundancyAllowed"],["pSelectableRow","follow"],[1,"checkbox-cell"],["ariaLabel",G,3,"value"],[1,"action-cell"],["label","",3,"click"],["title",F,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["class","pt-badge badge-green",4,"ngIf"],["class","pt-badge badge-yellow",4,"ngIf"],["class","pt-badge badge-red",4,"ngIf"],[3,"host","redundancyAllowed",4,"ngIf"],[1,"pt-badge","badge-green"],[1,"pt-badge","badge-yellow"],[1,"pt-badge","badge-red"],[3,"host","redundancyAllowed"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1"),m(1,"my-global-icon",13),S(2),s(3,1),E(),o(),i(4,"p-table",14),M("onLazyLoad",function(O){return P(d),A(_.loadLazy(O));}),Oe("selectionChange",function(O){return P(d),Ie(_.selectedRows,O)||(_.selectedRows=O),A(O);}),u(5,pm,6,3,"ng-template",15)(6,mm,16,0,"ng-template",16)(7,Em,18,11,"ng-template",17)(8,Om,5,2,"ng-template",18),o(),m(9,"my-follow-modal",null,0);}t&2&&(a(4),l("value",_.following)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate()),Te("selection",_.selectedRows));},dependencies:[de,ve,be,Ae,Fe,tn,he,Lt,$t,Re,B,tt,nt,fn,lr,Ue,_r,ye],styles:["a[_ngcontent-%COMP%]{display:inline-block}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none!important}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:80%;color:var(--inputPlaceholderColor)}my-delete-button[_ngcontent-%COMP%]{max-width:130px}"]}));var sr=$o;var xo=class xo{constructor(){c(this,"redundancyElement");}};c(xo,"\u0275fac",function(e){return new(e||xo)();}),c(xo,"\u0275cmp",h({type:xo,selectors:[["my-video-redundancy-information"]],inputs:{redundancyElement:"redundancyElement"},standalone:!0,features:[v],decls:23,vars:14,consts:[[1,"label"],["target","_blank","rel","noopener noreferrer",3,"href"]],template:function(e,t){e&1&&(i(0,"div")(1,"span",0),C(2,"Url"),o(),i(3,"a",1),C(4),o()(),i(5,"div")(6,"span",0),C(7,"Created on"),o(),i(8,"span"),C(9),ie(10,"date"),o()(),i(11,"div")(12,"span",0),C(13,"Expires on"),o(),i(14,"span"),C(15),ie(16,"date"),o()(),i(17,"div")(18,"span",0),C(19,"Size"),o(),i(20,"span"),C(21),ie(22,"bytes"),o()()),e&2&&(a(3),l("href",t.redundancyElement.fileUrl,Xe),a(),I(t.redundancyElement.fileUrl),a(5),I(_e(10,5,t.redundancyElement.createdAt,"medium")),a(6),I(_e(16,8,t.redundancyElement.expiresOn,"medium")),a(6),I(_e(22,11,t.redundancyElement.size,1)));},dependencies:[ye,Tt],styles:[".label[_ngcontent-%COMP%]{display:inline-block;min-width:100px;font-weight:600}"]}));var cr=xo;function Nm(n,r){n&1&&(i(0,"th",34),s(1,7),o());}function Mm(n,r){n&1&&(i(0,"th",35),s(1,8),o());}function fm(n,r){if(n&1&&(i(0,"tr")(1,"th",27)(2,"span",28),s(3,4),o()(),i(4,"th",29),s(5,5),o(),u(6,Nm,2,0,"th",30),i(7,"th",31),D(8,6),m(9,"p-sortIcon",32),y(),o(),u(10,Mm,2,0,"th",33),o()),n&2){let e=p();a(6),l("ngIf",e.isDisplayingRemoteVideos()),a(),l("ngbTooltip",e.sortTooltip),a(3),l("ngIf",e.isDisplayingRemoteVideos());}}function Pm(n,r){if(n&1&&(i(0,"td"),C(1),o()),n&2){let e=p().$implicit,t=p();a(),I(t.getRedundancyStrategy(e));}}function Am(n,r){if(n&1&&(i(0,"td"),C(1),ie(2,"bytes"),o()),n&2){let e=p().$implicit,t=p();a(),I(_e(2,1,t.getTotalSize(e),1));}}function Rm(n,r){if(n&1){let e=k();i(0,"tr")(1,"td",36),m(2,"my-table-expander-icon",37),o(),i(3,"td",38)(4,"my-delete-button",39),M("click",function(){let _=P(e).$implicit,d=p();return A(d.removeRedundancy(_));}),o()(),u(5,Pm,2,1,"td",40),i(6,"td")(7,"a",41),C(8),m(9,"my-global-icon",42),o()(),u(10,Am,3,4,"td",40),o();}if(n&2){let e=r.expanded,t=r.$implicit,_=p();a(2),l("pRowToggler",t)("expanded",e),a(3),l("ngIf",_.isDisplayingRemoteVideos()),a(2),l("href",t.url,Xe),a(),w(" ",t.name," "),a(2),l("ngIf",_.isDisplayingRemoteVideos());}}function bm(n,r){if(n&1&&(i(0,"div",45),m(1,"my-video-redundancy-information",46),o()),n&2){let e=r.$implicit;a(),l("redundancyElement",e);}}function Fm(n,r){if(n&1&&(i(0,"tr")(1,"td",43),u(2,bm,2,1,"div",44),o()()),n&2){let e=p().$implicit;a(2),l("ngForOf",e.redundancies.files);}}function hm(n,r){if(n&1&&(i(0,"div"),m(1,"my-video-redundancy-information",46),o()),n&2){let e=r.$implicit;a(),l("redundancyElement",e);}}function vm(n,r){if(n&1&&(i(0,"tr")(1,"td",43),u(2,hm,2,1,"div",47),o()()),n&2){let e=p().$implicit;a(2),l("ngForOf",e.redundancies.streamingPlaylists);}}function Dm(n,r){if(n&1&&u(0,Fm,3,1,"tr",40)(1,vm,3,1,"tr",40),n&2){let e=r.$implicit;l("ngIf",e.redundancies.files.length!==0),a(),l("ngIf",e.redundancies.streamingPlaylists.length!==0);}}function ym(n,r){n&1&&(S(0),s(1,9),E());}function Lm(n,r){n&1&&(S(0),s(1,10),E());}function $m(n,r){if(n&1&&(i(0,"tr")(1,"td",48)(2,"div",49),u(3,ym,2,0,"ng-container",40)(4,Lm,2,0,"ng-container",40),o()()()),n&2){let e=p();a(3),l("ngIf",e.isDisplayingRemoteVideos()),a(),l("ngIf",!e.isDisplayingRemoteVideos());}}function xm(n,r){n&1&&(i(0,"div",49),s(1,12),o());}function Gm(n,r){if(n&1&&(i(0,"div",54),m(1,"p-chart",55),o()),n&2){let e=r.$implicit;a(),l("data",e.graphData)("options",e.options);}}function Um(n,r){if(n&1&&(i(0,"div",50)(1,"h6"),s(2,11),o(),i(3,"div",51),u(4,xm,2,0,"div",52)(5,Gm,2,2,"div",53),o()()),n&2){let e=p();a(4),l("ngIf",e.noRedundancies),a(),l("ngForOf",e.redundanciesGraphsData);}}var pn=class pn extends ze{constructor(e,t,_,d){super();this.notifier=e;this.confirmService=t;this.redundancyService=_;this.serverService=d;c(this,"videoRedundancies",[]);c(this,"totalRecords",0);c(this,"sort",{field:"name",order:1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"displayType","my-videos");c(this,"redundanciesGraphsData",[]);c(this,"noRedundancies",!1);c(this,"dataLoaded",!1);c(this,"bytesPipe");this.bytesPipe=new Tt();}getIdentifier(){return"VideoRedundanciesListComponent";}ngOnInit(){this.loadSelectLocalStorage(),this.initialize(),this.serverService.getServerStats().subscribe(e=>{let t=e.videosRedundancy;t.length===0&&(this.noRedundancies=!0);for(let _ of t)this.buildPieData(_);});}isDisplayingRemoteVideos(){return this.displayType==="remote-videos";}getTotalSize(e){return e.redundancies.files.reduce((t,_)=>t+_.size,0)+e.redundancies.streamingPlaylists.reduce((t,_)=>t+_.size,0);}onDisplayTypeChanged(){this.pagination.start=0,this.saveSelectLocalStorage(),this.reloadData();}getRedundancyStrategy(e){return e.redundancies.files.length!==0?e.redundancies.files[0].strategy:e.redundancies.streamingPlaylists.length!==0?e.redundancies.streamingPlaylists[0].strategy:"";}buildPieData(e){if(e.totalSize===0)return;let t=e.totalSize?e.totalSize-e.totalUsed:null,_=["\u5DF2\u4F7F\u7528 ("+this.bytesToHuman(e.totalUsed)+")"],d=[e.totalUsed];t&&(_.push("\u53EF\u7528 ("+this.bytesToHuman(t)+")"),d.push(t)),this.redundanciesGraphsData.push({stats:e,graphData:{labels:_,datasets:[{data:d,backgroundColor:["#FF6384","#36A2EB"],hoverBackgroundColor:["#FF6384","#36A2EB"]}]},options:{plugins:{title:{display:!0,text:e.strategy},tooltip:{callbacks:{label:g=>g.label}}}}});}removeRedundancy(e){return pe(this,null,function*(){let t="\u60A8\u771F\u7684\u60F3\u8981\u79FB\u9664\u6B64\u91CD\u8907\u5F71\u7247\u55CE\uFF1F";(yield this.confirmService.confirm(t,"\u79FB\u9664\u5197\u9918"))!==!1&&this.redundancyService.removeVideoRedundancies(e).subscribe({next:()=>{this.notifier.success("\u91CD\u8907\u5F71\u7247\u5DF2\u522A\u9664\uFF01"),this.reloadData();},error:d=>this.notifier.error(d.message)});});}reloadDataInternal(){this.dataLoaded=!1;let e={pagination:this.pagination,sort:this.sort,target:this.displayType};this.redundancyService.listVideoRedundancies(e).subscribe({next:t=>{this.videoRedundancies=t.data,this.totalRecords=t.total,this.dataLoaded=!0;},error:t=>this.notifier.error(t.message)});}loadSelectLocalStorage(){let e=In.getItem(pn.LOCAL_STORAGE_DISPLAY_TYPE);e&&(this.displayType=e);}saveSelectLocalStorage(){In.setItem(pn.LOCAL_STORAGE_DISPLAY_TYPE,this.displayType);}bytesToHuman(e){return this.bytesPipe.transform(e,1);}};c(pn,"LOCAL_STORAGE_DISPLAY_TYPE","video-redundancies-list-display-type"),c(pn,"\u0275fac",function(t){return new(t||pn)(T(K),T(xe),T(hi),T(Ge));}),c(pn,"\u0275cmp",h({type:pn,selectors:[["my-video-redundancies-list"]],standalone:!0,features:[ne,v],decls:20,vars:12,consts:()=>{let e;e="\u91CD\u8907\u5F71\u7247";let t;t="\u986F\u793A";let _;_="\u6211\u7684\u5F71\u7247\u88AB\u9060\u7AEF\u7AD9\u81FA\u8907\u88FD\u4E86";let d;d="\u6211\u7684\u7AD9\u81FA\u8907\u88FD\u4E86\u9060\u7AEF\u5F71\u7247";let g;g="\u66F4\u591A\u8CC7\u8A0A";let O;O="\u52D5\u4F5C";let R;R="\u5F71\u7247 "+"\uFFFD#9\uFFFD"+""+"\uFFFD/#9\uFFFD"+"";let N;N="\u7B56\u7565";let b;b="\u7E3D\u5927\u5C0F";let G;G="\u5217\u51FA\u91CD\u8907";let F;F="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u5F71\u7247";let L;L="\u60A8\u7684\u7AD9\u81FA\u4E26\u672A\u93E1\u50CF\u4EFB\u4F55\u5F71\u7247\u3002";let $;$="\u60A8\u7684\u7AD9\u81FA\u6C92\u6709\u5DF2\u93E1\u50CF\u7684\u5F71\u7247\u3002";let H;H="\u7B56\u7565\u7D71\u8A08\u5DF2\u555F\u7528";let z;return z="\u60A8\u7684\u7AD9\u81FA\u672A\u555F\u7528\u5197\u9918\u7B56\u7565\u3002",[e,t,_,d,g,O,R,N,b,L,$,H,z,["iconName","videos","aria-hidden","true"],[1,"admin-sub-header"],[1,"select-filter-block"],["for","displayType"],[1,"peertube-select-container"],["id","displayType","name","displayType",1,"form-control",3,"ngModelChange","ngModel"],["value","my-videos"],["value","remote-videos"],["dataKey","id",3,"onLazyLoad","value","lazy","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","expandedRowKeys"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["class","redundancies-charts",4,"ngIf"],["scope","col",2,"width","40px"],[1,"visually-hidden"],["scope","col",2,"width","150px"],["scope","col","style","width: 160px;",4,"ngIf"],["scope","col","container","body","pSortableColumn","name",3,"ngbTooltip"],["field","name"],["scope","col","style","width: 100px;",4,"ngIf"],["scope","col",2,"width","160px"],["scope","col",2,"width","100px"],[1,"expand-cell"],["tooltip",G,3,"pRowToggler","expanded"],[1,"action-cell"],["label","",3,"click"],[4,"ngIf"],["title",F,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["myAutoColspan","",1,"expand-cell"],["class","expansion-block",4,"ngFor","ngForOf"],[1,"expansion-block"],[3,"redundancyElement"],[4,"ngFor","ngForOf"],["myAutoColspan",""],[1,"no-results"],[1,"redundancies-charts"],[1,"chart-blocks"],["class","no-results",4,"ngIf"],["class","chart-block",4,"ngFor","ngForOf"],[1,"chart-block"],["type","pie","width","300px","height","300px",3,"data","options"]];},template:function(t,_){t&1&&(i(0,"h1"),m(1,"my-global-icon",13),S(2),s(3,0),E(),o(),i(4,"div",14)(5,"div",15)(6,"label",16),s(7,1),o(),i(8,"div",17)(9,"select",18),Oe("ngModelChange",function(g){return Ie(_.displayType,g)||(_.displayType=g),g;}),M("ngModelChange",function(){return _.onDisplayTypeChanged();}),i(10,"option",19),s(11,2),o(),i(12,"option",20),s(13,3),o()()()()(),i(14,"p-table",21),M("onLazyLoad",function(g){return _.loadLazy(g);}),u(15,fm,11,3,"ng-template",22)(16,Rm,11,6,"ng-template",23)(17,Dm,2,2,"ng-template",24)(18,$m,5,2,"ng-template",25),o(),u(19,Um,6,2,"div",26)),t&2&&(a(9),Te("ngModel",_.displayType),a(5),l("value",_.videoRedundancies)("lazy",!0)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("expandedRowKeys",_.expandedRows),a(5),l("ngIf",_.isDisplayingRemoteVideos()&&_.dataLoaded));},dependencies:[de,ce,Ft,ht,bt,Se,At,ve,be,Ae,Fe,ft,he,Re,B,$e,Mt,fn,Ue,Ne,cr,el,Z_,Tt],styles:['a[_ngcontent-%COMP%]{display:inline-block}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none!important}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:80%;color:var(--inputPlaceholderColor)}.expansion-block[_ngcontent-%COMP%]{margin-bottom:20px}.admin-sub-header[_ngcontent-%COMP%]{justify-content:flex-end}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]:not(:last-child){margin-inline-end:.625rem}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:2px}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:auto;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: auto){.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:100%}}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.admin-sub-header[_ngcontent-%COMP%]   .select-filter-block[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}.redundancies-charts[_ngcontent-%COMP%]{margin-top:50px}.redundancies-charts[_ngcontent-%COMP%]   .chart-blocks[_ngcontent-%COMP%]{display:flex;justify-content:center}.redundancies-charts[_ngcontent-%COMP%]   .chart-blocks[_ngcontent-%COMP%]   .chart-block[_ngcontent-%COMP%]{margin:0 20px}']}));var dr=pn;var yl=[{path:"follows",canActivate:[De],data:{userRight:Q.MANAGE_SERVER_FOLLOW},children:[{path:"",redirectTo:"following-list",pathMatch:"full"},{path:"following-list",component:sr,data:{meta:{title:"\u6B63\u5728\u8FFD\u8E64"}}},{path:"followers-list",component:ar,data:{meta:{title:"\u8FFD\u8E64\u8005"}}},{path:"following-add",redirectTo:"following-list"},{path:"video-redundancies-list",component:dr,data:{meta:{title:"\u5197\u9918"}}}]}];var Go=class Go{constructor(){c(this,"syndicationItems",[{format:bn.RSS,label:"media rss 2.0",url:Kn.BASE_FEEDS_URL+bn.RSS.toLowerCase()},{format:bn.ATOM,label:"atom 1.0",url:Kn.BASE_FEEDS_URL+bn.ATOM.toLowerCase()},{format:bn.JSON,label:"json 1.0",url:Kn.BASE_FEEDS_URL+bn.JSON.toLowerCase()}]);}};c(Go,"\u0275fac",function(e){return new(e||Go)();}),c(Go,"\u0275cmp",h({type:Go,selectors:[["my-video-comment-list"]],standalone:!0,features:[v],decls:8,vars:1,consts:()=>{let r;r="\u5F71\u7247\u7559\u8A00";let e;return e="\u6B64\u6AA2\u8996\u4E5F\u6703\u986F\u793A\u4F86\u81EA\u975C\u97F3\u5E33\u865F\u7684\u7559\u8A00\u3002",[r,e,["iconName","message-circle","aria-hidden","true"],[3,"syndicationItems"],["mode","admin"]];},template:function(e,t){e&1&&(i(0,"h1"),m(1,"my-global-icon",2),S(2),s(3,0),E(),m(4,"my-feed",3),o(),i(5,"em"),s(6,1),o(),m(7,"my-video-comment-list-admin-owner",4)),e&2&&(a(4),l("syndicationItems",t.syndicationItems));},dependencies:[de,tl,ol],styles:["my-feed[_ngcontent-%COMP%]{display:inline-block;width:15px;margin-inline-start:.3125rem}"]}));var pr=Go;var Ll=[{path:"comments",canActivate:[De],data:{userRight:Q.SEE_ALL_COMMENTS},children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:pr,data:{meta:{title:"\u7559\u8A00\u6E05\u55AE"}}}]}];var xn=class xn extends yt{constructor(){super(...arguments);c(this,"videoQuotaOptions",[]);c(this,"videoQuotaDailyOptions",[]);c(this,"username");c(this,"user");c(this,"roles",[]);c(this,"serverConfig");}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig(),this.buildRoles();}get subscribersCount(){let e=this.user?this.user.account.followersCount:0,t=this.user?this.user.videoChannels.map(_=>_.followersCount).reduce((_,d)=>_+d,0):0;return e+t;}getAuthPlugins(){return this.serverConfig.plugin.registeredIdAndPassAuths.map(e=>e.npmName).concat(this.serverConfig.plugin.registeredExternalAuths.map(e=>e.npmName));}buildRoles(){let e=this.auth.getUser();this.serverService.getServerLocale().subscribe(t=>{if(e.role.id===Wt.ADMINISTRATOR){this.roles=Object.entries(Ir).map(([_,d])=>({value:_.toString(),label:ti(d,t)}));return;}this.roles=[{value:Wt.USER.toString(),label:ti(Ir[Wt.USER],t)}];});}displayDangerZone(){return!(this.isCreation()||!this.user||this.user.pluginAuth||this.auth.getUser().id===this.user.id);}resetPassword(){}disableTwoFactorAuth(){}getUserVideoQuota(){return this.form.value.videoQuota;}buildAdminFlags(e){return e.byPassAutoBlock?Zo.BYPASS_VIDEO_AUTO_BLACKLIST:Zo.NONE;}buildQuotaOptions(){this.videoQuotaOptions=this.configService.videoQuotaOptions,this.videoQuotaDailyOptions=this.configService.videoQuotaDailyOptions;}};c(xn,"\u0275fac",(()=>{let e;return function(_){return(e||(e=Vn(xn)))(_||xn);};})()),c(xn,"\u0275dir",Ua({type:xn,features:[ne]}));var Uo=xn;var wm=n=>({"input-error":n});function Vm(n,r){n&1&&(S(0),s(1,0),E());}function km(n,r){n&1&&(S(0),s(1,1),E());}function zm(n,r){if(n&1&&(i(0,"div",9),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.password," ");}}var wo=class wo extends yt{constructor(e,t,_){super();this.formReactiveService=e;this.notifier=t;this.userAdminService=_;c(this,"userId");c(this,"username");c(this,"error");c(this,"showPassword",!1);}ngOnInit(){this.buildForm({password:Pi});}formValidated(){this.error=void 0;let e=this.form.value;this.userAdminService.updateUser(this.userId,e).subscribe({next:()=>this.notifier.success("\u5BC6\u78BC\u5DF2\u70BA\u4F7F\u7528\u8005 "+this.username+" \u66F4\u6539\u3002"),error:t=>{this.error=t.message;}});}togglePasswordVisibility(){this.showPassword=!this.showPassword;}getFormButtonTitle(){return"\u66F4\u65B0\u4F7F\u7528\u8005\u5BC6\u78BC";}};c(wo,"\u0275fac",function(t){return new(t||wo)(T(Nt),T(K),T(jt));}),c(wo,"\u0275cmp",h({type:wo,selectors:[["my-user-password"]],inputs:{userId:"userId",username:"username"},standalone:!0,features:[ne,v],decls:8,vars:10,consts:()=>{let e;e="\u986F\u793A";let t;return t="\u96B1\u85CF",[e,t,["role","form",3,"ngSubmit","formGroup"],[1,"input-group"],["id","password","formControlName","password","autocomplete","new-password",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[4,"ngIf"],["class","form-error","role","alert",4,"ngIf"],["type","submit",3,"value","disabled"],["role","alert",1,"form-error"]];},template:function(t,_){t&1&&(i(0,"form",2),M("ngSubmit",function(){return _.formValidated();}),i(1,"div",3),m(2,"input",4),i(3,"button",5),M("click",function(){return _.togglePasswordVisibility();}),u(4,Vm,2,0,"ng-container",6)(5,km,2,0,"ng-container",6),o()(),u(6,zm,2,1,"div",7),m(7,"input",8),o()),t&2&&(l("formGroup",_.form),a(2),l("ngClass",X(8,wm,_.formErrors.password)),It("type",_.showPassword?"text":"password"),a(2),l("ngIf",!_.showPassword),a(),l("ngIf",!!_.showPassword),a(),l("ngIf",_.formErrors.password),a(),qt("value",_.getFormButtonTitle()),l("disabled",!_.form.valid));},dependencies:[ce,Ot,Ve,Se,Me,Pe,fe,ke,le,B],styles:["input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder, input[type=password][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%], input[type=password][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{margin-top:10px;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;background-color:#d56253;color:#fff6f5}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #d562530d}input[type=submit][_ngcontent-%COMP%]:hover, input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{background-color:#df877c}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff6f5}input[type=submit][_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}"]}));var Vo=wo;var Fr=n=>({"input-error":n}),Xm=n=>["/a",n],$l=()=>["/admin/moderation/abuses/list"],xl=n=>({search:n});function Bm(n,r){n&1&&(i(0,"li",32),s(1,7),o());}function Wm(n,r){if(n&1&&(i(0,"a",65),C(1),o()),n&2){let e=p(2);l("routerLink",X(2,Xm,e.user==null?null:e.user.username)),a(),I(e.user==null?null:e.user.username);}}function jm(n,r){if(n&1&&(i(0,"li",32),s(1,8),o(),i(2,"li",63),u(3,Wm,2,4,"a",64),o()),n&2){let e=p();a(3),l("ngIf",e.user);}}function Hm(n,r){if(n&1&&(i(0,"div",67)(1,"div")(2,"a")(3,"div",68),C(4),ie(5,"bytes"),o(),i(6,"div",69),s(7,9),o()()(),i(8,"div")(9,"a")(10,"div",68),C(11),o(),i(12,"div",69),s(13,10),o()()(),i(14,"div")(15,"a")(16,"div",68),C(17),o(),i(18,"div",69),s(19,11),o()()(),i(20,"div")(21,"a",70)(22,"div",68),C(23),o(),i(24,"div",69),s(25,12),o()()(),i(26,"div")(27,"a",70)(28,"div",68),C(29),o(),i(30,"div",69),s(31,13),o()()(),i(32,"div")(33,"a")(34,"div",68),C(35),o(),i(36,"div",69),s(37,14),o()()()()),n&2){let e=p(2);a(4),_n("",e.user.videosCount," (",_e(5,16,e.user.videoQuotaUsed,0),")"),a(3),W(e.user.videosCount),j(7),a(4),I(e.user.videoChannels.length||0),a(2),W(e.user.videoChannels.length),j(13),a(4),I(e.subscribersCount),a(2),W(e.subscribersCount),j(19),a(2),l("routerLink",Pt(19,$l))("queryParams",X(20,xl,'reportee:"'+(e.user==null?null:e.user.account.displayName)+'"')),a(2),I(e.user.abusesCount),a(4),l("routerLink",Pt(22,$l))("queryParams",X(23,xl,'reporter:"'+(e.user==null?null:e.user.account.displayName)+'" state:accepted')),a(2),_n("",e.user.abusesAcceptedCount," / ",e.user.abusesCreatedCount,""),a(6),I(e.user.videoCommentsCount),a(2),W(e.user.videoCommentsCount),j(37);}}function Jm(n,r){if(n&1&&u(0,Hm,38,25,"div",66),n&2){let e=p();l("ngIf",!e.isCreation()&&e.user);}}function Km(n,r){if(n&1&&(i(0,"div",71),C(1),o()),n&2){let e=p();a(),I(e.error);}}function Ym(n,r){}function qm(n,r){n&1&&u(0,Ym,0,0,"ng-template");}function Qm(n,r){n&1&&(i(0,"h2"),s(1,15),o());}function Zm(n,r){if(n&1&&(i(0,"h2",72),C(1),o(),m(2,"my-actor-avatar-edit",73)),n&2){let e=p();a(),w("EDIT USER ",e.user.username,""),a(),l("displayName",e.user.account.displayName)("avatars",e.user.account.avatars)("username",e.user.username);}}function eu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.username," ");}}function tu(n,r){if(n&1&&(i(0,"div",45)(1,"label",74),s(2,16),o(),m(3,"input",75),u(4,eu,2,1,"div",48),o()),n&2){let e=p();a(3),l("ngClass",X(2,Fr,e.formErrors.username)),a(),l("ngIf",e.formErrors.username);}}function nu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.channelName," ");}}function ou(n,r){if(n&1&&(i(0,"div",45)(1,"label",77),s(2,17),o(),m(3,"input",78),u(4,nu,2,1,"div",48),o()),n&2){let e=p();a(3),l("ngClass",X(2,Fr,e.formErrors.channelName)),a(),l("ngIf",e.formErrors.channelName);}}function iu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.email," ");}}function ru(n,r){n&1&&(S(0),s(1,19),E());}function au(n,r){n&1&&(i(0,"my-help"),u(1,ru,2,0,"ng-template",82),o());}function _u(n,r){if(n&1&&(i(0,"div",45)(1,"label",79),s(2,18),o(),u(3,au,2,0,"my-help",80),m(4,"my-input-text",81),o()),n&2){let e=p();a(3),l("ngIf",e.isPasswordOptional()),a(),l("formError",e.formErrors.password);}}function lu(n,r){if(n&1&&(i(0,"option",83),C(1),o()),n&2){let e=r.$implicit;l("value",e.value),a(),w(" ",e.label," ");}}function su(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.role," ");}}function cu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.videoQuota," ");}}function du(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.videoQuotaDaily," ");}}function pu(n,r){if(n&1&&(i(0,"option",83),C(1),o()),n&2){let e=r.$implicit;l("value",e),a(),I(e);}}function mu(n,r){if(n&1&&(i(0,"div",45)(1,"label",84),s(2,20),o(),i(3,"div",50)(4,"select",85)(5,"option",83),s(6,21),o(),u(7,pu,2,2,"option",52),o()()()),n&2){let e=p();a(5),l("value",null),a(2),l("ngForOf",e.getAuthPlugins());}}function uu(n,r){}function gu(n,r){n&1&&u(0,uu,0,0,"ng-template");}function Cu(n,r){if(n&1){let e=k();i(0,"div",45)(1,"div",90),s(2,26),o(),i(3,"button",91),M("click",function(){P(e);let _=p(2);return A(_.disableTwoFactorAuth());}),s(4,27),o()();}}function Su(n,r){if(n&1){let e=k();i(0,"div",86)(1,"div",39),m(2,"div",87),i(3,"h2",88),s(4,22),o()(),i(5,"div",41)(6,"div",89)(7,"div",45)(8,"div",90),s(9,23),o(),i(10,"button",91),M("click",function(){P(e);let _=p();return A(_.resetPassword());}),s(11,24),o()(),i(12,"div",45)(13,"div",90),s(14,25),o(),m(15,"my-user-password",92),o(),u(16,Cu,5,0,"div",44),o()()();}if(n&2){let e=p();a(15),l("userId",e.user.id)("username",e.user.username),a(),l("ngIf",e.user.twoFactorEnabled);}}var ko=class ko extends Uo{constructor(e,t,_,d,g,O,R,N){super();this.serverService=e;this.formReactiveService=t;this.configService=_;this.screenService=d;this.auth=g;this.router=O;this.notifier=R;this.userAdminService=N;c(this,"error");this.buildQuotaOptions();}ngOnInit(){super.ngOnInit();let e={role:Wt.USER.toString(),videoQuota:-1,videoQuotaDaily:-1};this.buildForm({username:b_,channelName:F_,email:fi,password:this.isPasswordOptional()?h_:Pi,role:Ai,videoQuota:Xn,videoQuotaDaily:Bn,byPassAutoBlock:null},e);}formValidated(){this.error=void 0;let e=this.form.value;e.adminFlags=this.buildAdminFlags(this.form.value),e.videoQuota=parseInt(this.form.value.videoQuota,10),e.videoQuotaDaily=parseInt(this.form.value.videoQuotaDaily,10),this.userAdminService.addUser(e).subscribe({next:()=>{this.notifier.success("\u4F7F\u7528\u8005 "+e.username+" \u5DF2\u5EFA\u7ACB\u3002"),this.router.navigate(["/admin/users/list"]);},error:t=>{this.error=t.message;}});}isCreation(){return!0;}isPasswordOptional(){return this.serverConfig.email.enabled;}getFormButtonTitle(){return"\u5EFA\u7ACB\u4F7F\u7528\u8005";}};c(ko,"\u0275fac",function(t){return new(t||ko)(T(Ge),T(Nt),T(pt),T(zn),T(Zt),T(Ze),T(K),T(jt));}),c(ko,"\u0275cmp",h({type:ko,selectors:[["my-user-create"]],standalone:!0,features:[ne,v],decls:57,vars:27,consts:()=>{let e;e="mail@example.com";let t;t="\u4F4D\u5143\u7D44";let _;_="\u4F4D\u5143\u7D44";let d;d="\u4F7F\u7528\u8005\u7565\u904E\u8ABF\u89E3\u54E1\u7684\u5F71\u7247\u9A57\u8B49";let g;g="\u4F7F\u7528\u8005";let O;O="\u96FB\u5B50\u90F5\u4EF6";let R;R="\u89D2\u8272";let N;N="\u5F71\u7247\u914D\u984D";let b;b="\u6BCF\u65E5\u5F71\u7247\u914D\u984D";let G;G="\u5982\u679C\u6B64\u4F7F\u7528\u8005\u4E0D\u9700\u8981\u8ABF\u89E3\u54E1\u5BE9\u95B1\u5176\u5F71\u7247\uFF0C\u8ACB\u555F\u7528\u6B64\u6838\u53D6\u65B9\u584A\u3002";let F;F="\u5EFA\u7ACB";let L;L="\u7DE8\u8F2F";let $;$="{VAR_PLURAL, plural, =1 {\u5F71\u7247} other {\u5F71\u7247}}",$=Ce($,{VAR_PLURAL:"\uFFFD0\uFFFD"});let H;H="{VAR_PLURAL, plural, =1 {\u983B\u9053} other {\u983B\u9053}}",H=Ce(H,{VAR_PLURAL:"\uFFFD0\uFFFD"});let z;z="{VAR_PLURAL, plural, =1 {\u8A02\u95B1\u8005} other {\u8A02\u95B1\u8005}}",z=Ce(z,{VAR_PLURAL:"\uFFFD0\uFFFD"});let V;V="\u5217\u5165\u6AA2\u8209";let x;x="\u63A5\u53D7\u64B0\u5BEB\u7684\u6AA2\u8209";let Y;Y="{VAR_PLURAL, plural, =1 {\u7559\u8A00} other {\u7559\u8A00}}",Y=Ce(Y,{VAR_PLURAL:"\uFFFD0\uFFFD"});let oe;oe="\u65B0\u4F7F\u7528\u8005";let we;we="john";let ae;ae="\u4F7F\u7528\u8005\u540D\u7A31";let Be;Be="john_channel";let We;We="\u983B\u9053\u540D\u7A31";let je;je="\u5BC6\u78BC";let He;He="\u5982\u679C\u60A8\u5C07\u5BC6\u78BC\u7559\u7A7A\uFF0C\u5C31\u6703\u50B3\u9001\u96FB\u5B50\u90F5\u4EF6\u7D66\u4F7F\u7528\u8005\u3002";let Je;Je="\u9A57\u8B49\u5916\u639B\u7A0B\u5F0F";let Z;Z="\u7121\uFF08\u672C\u6A5F\u9A57\u8B49\uFF09";let it;it="\u5371\u96AA\u5340";let Ye;Ye="\u900F\u904E\u96FB\u5B50\u90F5\u4EF6\u50B3\u9001\u91CD\u8A2D\u5BC6\u78BC\u9023\u7D50\u7D66\u4F7F\u7528\u8005";let rt;rt="\u8981\u6C42\u65B0\u5BC6\u78BC";let at;at="\u624B\u52D5\u8A2D\u5B9A\u4F7F\u7528\u8005\u5BC6\u78BC";let Ke;Ke="\u6B64\u4F7F\u7528\u8005\u5DF2\u555F\u7528\u5169\u6B65\u9A5F\u9A57\u8B49";let q;return q="\u505C\u7528\u5169\u6B65\u9A5F\u9A57\u8B49",[["dashboard",""],g,O,R,N,b,G,F,L,$,H,z,V,x,Y,oe,ae,We,je,He,Je,Z,it,Ye,rt,at,Ke,q,["aria-label","breadcrumb"],[1,"pt-breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/users"],[1,"breadcrumb-item","active"],["class","alert alert-danger",4,"ngIf"],[1,"pt-two-cols","d-xxl-none"],[1,"col-0","col-xl-3"],[1,"col-12","col-xl-9"],[4,"ngTemplateOutlet"],[1,"pt-two-cols","mt-4"],[1,"title-col"],["id","user",1,"anchor"],[1,"content-col"],[1,"row"],["role","form",1,"col",3,"ngSubmit","formGroup"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","email"],["type","text","id","email","placeholder",e,"formControlName","email","autocomplete","off",1,"form-control",3,"ngClass","readonly"],["class","form-error","role","alert",4,"ngIf"],["for","role"],[1,"peertube-select-container"],["id","role","formControlName","role",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["for","videoQuota"],["id","videoQuota","formControlName","videoQuota","inputSuffix",t,"inputType","number",3,"items","clearable"],[3,"videoQuota"],["for","videoQuotaDaily"],["id","videoQuotaDaily","formControlName","videoQuotaDaily","inputSuffix",_,"inputType","number",3,"items","clearable"],["inputName","byPassAutoBlock","formControlName","byPassAutoBlock","labelText",d],["ngProjectAs","description",5,["description"]],["type","submit",1,"peertube-button","orange-button",3,"value","disabled"],[1,"d-none","d-xxl-block","col-7"],["class","pt-two-cols mt-5",4,"ngIf"],["aria-current","page",1,"breadcrumb-item","active"],[3,"routerLink",4,"ngIf"],[3,"routerLink"],["class","dashboard",4,"ngIf"],[1,"dashboard"],[1,"dashboard-num"],[1,"dashboard-label"],[3,"routerLink","queryParams"],[1,"alert","alert-danger"],[1,"visually-hidden"],["actorType","account","editable","false","displayUsername","false",3,"displayName","avatars","username"],["for","username"],["type","text","id","username","placeholder",we,"formControlName","username",1,"form-control",3,"ngClass"],["role","alert",1,"form-error"],["for","channelName"],["type","text","id","channelName","placeholder",Be,"formControlName","channelName",1,"form-control",3,"ngClass"],["for","password"],[4,"ngIf"],["formControlName","password","inputId","password","autocomplete","new-password",3,"formError"],["ptTemplate","customHtml"],[3,"value"],["for","pluginAuth"],["id","pluginAuth","formControlName","pluginAuth",1,"form-control"],[1,"pt-two-cols","mt-5"],["id","danger",1,"anchor"],[1,"pt-title-danger"],[1,"danger-zone"],[1,"mb-1","fw-bold"],[1,"peertube-button",3,"click"],[3,"userId","username"]];},template:function(t,_){if(t&1){let d=k();i(0,"nav",28)(1,"ol",29)(2,"li",30)(3,"a",31),s(4,1),o()(),u(5,Bm,2,0,"li",32)(6,jm,4,1),o()(),u(7,Jm,1,1,"ng-template",null,0,Sn)(9,Km,2,1,"div",33),i(10,"div",34),m(11,"div",35),i(12,"div",36),u(13,qm,1,0,null,37),o()(),i(14,"div",38)(15,"div",39),m(16,"div",40),u(17,Qm,2,0,"h2")(18,Zm,3,4),o(),i(19,"div",41)(20,"div",42)(21,"form",43),M("ngSubmit",function(){return P(d),A(_.formValidated());}),u(22,tu,5,4,"div",44)(23,ou,5,4,"div",44),i(24,"div",45)(25,"label",46),s(26,2),o(),m(27,"input",47),u(28,iu,2,1,"div",48),o(),u(29,_u,5,2,"div",44),i(30,"div",45)(31,"label",49),s(32,3),o(),i(33,"div",50)(34,"select",51),u(35,lu,2,2,"option",52),o()(),u(36,su,2,1,"div",48),o(),i(37,"div",45)(38,"label",53),s(39,4),o(),m(40,"my-select-custom-value",54)(41,"my-user-real-quota-info",55),u(42,cu,2,1,"div",48),o(),i(43,"div",45)(44,"label",56),s(45,5),o(),m(46,"my-select-custom-value",57),u(47,du,2,1,"div",48),o(),u(48,mu,8,2,"div",44),i(49,"div",45)(50,"my-peertube-checkbox",58),S(51,59),s(52,6),E(),o()(),m(53,"input",60),o(),i(54,"div",61),u(55,gu,1,0,null,37),o()()()(),u(56,Su,17,3,"div",62);}if(t&2){let d=Cn(8);a(5),Bt(_.isCreation()?5:6),a(4),l("ngIf",_.error),a(4),l("ngTemplateOutlet",d),a(4),Bt(_.isCreation()?17:_.user?18:-1),a(4),l("formGroup",_.form),a(),l("ngIf",_.isCreation()),a(),l("ngIf",_.isCreation()),a(4),l("ngClass",X(25,Fr,_.formErrors.email))("readonly",_.user&&_.user.pluginAuth!==null),a(),l("ngIf",_.formErrors.email),a(),l("ngIf",_.isCreation()),a(6),l("ngForOf",_.roles),a(),l("ngIf",_.formErrors.role),a(4),l("items",_.videoQuotaOptions)("clearable",!1),a(),l("videoQuota",_.getUserVideoQuota()),a(),l("ngIf",_.formErrors.videoQuota),a(4),l("items",_.videoQuotaDailyOptions)("clearable",!1),a(),l("ngIf",_.formErrors.videoQuotaDaily),a(),l("ngIf",!_.isCreation()&&_.getAuthPlugins().length!==0),a(5),qt("value",_.getFormButtonTitle()),l("disabled",!_.form.valid),a(2),l("ngTemplateOutlet",d),a(),l("ngIf",_.displayDangerZone());}},dependencies:[Le,B,_i,Jn,ce,Ot,Ft,ht,Ve,bt,Se,Me,Pe,fe,ke,le,en,Dt,Si,Ne,xt,An,et,Vo,Tt],styles:['input[_ngcontent-%COMP%]:not([type=submit]){font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[_ngcontent-%COMP%]:not([type=submit])::placeholder{color:var(--inputPlaceholderColor)}input[_ngcontent-%COMP%]:not([type=submit])[readonly]{opacity:.7}@media screen and (max-width: 380px){input[_ngcontent-%COMP%]:not([type=submit]){width:100%}}my-input-text[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-input-text[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-custom-value[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-custom-value[_ngcontent-%COMP%]{width:100%}}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#d56253;color:#fff6f5}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #d562530d}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .danger-zone[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .danger-zone[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#df877c}.danger-zone[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .danger-zone[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{cursor:default}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff6f5}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.dashboard[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:0 -5px;max-width:900px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;flex:0 0 33.3333333333%;padding:0 5px;margin-bottom:10px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none;color:inherit;display:block;font-size:18px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:active{text-decoration:none!important}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:active, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{opacity:.8}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%], .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:20px;background:var(--submenuBackgroundColor);border-radius:4px;box-sizing:border-box;height:100%}.dashboard[_ngcontent-%COMP%]   .dashboard-num[_ngcontent-%COMP%], .dashboard[_ngcontent-%COMP%]   .dashboard-text[_ngcontent-%COMP%]{text-align:center;font-size:130%;color:var(--mainForegroundColor);line-height:30px;margin-bottom:20px}.dashboard[_ngcontent-%COMP%]   .dashboard-label[_ngcontent-%COMP%]{font-size:90%;color:var(--inputPlaceholderColor);text-align:center}']}));var mr=ko;var hr=n=>({"input-error":n}),Eu=n=>["/a",n],Gl=()=>["/admin/moderation/abuses/list"],Ul=n=>({search:n});function Tu(n,r){n&1&&(i(0,"li",32),s(1,7),o());}function Iu(n,r){if(n&1&&(i(0,"a",65),C(1),o()),n&2){let e=p(2);l("routerLink",X(2,Eu,e.user==null?null:e.user.username)),a(),I(e.user==null?null:e.user.username);}}function Ou(n,r){if(n&1&&(i(0,"li",32),s(1,8),o(),i(2,"li",63),u(3,Iu,2,4,"a",64),o()),n&2){let e=p();a(3),l("ngIf",e.user);}}function Nu(n,r){if(n&1&&(i(0,"div",67)(1,"div")(2,"a")(3,"div",68),C(4),ie(5,"bytes"),o(),i(6,"div",69),s(7,9),o()()(),i(8,"div")(9,"a")(10,"div",68),C(11),o(),i(12,"div",69),s(13,10),o()()(),i(14,"div")(15,"a")(16,"div",68),C(17),o(),i(18,"div",69),s(19,11),o()()(),i(20,"div")(21,"a",70)(22,"div",68),C(23),o(),i(24,"div",69),s(25,12),o()()(),i(26,"div")(27,"a",70)(28,"div",68),C(29),o(),i(30,"div",69),s(31,13),o()()(),i(32,"div")(33,"a")(34,"div",68),C(35),o(),i(36,"div",69),s(37,14),o()()()()),n&2){let e=p(2);a(4),_n("",e.user.videosCount," (",_e(5,16,e.user.videoQuotaUsed,0),")"),a(3),W(e.user.videosCount),j(7),a(4),I(e.user.videoChannels.length||0),a(2),W(e.user.videoChannels.length),j(13),a(4),I(e.subscribersCount),a(2),W(e.subscribersCount),j(19),a(2),l("routerLink",Pt(19,Gl))("queryParams",X(20,Ul,'reportee:"'+(e.user==null?null:e.user.account.displayName)+'"')),a(2),I(e.user.abusesCount),a(4),l("routerLink",Pt(22,Gl))("queryParams",X(23,Ul,'reporter:"'+(e.user==null?null:e.user.account.displayName)+'" state:accepted')),a(2),_n("",e.user.abusesAcceptedCount," / ",e.user.abusesCreatedCount,""),a(6),I(e.user.videoCommentsCount),a(2),W(e.user.videoCommentsCount),j(37);}}function Mu(n,r){if(n&1&&u(0,Nu,38,25,"div",66),n&2){let e=p();l("ngIf",!e.isCreation()&&e.user);}}function fu(n,r){if(n&1&&(i(0,"div",71),C(1),o()),n&2){let e=p();a(),I(e.error);}}function Pu(n,r){}function Au(n,r){n&1&&u(0,Pu,0,0,"ng-template");}function Ru(n,r){n&1&&(i(0,"h2"),s(1,15),o());}function bu(n,r){if(n&1&&(i(0,"h2",72),C(1),o(),m(2,"my-actor-avatar-edit",73)),n&2){let e=p();a(),w("EDIT USER ",e.user.username,""),a(),l("displayName",e.user.account.displayName)("avatars",e.user.account.avatars)("username",e.user.username);}}function Fu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.username," ");}}function hu(n,r){if(n&1&&(i(0,"div",45)(1,"label",74),s(2,16),o(),m(3,"input",75),u(4,Fu,2,1,"div",48),o()),n&2){let e=p();a(3),l("ngClass",X(2,hr,e.formErrors.username)),a(),l("ngIf",e.formErrors.username);}}function vu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p(2);a(),w(" ",e.formErrors.channelName," ");}}function Du(n,r){if(n&1&&(i(0,"div",45)(1,"label",77),s(2,17),o(),m(3,"input",78),u(4,vu,2,1,"div",48),o()),n&2){let e=p();a(3),l("ngClass",X(2,hr,e.formErrors.channelName)),a(),l("ngIf",e.formErrors.channelName);}}function yu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.email," ");}}function Lu(n,r){n&1&&(S(0),s(1,19),E());}function $u(n,r){n&1&&(i(0,"my-help"),u(1,Lu,2,0,"ng-template",82),o());}function xu(n,r){if(n&1&&(i(0,"div",45)(1,"label",79),s(2,18),o(),u(3,$u,2,0,"my-help",80),m(4,"my-input-text",81),o()),n&2){let e=p();a(3),l("ngIf",e.isPasswordOptional()),a(),l("formError",e.formErrors.password);}}function Gu(n,r){if(n&1&&(i(0,"option",83),C(1),o()),n&2){let e=r.$implicit;l("value",e.value),a(),w(" ",e.label," ");}}function Uu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.role," ");}}function wu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.videoQuota," ");}}function Vu(n,r){if(n&1&&(i(0,"div",76),C(1),o()),n&2){let e=p();a(),w(" ",e.formErrors.videoQuotaDaily," ");}}function ku(n,r){if(n&1&&(i(0,"option",83),C(1),o()),n&2){let e=r.$implicit;l("value",e),a(),I(e);}}function zu(n,r){if(n&1&&(i(0,"div",45)(1,"label",84),s(2,20),o(),i(3,"div",50)(4,"select",85)(5,"option",83),s(6,21),o(),u(7,ku,2,2,"option",52),o()()()),n&2){let e=p();a(5),l("value",null),a(2),l("ngForOf",e.getAuthPlugins());}}function Xu(n,r){}function Bu(n,r){n&1&&u(0,Xu,0,0,"ng-template");}function Wu(n,r){if(n&1){let e=k();i(0,"div",45)(1,"div",90),s(2,26),o(),i(3,"button",91),M("click",function(){P(e);let _=p(2);return A(_.disableTwoFactorAuth());}),s(4,27),o()();}}function ju(n,r){if(n&1){let e=k();i(0,"div",86)(1,"div",39),m(2,"div",87),i(3,"h2",88),s(4,22),o()(),i(5,"div",41)(6,"div",89)(7,"div",45)(8,"div",90),s(9,23),o(),i(10,"button",91),M("click",function(){P(e);let _=p();return A(_.resetPassword());}),s(11,24),o()(),i(12,"div",45)(13,"div",90),s(14,25),o(),m(15,"my-user-password",92),o(),u(16,Wu,5,0,"div",44),o()()();}if(n&2){let e=p();a(15),l("userId",e.user.id)("username",e.user.username),a(),l("ngIf",e.user.twoFactorEnabled);}}var zo=class zo extends Uo{constructor(e,t,_,d,g,O,R,N,b,G,F){super();this.formReactiveService=e;this.serverService=t;this.configService=_;this.screenService=d;this.auth=g;this.route=O;this.router=R;this.notifier=N;this.userService=b;this.twoFactorService=G;this.userAdminService=F;c(this,"error");c(this,"paramsSub");this.buildQuotaOptions();}ngOnInit(){super.ngOnInit();let e={role:Wt.USER.toString(),videoQuota:"-1",videoQuotaDaily:"-1"};this.buildForm({email:fi,role:Ai,videoQuota:Xn,videoQuotaDaily:Bn,byPassAutoBlock:null,pluginAuth:null},e),this.paramsSub=this.route.params.subscribe(t=>{let _=t.id;this.userService.getUser(_,!0).subscribe({next:d=>this.onUserFetched(d),error:d=>{this.error=d.message;}});});}ngOnDestroy(){this.paramsSub.unsubscribe();}formValidated(){this.error=void 0;let e=this.form.value;e.adminFlags=this.buildAdminFlags(this.form.value),e.videoQuota=parseInt(this.form.value.videoQuota,10),e.videoQuotaDaily=parseInt(this.form.value.videoQuotaDaily,10),e.pluginAuth==="null"&&(e.pluginAuth=null),this.userAdminService.updateUser(this.user.id,e).subscribe({next:()=>{this.notifier.success("\u4F7F\u7528\u8005 "+this.user.username+" \u5DF2\u66F4\u65B0\u3002"),this.router.navigate(["/admin/users/list"]);},error:t=>{this.error=t.message;}});}isCreation(){return!1;}isPasswordOptional(){return!1;}getFormButtonTitle(){return"\u66F4\u65B0\u4F7F\u7528\u8005";}resetPassword(){this.userService.askResetPassword(this.user.email).subscribe({next:()=>{this.notifier.success("\u5DF2\u50B3\u9001\u8981\u6C42\u91CD\u7F6E\u5BC6\u78BC\u7684\u96FB\u5B50\u90F5\u4EF6 "+this.user.username+"\u3002");},error:e=>this.notifier.error(e.message)});}disableTwoFactorAuth(){this.twoFactorService.disableTwoFactor({userId:this.user.id}).subscribe({next:()=>{this.user.twoFactorEnabled=!1,this.notifier.success(""+this.user.username+" \u7684\u5169\u6B65\u9A5F\u9A57\u8B49\u5DF2\u505C\u7528\u3002");},error:e=>this.notifier.error(e.message)});}onUserFetched(e){this.user=new T_(e),this.form.patchValue({email:e.email,role:e.role.id.toString(),videoQuota:e.videoQuota,videoQuotaDaily:e.videoQuotaDaily,pluginAuth:e.pluginAuth,byPassAutoBlock:e.adminFlags&Zo.BYPASS_VIDEO_AUTO_BLACKLIST});}};c(zo,"\u0275fac",function(t){return new(t||zo)(T(Nt),T(Ge),T(pt),T(zn),T(Zt),T(Qe),T(Ze),T(K),T(P_),T(yi),T(jt));}),c(zo,"\u0275cmp",h({type:zo,selectors:[["my-user-update"]],standalone:!0,features:[ne,v],decls:57,vars:27,consts:()=>{let e;e="mail@example.com";let t;t="\u4F4D\u5143\u7D44";let _;_="\u4F4D\u5143\u7D44";let d;d="\u4F7F\u7528\u8005\u7565\u904E\u8ABF\u89E3\u54E1\u7684\u5F71\u7247\u9A57\u8B49";let g;g="\u4F7F\u7528\u8005";let O;O="\u96FB\u5B50\u90F5\u4EF6";let R;R="\u89D2\u8272";let N;N="\u5F71\u7247\u914D\u984D";let b;b="\u6BCF\u65E5\u5F71\u7247\u914D\u984D";let G;G="\u5982\u679C\u6B64\u4F7F\u7528\u8005\u4E0D\u9700\u8981\u8ABF\u89E3\u54E1\u5BE9\u95B1\u5176\u5F71\u7247\uFF0C\u8ACB\u555F\u7528\u6B64\u6838\u53D6\u65B9\u584A\u3002";let F;F="\u5EFA\u7ACB";let L;L="\u7DE8\u8F2F";let $;$="{VAR_PLURAL, plural, =1 {\u5F71\u7247} other {\u5F71\u7247}}",$=Ce($,{VAR_PLURAL:"\uFFFD0\uFFFD"});let H;H="{VAR_PLURAL, plural, =1 {\u983B\u9053} other {\u983B\u9053}}",H=Ce(H,{VAR_PLURAL:"\uFFFD0\uFFFD"});let z;z="{VAR_PLURAL, plural, =1 {\u8A02\u95B1\u8005} other {\u8A02\u95B1\u8005}}",z=Ce(z,{VAR_PLURAL:"\uFFFD0\uFFFD"});let V;V="\u5217\u5165\u6AA2\u8209";let x;x="\u63A5\u53D7\u64B0\u5BEB\u7684\u6AA2\u8209";let Y;Y="{VAR_PLURAL, plural, =1 {\u7559\u8A00} other {\u7559\u8A00}}",Y=Ce(Y,{VAR_PLURAL:"\uFFFD0\uFFFD"});let oe;oe="\u65B0\u4F7F\u7528\u8005";let we;we="john";let ae;ae="\u4F7F\u7528\u8005\u540D\u7A31";let Be;Be="john_channel";let We;We="\u983B\u9053\u540D\u7A31";let je;je="\u5BC6\u78BC";let He;He="\u5982\u679C\u60A8\u5C07\u5BC6\u78BC\u7559\u7A7A\uFF0C\u5C31\u6703\u50B3\u9001\u96FB\u5B50\u90F5\u4EF6\u7D66\u4F7F\u7528\u8005\u3002";let Je;Je="\u9A57\u8B49\u5916\u639B\u7A0B\u5F0F";let Z;Z="\u7121\uFF08\u672C\u6A5F\u9A57\u8B49\uFF09";let it;it="\u5371\u96AA\u5340";let Ye;Ye="\u900F\u904E\u96FB\u5B50\u90F5\u4EF6\u50B3\u9001\u91CD\u8A2D\u5BC6\u78BC\u9023\u7D50\u7D66\u4F7F\u7528\u8005";let rt;rt="\u8981\u6C42\u65B0\u5BC6\u78BC";let at;at="\u624B\u52D5\u8A2D\u5B9A\u4F7F\u7528\u8005\u5BC6\u78BC";let Ke;Ke="\u6B64\u4F7F\u7528\u8005\u5DF2\u555F\u7528\u5169\u6B65\u9A5F\u9A57\u8B49";let q;return q="\u505C\u7528\u5169\u6B65\u9A5F\u9A57\u8B49",[["dashboard",""],g,O,R,N,b,G,F,L,$,H,z,V,x,Y,oe,ae,We,je,He,Je,Z,it,Ye,rt,at,Ke,q,["aria-label","breadcrumb"],[1,"pt-breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/users"],[1,"breadcrumb-item","active"],["class","alert alert-danger",4,"ngIf"],[1,"pt-two-cols","d-xxl-none"],[1,"col-0","col-xl-3"],[1,"col-12","col-xl-9"],[4,"ngTemplateOutlet"],[1,"pt-two-cols","mt-4"],[1,"title-col"],["id","user",1,"anchor"],[1,"content-col"],[1,"row"],["role","form",1,"col",3,"ngSubmit","formGroup"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","email"],["type","text","id","email","placeholder",e,"formControlName","email","autocomplete","off",1,"form-control",3,"ngClass","readonly"],["class","form-error","role","alert",4,"ngIf"],["for","role"],[1,"peertube-select-container"],["id","role","formControlName","role",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["for","videoQuota"],["id","videoQuota","formControlName","videoQuota","inputSuffix",t,"inputType","number",3,"items","clearable"],[3,"videoQuota"],["for","videoQuotaDaily"],["id","videoQuotaDaily","formControlName","videoQuotaDaily","inputSuffix",_,"inputType","number",3,"items","clearable"],["inputName","byPassAutoBlock","formControlName","byPassAutoBlock","labelText",d],["ngProjectAs","description",5,["description"]],["type","submit",1,"peertube-button","orange-button",3,"value","disabled"],[1,"d-none","d-xxl-block","col-7"],["class","pt-two-cols mt-5",4,"ngIf"],["aria-current","page",1,"breadcrumb-item","active"],[3,"routerLink",4,"ngIf"],[3,"routerLink"],["class","dashboard",4,"ngIf"],[1,"dashboard"],[1,"dashboard-num"],[1,"dashboard-label"],[3,"routerLink","queryParams"],[1,"alert","alert-danger"],[1,"visually-hidden"],["actorType","account","editable","false","displayUsername","false",3,"displayName","avatars","username"],["for","username"],["type","text","id","username","placeholder",we,"formControlName","username",1,"form-control",3,"ngClass"],["role","alert",1,"form-error"],["for","channelName"],["type","text","id","channelName","placeholder",Be,"formControlName","channelName",1,"form-control",3,"ngClass"],["for","password"],[4,"ngIf"],["formControlName","password","inputId","password","autocomplete","new-password",3,"formError"],["ptTemplate","customHtml"],[3,"value"],["for","pluginAuth"],["id","pluginAuth","formControlName","pluginAuth",1,"form-control"],[1,"pt-two-cols","mt-5"],["id","danger",1,"anchor"],[1,"pt-title-danger"],[1,"danger-zone"],[1,"mb-1","fw-bold"],[1,"peertube-button",3,"click"],[3,"userId","username"]];},template:function(t,_){if(t&1){let d=k();i(0,"nav",28)(1,"ol",29)(2,"li",30)(3,"a",31),s(4,1),o()(),u(5,Tu,2,0,"li",32)(6,Ou,4,1),o()(),u(7,Mu,1,1,"ng-template",null,0,Sn)(9,fu,2,1,"div",33),i(10,"div",34),m(11,"div",35),i(12,"div",36),u(13,Au,1,0,null,37),o()(),i(14,"div",38)(15,"div",39),m(16,"div",40),u(17,Ru,2,0,"h2")(18,bu,3,4),o(),i(19,"div",41)(20,"div",42)(21,"form",43),M("ngSubmit",function(){return P(d),A(_.formValidated());}),u(22,hu,5,4,"div",44)(23,Du,5,4,"div",44),i(24,"div",45)(25,"label",46),s(26,2),o(),m(27,"input",47),u(28,yu,2,1,"div",48),o(),u(29,xu,5,2,"div",44),i(30,"div",45)(31,"label",49),s(32,3),o(),i(33,"div",50)(34,"select",51),u(35,Gu,2,2,"option",52),o()(),u(36,Uu,2,1,"div",48),o(),i(37,"div",45)(38,"label",53),s(39,4),o(),m(40,"my-select-custom-value",54)(41,"my-user-real-quota-info",55),u(42,wu,2,1,"div",48),o(),i(43,"div",45)(44,"label",56),s(45,5),o(),m(46,"my-select-custom-value",57),u(47,Vu,2,1,"div",48),o(),u(48,zu,8,2,"div",44),i(49,"div",45)(50,"my-peertube-checkbox",58),S(51,59),s(52,6),E(),o()(),m(53,"input",60),o(),i(54,"div",61),u(55,Bu,1,0,null,37),o()()()(),u(56,ju,17,3,"div",62);}if(t&2){let d=Cn(8);a(5),Bt(_.isCreation()?5:6),a(4),l("ngIf",_.error),a(4),l("ngTemplateOutlet",d),a(4),Bt(_.isCreation()?17:_.user?18:-1),a(4),l("formGroup",_.form),a(),l("ngIf",_.isCreation()),a(),l("ngIf",_.isCreation()),a(4),l("ngClass",X(25,hr,_.formErrors.email))("readonly",_.user&&_.user.pluginAuth!==null),a(),l("ngIf",_.formErrors.email),a(),l("ngIf",_.isCreation()),a(6),l("ngForOf",_.roles),a(),l("ngIf",_.formErrors.role),a(4),l("items",_.videoQuotaOptions)("clearable",!1),a(),l("videoQuota",_.getUserVideoQuota()),a(),l("ngIf",_.formErrors.videoQuota),a(4),l("items",_.videoQuotaDailyOptions)("clearable",!1),a(),l("ngIf",_.formErrors.videoQuotaDaily),a(),l("ngIf",!_.isCreation()&&_.getAuthPlugins().length!==0),a(5),qt("value",_.getFormButtonTitle()),l("disabled",!_.form.valid),a(2),l("ngTemplateOutlet",d),a(),l("ngIf",_.displayDangerZone());}},dependencies:[Le,B,_i,Jn,ce,Ot,Ft,ht,Ve,bt,Se,Me,Pe,fe,ke,le,en,Dt,Si,Ne,xt,An,et,Vo,Tt],styles:['input[_ngcontent-%COMP%]:not([type=submit]){font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[_ngcontent-%COMP%]:not([type=submit])::placeholder{color:var(--inputPlaceholderColor)}input[_ngcontent-%COMP%]:not([type=submit])[readonly]{opacity:.7}@media screen and (max-width: 380px){input[_ngcontent-%COMP%]:not([type=submit]){width:100%}}my-input-text[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-input-text[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:340px;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: 340px){.peertube-select-container[_ngcontent-%COMP%]{width:100%}}.peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}my-select-custom-value[_ngcontent-%COMP%]{display:block;width:340px}@media screen and (max-width: 340px){my-select-custom-value[_ngcontent-%COMP%]{width:100%}}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#d56253;color:#fff6f5}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #d562530d}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .danger-zone[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .danger-zone[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#df877c}.danger-zone[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .danger-zone[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{cursor:default}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff6f5}.danger-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.dashboard[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:0 -5px;max-width:900px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;flex:0 0 33.3333333333%;padding:0 5px;margin-bottom:10px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none;color:inherit;display:block;font-size:18px}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:active{text-decoration:none!important}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:active, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{opacity:.8}.dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > a[_ngcontent-%COMP%], .dashboard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:20px;background:var(--submenuBackgroundColor);border-radius:4px;box-sizing:border-box;height:100%}.dashboard[_ngcontent-%COMP%]   .dashboard-num[_ngcontent-%COMP%], .dashboard[_ngcontent-%COMP%]   .dashboard-text[_ngcontent-%COMP%]{text-align:center;font-size:130%;color:var(--mainForegroundColor);line-height:30px;margin-bottom:20px}.dashboard[_ngcontent-%COMP%]   .dashboard-label[_ngcontent-%COMP%]{font-size:90%;color:var(--inputPlaceholderColor);text-align:center}']}));var ur=zo;var Hu=["userBanModal"],Ju=n=>({banned:n}),Ku=n=>({"empty-cell":n}),Yu=n=>[n],wl=n=>({width:n});function qu(n,r){if(n&1&&m(0,"my-action-dropdown",21),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function Qu(n,r){n&1&&(i(0,"a",22),m(1,"my-global-icon",23),S(2),s(3,2),E(),o());}function Zu(n,r){if(n&1){let e=k();i(0,"div",15)(1,"div",16),u(2,qu,1,2,"my-action-dropdown",17)(3,Qu,4,0,"a",18),o(),i(4,"div",19)(5,"my-advanced-input-filter",20),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode()),a(),l("ngIf",!e.isInSelectionMode()),a(2),l("filters",e.inputFilters);}}function eg(n,r){if(n&1&&(i(0,"th",45),C(1),m(2,"p-sortIcon",46),o()),n&2){let e=p(2);l("ngbTooltip",e.sortTooltip),a(),w("",e.getColumn("username").label," ");}}function tg(n,r){if(n&1&&(i(0,"th",47),C(1),m(2,"p-sortIcon",48),o()),n&2){let e=p(2);l("ngbTooltip",e.sortTooltip),a(),w("",e.getColumn("role").label," ");}}function ng(n,r){if(n&1&&(i(0,"th",49),C(1),o()),n&2){let e=p(2);a(),I(e.getColumn("email").label);}}function og(n,r){if(n&1&&(i(0,"th",50),C(1),m(2,"p-sortIcon",51),o()),n&2){let e=p(2);l("ngbTooltip",e.sortTooltip),a(),w("",e.getColumn("quota").label," ");}}function ig(n,r){if(n&1&&(i(0,"th",52),C(1),o()),n&2){let e=p(2);a(),I(e.getColumn("quotaDaily").label);}}function rg(n,r){if(n&1&&(i(0,"th",53),C(1),o()),n&2){let e=p(2);a(),I(e.getColumn("totalVideoFileSize").label);}}function ag(n,r){if(n&1&&(i(0,"th",54),C(1),o()),n&2){let e=p(2);a(),I(e.getColumn("pluginAuth").label);}}function _g(n,r){if(n&1&&(i(0,"th",55),C(1),m(2,"p-sortIcon",56),o()),n&2){let e=p(2);l("ngbTooltip",e.sortTooltip),a(),w("",e.getColumn("createdAt").label," ");}}function lg(n,r){if(n&1&&(i(0,"th",57),C(1),m(2,"p-sortIcon",58),o()),n&2){let e=p(2);l("ngbTooltip",e.sortTooltip),a(),w("",e.getColumn("lastLoginDate").label," ");}}function sg(n,r){if(n&1){let e=k();i(0,"tr")(1,"th",24),m(2,"p-tableHeaderCheckbox",25),o(),i(3,"th",24)(4,"span",26),s(5,3),o()(),i(6,"th",27)(7,"div",28)(8,"button",29),m(9,"my-global-icon",30),o(),i(10,"div",31)(11,"div",32),s(12,4),o(),i(13,"div",33)(14,"my-select-checkbox",34),Oe("ngModelChange",function(_){P(e);let d=p();return Ie(d.selectedColumns,_)||(d.selectedColumns=_),A(_);}),o()(),i(15,"div",33)(16,"my-peertube-checkbox",35),Oe("ngModelChange",function(_){P(e);let d=p();return Ie(d.highlightBannedUsers,_)||(d.highlightBannedUsers=_),A(_);}),o()()()()(),u(17,eg,3,2,"th",36)(18,tg,3,2,"th",37)(19,ng,2,1,"th",38)(20,og,3,2,"th",39)(21,ig,2,1,"th",40)(22,rg,2,1,"th",41)(23,ag,2,1,"th",42)(24,_g,3,2,"th",43)(25,lg,3,2,"th",44),o();}if(n&2){let e=p();a(14),l("availableItems",e.columns)("selectableGroup",!1),Te("ngModel",e.selectedColumns),a(2),Te("ngModel",e.highlightBannedUsers),a(),l("ngIf",e.isSelected("username")),a(),l("ngIf",e.isSelected("role")),a(),l("ngIf",e.isSelected("email")),a(),l("ngIf",e.isSelected("quota")),a(),l("ngIf",e.isSelected("quotaDaily")),a(),l("ngIf",e.isSelected("totalVideoFileSize")),a(),l("ngIf",e.isSelected("pluginAuth")),a(),l("ngIf",e.isSelected("createdAt")),a(),l("ngIf",e.isSelected("lastLoginDate"));}}function cg(n,r){if(n&1&&m(0,"my-table-expander-icon",69),n&2){let e=p(),t=e.expanded,_=e.$implicit;l("pRowToggler",_)("expanded",t);}}function dg(n,r){if(n&1){let e=k();i(0,"my-user-moderation-dropdown",70),M("userChanged",function(){P(e);let _=p(2);return A(_.onUserChanged());})("userDeleted",function(){P(e);let _=p(2);return A(_.onUserChanged());}),o();}if(n&2){let e=p().$implicit,t=p();l("user",e)("account",e.accountMutedStatus)("displayOptions",t.userModerationDisplayOptions);}}function pg(n,r){n&1&&(i(0,"div",77),s(1,5),o());}function mg(n,r){n&1&&(i(0,"div",77),s(1,6),o());}function ug(n,r){if(n&1&&(i(0,"td",71)(1,"a",72)(2,"div",73),m(3,"my-actor-avatar",74),i(4,"div")(5,"span"),C(6),o(),i(7,"span",75),C(8),o()()()(),u(9,pg,2,0,"div",76)(10,mg,2,0,"div",76),o()),n&2){let e=p().$implicit;a(),l("routerLink",X(6,Yu,"/a/"+e.username)),a(2),l("actor",e==null?null:e.account),a(3),I(e.account.displayName),a(2),I(e.username),a(),l("ngIf",e.accountMutedStatus.mutedByInstance),a(),l("ngIf",e.blocked);}}function gg(n,r){if(n&1&&(i(0,"span",80),C(1),o()),n&2){let e=p(2).$implicit;a(),I(e.role.label);}}function Cg(n,r){if(n&1&&(i(0,"span",81),C(1),o()),n&2){let e=p(2).$implicit,t=p();l("ngClass",t.getRoleClass(e.role.id)),a(),I(e.role.label);}}function Sg(n,r){if(n&1&&(i(0,"td"),u(1,gg,2,1,"span",78)(2,Cg,2,2,"span",79),o()),n&2){let e=p().$implicit;a(),l("ngIf",e.blocked),a(),l("ngIf",!e.blocked);}}function Eg(n,r){if(n&1&&(i(0,"td"),m(1,"my-user-email-info",82),o()),n&2){let e=p().$implicit;a(),l("entry",e);}}function Tg(n,r){if(n&1&&(i(0,"td")(1,"div",83),m(2,"div",84),i(3,"span"),C(4),o(),i(5,"span"),C(6),o()()()),n&2){let e=p().$implicit,t=p();a(2),Sr(X(6,wl,t.getUserVideoQuotaPercentage(e)+"%")),It("aria-valuenow",e.rawVideoQuotaUsed)("aria-valuemax",e.rawVideoQuota),a(2),I(e.videoQuotaUsed),a(2),I(e.videoQuota);}}function Ig(n,r){if(n&1&&(i(0,"td")(1,"div",85),m(2,"div",84),i(3,"span"),C(4),o(),i(5,"span"),C(6),o()()()),n&2){let e=p().$implicit,t=p();a(2),Sr(X(6,wl,t.getUserVideoQuotaDailyPercentage(e)+"%")),It("aria-valuenow",e.rawVideoQuotaUsedDaily)("aria-valuemax",e.rawVideoQuotaDaily),a(2),I(e.videoQuotaUsedDaily),a(2),I(e.videoQuotaDaily);}}function Og(n,r){if(n&1&&(i(0,"td"),C(1),ie(2,"bytes"),o()),n&2){let e=p().$implicit;a(),w(" ",Ha(2,1,e.totalVideoFileSize)," ");}}function Ng(n,r){if(n&1&&(i(0,"span",87),C(1),o()),n&2){let e=p(2).$implicit;l("ngbTooltip",e.pluginAuth),a(),I(e.pluginAuth);}}function Mg(n,r){if(n&1&&(i(0,"td"),u(1,Ng,2,2,"span",86),o()),n&2){let e=p().$implicit;a(),l("ngIf",e.pluginAuth);}}function fg(n,r){if(n&1&&(i(0,"td",88),C(1),ie(2,"date"),o()),n&2){let e=p().$implicit;l("title",e.createdAt),a(),I(_e(2,2,e.createdAt,"short"));}}function Pg(n,r){if(n&1&&(i(0,"td",88),C(1),ie(2,"date"),o()),n&2){let e=p().$implicit;l("title",e.lastLoginDate),a(),I(_e(2,2,e.lastLoginDate,"short"));}}function Ag(n,r){if(n&1&&(i(0,"tr",59)(1,"td",60),m(2,"p-tableCheckbox",61),o(),i(3,"td",62),u(4,cg,1,2,"my-table-expander-icon",63),o(),i(5,"td",64),u(6,dg,1,3,"my-user-moderation-dropdown",65),o(),u(7,ug,11,8,"td",66)(8,Sg,3,2,"td",67)(9,Eg,2,1,"td",67)(10,Tg,7,8,"td",67)(11,Ig,7,8,"td",67)(12,Og,3,3,"td",67)(13,Mg,2,1,"td",67)(14,fg,3,5,"td",68)(15,Pg,3,5,"td",68),o()),n&2){let e=r.$implicit,t=p();l("pSelectableRow",e)("ngClass",X(15,Ju,t.highlightBannedUsers&&e.blocked)),a(2),l("value",e),a(),l("ngClass",X(17,Ku,!e.blockedReason)),a(),l("ngIf",e.blockedReason),a(2),l("ngIf",!t.isInSelectionMode()),a(),l("ngIf",t.isSelected("username")),a(),l("ngIf",t.isSelected("role")),a(),l("ngIf",t.isSelected("email")),a(),l("ngIf",t.isSelected("quota")),a(),l("ngIf",t.isSelected("quotaDaily")),a(),l("ngIf",t.isSelected("totalVideoFileSize")),a(),l("ngIf",t.isSelected("pluginAuth")),a(),l("ngIf",t.isSelected("createdAt")),a(),l("ngIf",t.isSelected("lastLoginDate"));}}function Rg(n,r){if(n&1&&(i(0,"tr",89)(1,"td",90)(2,"span",91),s(3,7),o(),C(4),o()()),n&2){let e=r.$implicit;a(4),w(" ",e.blockedReason," ");}}var mn=class mn extends ze{constructor(e,t,_,d,g,O,R,N){super();this.route=e;this.router=t;this.notifier=_;this.confirmService=d;this.auth=g;this.blocklist=O;this.userAdminService=R;this.peertubeLocalStorage=N;c(this,"userBanModal");c(this,"users",[]);c(this,"totalRecords",0);c(this,"sort",{field:"createdAt",order:1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"highlightBannedUsers",!1);c(this,"bulkActions",[]);c(this,"columns");c(this,"inputFilters",[{title:"\u9032\u968E\u7BE9\u9078\u689D\u4EF6",children:[{value:"banned:true",label:"\u5DF2\u963B\u64CB\u7684\u4F7F\u7528\u8005"}]}]);c(this,"userModerationDisplayOptions",{instanceAccount:!0,instanceUser:!0,myAccount:!1});c(this,"_selectedColumns",[]);}get authUser(){return this.auth.getUser();}get selectedColumns(){return this._selectedColumns||[];}set selectedColumns(e){this._selectedColumns=e,this.saveSelectedColumns();}ngOnInit(){this.initialize(),this.bulkActions=[[{label:"\u522A\u9664",description:"\u5F71\u7247\u8207\u7559\u8A00\u90FD\u5C07\u6703\u88AB\u522A\u9664\u3002",handler:e=>this.removeUsers(e),isDisplayed:e=>e.every(t=>this.authUser.canManage(t))},{label:"\u963B\u64CB",description:"\u4F7F\u7528\u8005\u5C07\u7121\u6CD5\u767B\u5165\uFF0C\u4F46\u5F71\u7247\u8207\u7559\u8A00\u5C07\u6703\u4FDD\u6301\u539F\u6A23\u3002",handler:e=>this.openBanUserModal(e),isDisplayed:e=>e.every(t=>this.authUser.canManage(t)&&t.blocked===!1)},{label:"\u53D6\u6D88\u963B\u64CB",handler:e=>this.unbanUsers(e),isDisplayed:e=>e.every(t=>this.authUser.canManage(t)&&t.blocked===!0)}],[{label:"\u8A2D\u5B9A\u96FB\u5B50\u90F5\u4EF6\u70BA\u5DF2\u9A57\u8B49",handler:e=>this.setEmailsAsVerified(e),isDisplayed:e=>e.every(t=>this.authUser.canManage(t)&&!t.blocked&&t.emailVerified!==!0)}]],this.columns=[{id:"username",label:"\u4F7F\u7528\u8005\u540D\u7A31"},{id:"role",label:"\u89D2\u8272"},{id:"email",label:"\u96FB\u5B50\u90F5\u4EF6"},{id:"quota",label:"\u5F71\u7247\u914D\u984D"},{id:"totalVideoFileSize",label:"\u7E3D\u5927\u5C0F"},{id:"createdAt",label:"\u5DF2\u5EFA\u7ACB"},{id:"lastLoginDate",label:"\u6700\u8FD1\u767B\u5165"},{id:"quotaDaily",label:"\u6BCF\u65E5\u914D\u984D"},{id:"pluginAuth",label:"\u9A57\u8B49\u5916\u639B\u7A0B\u5F0F"}],this.loadSelectedColumns();}loadSelectedColumns(){let e=this.peertubeLocalStorage.getItem(mn.LOCAL_STORAGE_SELECTED_COLUMNS_KEY);if(e)try{this.selectedColumns=JSON.parse(e);return;}catch(t){kn.error("Cannot load selected columns.",t);}this.selectedColumns=["username","role","email","quota","totalVideoFileSize","createdAt","lastLoginDate"];}saveSelectedColumns(){this.peertubeLocalStorage.setItem(mn.LOCAL_STORAGE_SELECTED_COLUMNS_KEY,JSON.stringify(this.selectedColumns));}getIdentifier(){return"UserListComponent";}getRoleClass(e){switch(e){case Wt.ADMINISTRATOR:return"badge-purple";case Wt.MODERATOR:return"badge-blue";default:return"badge-yellow";}}isSelected(e){return this.selectedColumns.find(t=>t===e);}getColumn(e){return this.columns.find(t=>t.id===e);}getUserVideoQuotaPercentage(e){return e.rawVideoQuotaUsed*100/e.rawVideoQuota;}getUserVideoQuotaDailyPercentage(e){return e.rawVideoQuotaUsedDaily*100/e.rawVideoQuotaDaily;}openBanUserModal(e){for(let t of e)if(t.username==="root"){this.notifier.error("\u60A8\u4E0D\u80FD\u963B\u64CB root\u3002");return;}this.userBanModal.openModal(e);}onUserChanged(){this.reloadData();}unbanUsers(e){return pe(this,null,function*(){(yield this.confirmService.confirm(me("\u60A8\u771F\u7684\u60F3\u8981\u53D6\u6D88\u5C01\u9396 {count, plural, =1 {1 \u4F4D\u4F7F\u7528\u8005} other {{count} \u4F4D\u4F7F\u7528\u8005}}\uFF1F",{count:e.length}),"\u53D6\u6D88\u963B\u64CB"))!==!1&&this.userAdminService.unbanUsers(e).subscribe({next:()=>{this.notifier.success(me("{count, plural, =1 {1 \u500B\u4F7F\u7528\u8005\u5DF2\u89E3\u9664\u5C01\u9396} other {{count} \u500B\u4F7F\u7528\u8005\u5DF2\u89E3\u9664\u5C01\u9396\u3002}}",{count:e.length})),this.reloadData();},error:_=>this.notifier.error(_.message)});});}removeUsers(e){return pe(this,null,function*(){if(e.some(d=>d.username==="root")){this.notifier.error("\u60A8\u7121\u6CD5\u522A\u9664 root\u3002");return;}let t="<p>\u60A8\u7121\u6CD5\u5EFA\u7ACB\u88AB\u5DF2\u522A\u9664\u7684\u4F7F\u7528\u8005\u6216\u983B\u9053\u4F7F\u7528\u7684\u4F7F\u7528\u8005\u540D\u7A31\u6216\u983B\u9053\u540D\u7A31\u3002</p>"+"\u9019\u4EE3\u8868\u4E86\u4EE5\u4E0B\u4F7F\u7528\u8005\u540D\u7A31\u5C07\u6703\u88AB\u6C38\u4E45\u522A\u9664\u4E14\u7121\u6CD5\u9084\u539F\uFF1A"+"<ul>"+e.map(d=>"<li>"+d.username+"</li>").join("")+"</ul>";(yield this.confirmService.confirm(t,"\u522A\u9664"))!==!1&&this.userAdminService.removeUsers(e).subscribe({next:()=>{this.notifier.success(me("{count, plural, =1 {1 \u500B\u4F7F\u7528\u8005\u5DF2\u522A\u9664\u3002} other {{count} \u500B\u4F7F\u7528\u8005\u5DF2\u522A\u9664\u3002}}",{count:e.length})),this.reloadData();},error:d=>this.notifier.error(d.message)});});}setEmailsAsVerified(e){this.userAdminService.updateUsers(e,{emailVerified:!0}).subscribe({next:()=>{this.notifier.success(me("{count, plural, =1 {1 \u500B\u4F7F\u7528\u8005\u96FB\u5B50\u90F5\u4EF6\u8A2D\u5B9A\u70BA\u5DF2\u9A57\u8B49\u3002} other {{count} \u500B\u4F7F\u7528\u8005\u96FB\u5B50\u90F5\u4EF6\u8A2D\u5B9A\u70BA\u5DF2\u9A57\u8B49\u3002}}",{count:e.length})),this.reloadData();},error:t=>this.notifier.error(t.message)});}reloadDataInternal(){this.userAdminService.getUsers({pagination:this.pagination,sort:this.sort,search:this.search}).subscribe({next:e=>{this.users=e.data.map(t=>Yt(zt({},t),{accountMutedStatus:Yt(zt({},t.account),{nameWithHost:E_.CREATE_BY_STRING(t.account.name,t.account.host),mutedByInstance:!1,mutedByUser:!1,mutedServerByInstance:!1,mutedServerByUser:!1})})),this.totalRecords=e.total,this.loadMutedStatus();},error:e=>this.notifier.error(e.message)});}loadMutedStatus(){this.blocklist.getStatus({accounts:this.users.map(e=>e.username+"@"+Mr())}).subscribe(e=>{for(let t of this.users)t.accountMutedStatus.mutedByInstance=e.accounts[t.username+"@"+Mr()].blockedByServer;});}};c(mn,"LOCAL_STORAGE_SELECTED_COLUMNS_KEY","admin-user-list-selected-columns"),c(mn,"\u0275fac",function(t){return new(t||mn)(T(Qe),T(Ze),T(K),T(xe),T(Zt),T(Fi),T(jt),T(mi));}),c(mn,"\u0275cmp",h({type:mn,selectors:[["my-user-list"]],viewQuery:function(t,_){if(t&1&&gt(Hu,7),t&2){let d;Ct(d=St())&&(_.userBanModal=d.first);}},standalone:!0,features:[ne,v],decls:11,vars:16,consts:()=>{let e;e="\u4F7F\u7528\u8005";let t;t="\u6279\u6B21\u52D5\u4F5C";let _;_="\u5EFA\u7ACB\u4F7F\u7528\u8005";let d;d="\u9078\u53D6\u6240\u6709\u5217";let g;g="\u9078\u53D6\u884C";let O;O="\u7A81\u986F\u88AB\u5C01\u9396\u7684\u4F7F\u7528\u8005";let R;R="\u66F4\u591A\u8CC7\u8A0A";let N;N="\u53C3\u6578\u8868";let b;b="\u9078\u53D6\u6B64\u5217";let G;G="\u5728\u65B0\u5206\u9801\u4E2D\u958B\u555F\u5E33\u865F";let F;F="\u5DF2\u975C\u97F3";let L;L="\u5DF2\u963B\u64CB";let $;$="\u4F7F\u7528\u8005\u88AB\u5C01\u9396";let H;H="\u7E3D\u5F71\u7247\u914D\u984D";let z;z="\u6BCF\u65E5\u5F71\u7247\u7E3D\u914D\u984D";let V;return V="\u963B\u64CB\u7406\u7531\uFF1A",[["userBanModal",""],e,_,R,N,F,L,V,["iconName","user","aria-hidden","true"],["dataKey","id",3,"selectionChange","onLazyLoad","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","resizableColumns","selection","lazy","lazyLoadOnInit","selectionPageOnly","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[3,"userBanned"],[1,"caption"],[1,"left-buttons"],["label",t,"theme","orange",3,"actions","entry",4,"ngIf"],["class","peertube-create-button","routerLink","/admin/users/create",4,"ngIf"],[1,"ms-auto"],[3,"search","filters"],["label",t,"theme","orange",3,"actions","entry"],["routerLink","/admin/users/create",1,"peertube-create-button"],["iconName","user-add","aria-hidden","true"],["scope","col",2,"width","40px"],["ariaLabel",d],[1,"visually-hidden"],["scope","col",2,"width","70px"],["ngbDropdown","","placement","bottom-left auto","container","body","autoClose","outside",1,"c-hand","column-toggle"],["ngbDropdownToggle","",1,"border-0","p-0"],["iconName","columns"],["role","menu","ngbDropdownMenu","",1,"dropdown-menu"],[1,"dropdown-header"],["ngbDropdownItem","",1,"dropdown-item"],["name","columns","placeholder",g,3,"ngModelChange","availableItems","selectableGroup","ngModel"],["inputName","highlightBannedUsers","labelText",O,3,"ngModelChange","ngModel"],["scope","col","pResizableColumn","","container","body","pSortableColumn","username",3,"ngbTooltip",4,"ngIf"],["scope","col","style","width: 120px;","container","body","pSortableColumn","role",3,"ngbTooltip",4,"ngIf"],["scope","col",4,"ngIf"],["scope","col","style","width: 160px;","container","body","pSortableColumn","videoQuotaUsed",3,"ngbTooltip",4,"ngIf"],["scope","col","style","width: 160px;",4,"ngIf"],["scope","col","style","width: 100px;",4,"ngIf"],["scope","col","style","width: 140px;","pResizableColumn","",4,"ngIf"],["scope","col","style","width: 150px;","container","body","pSortableColumn","createdAt",3,"ngbTooltip",4,"ngIf"],["scope","col","style","width: 150px;","container","body","pSortableColumn","lastLoginDate",3,"ngbTooltip",4,"ngIf"],["scope","col","pResizableColumn","","container","body","pSortableColumn","username",3,"ngbTooltip"],["field","username"],["scope","col","container","body","pSortableColumn","role",2,"width","120px",3,"ngbTooltip"],["field","role"],["scope","col"],["scope","col","container","body","pSortableColumn","videoQuotaUsed",2,"width","160px",3,"ngbTooltip"],["field","videoQuotaUsed"],["scope","col",2,"width","160px"],["scope","col",2,"width","100px"],["scope","col","pResizableColumn","",2,"width","140px"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],["scope","col","container","body","pSortableColumn","lastLoginDate",2,"width","150px",3,"ngbTooltip"],["field","lastLoginDate"],[3,"pSelectableRow","ngClass"],[1,"checkbox-cell"],["ariaLabel",b,3,"value"],[1,"expand-cell",3,"ngClass"],[3,"pRowToggler","expanded",4,"ngIf"],[1,"action-cell"],["container","body",3,"user","account","displayOptions","userChanged","userDeleted",4,"ngIf"],["class","cell-username",4,"ngIf"],[4,"ngIf"],[3,"title",4,"ngIf"],[3,"pRowToggler","expanded"],["container","body",3,"userChanged","userDeleted","user","account","displayOptions"],[1,"cell-username"],["title",G,"target","_blank","rel","noopener noreferrer",3,"routerLink"],[1,"chip","two-lines"],["actorType","account","size","32",3,"actor"],[1,"muted"],["class","pt-badge badge-red",4,"ngIf"],[1,"pt-badge","badge-red"],["class","pt-badge badge-banned","title",$,4,"ngIf"],["class","pt-badge",3,"ngClass",4,"ngIf"],["title",$,1,"pt-badge","badge-banned"],[1,"pt-badge",3,"ngClass"],["showEmailVerifyInformation","true",3,"entry"],["title",H,1,"progress"],["role","progressbar","aria-valuemin","0",1,"progress-bar"],["title",z,1,"progress"],[3,"ngbTooltip",4,"ngIf"],[3,"ngbTooltip"],[3,"title"],[1,"user-blocked-reason"],["myAutoColspan",""],[1,"ban-reason-label"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1"),m(1,"my-global-icon",8),S(2),s(3,1),E(),o(),i(4,"p-table",9),Oe("selectionChange",function(O){return P(d),Ie(_.selectedRows,O)||(_.selectedRows=O),A(O);}),M("onLazyLoad",function(O){return P(d),A(_.loadLazy(O));}),u(5,Zu,6,3,"ng-template",10)(6,sg,26,13,"ng-template",11)(7,Ag,16,19,"ng-template",12)(8,Rg,5,1,"ng-template",13),o(),i(9,"my-user-ban-modal",14,0),M("userBanned",function(){return P(d),A(_.onUserChanged());}),o();}t&2&&(a(4),l("value",_.users)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("resizableColumns",!0),Te("selection",_.selectedRows),l("lazy",!0)("lazyLoadOnInit",!1)("selectionPageOnly",!0)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows));},dependencies:[de,ve,be,Ae,Fe,tn,ft,k_,he,Lt,$t,Re,B,tt,Le,nt,c_,s_,l_,__,Ni,ce,Se,At,et,$e,le,Mt,rl,Ei,uo,Ue,il,ye,Tt],styles:["tr.banned[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{background-color:#fcc!important}.banned-info[_ngcontent-%COMP%]{font-style:italic}.ban-reason-label[_ngcontent-%COMP%]{font-weight:600}.cell-username[_ngcontent-%COMP%]   .pt-badge[_ngcontent-%COMP%]{margin-inline-start:.9375rem}p-tableCheckbox[_ngcontent-%COMP%]{position:relative;top:-2.5px}my-global-icon[_ngcontent-%COMP%]{width:18px}.progress[_ngcontent-%COMP%]{width:auto;max-width:100%;background-color:var(--greyBackgroundColor);display:flex;height:1rem;overflow:hidden;font-size:.75rem;border-radius:.25rem;position:relative}.progress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;color:var(--greyForegroundColor);top:-1px}.progress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-of-type(1){left:.2rem}.progress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-of-type(2){right:.2rem}.progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{color:var(--mainBackgroundColor);background-color:var(--mainColor);display:flex;flex-direction:column;justify-content:center;text-align:center;white-space:nowrap;transition:width .6s ease}.progress[_ngcontent-%COMP%]   .progress-bar.red[_ngcontent-%COMP%]{background-color:#d56253}@media screen and (max-width: 960px){.progress[_ngcontent-%COMP%]{width:100%}.empty-cell[_ngcontent-%COMP%]{padding:0}}"]}));var gr=mn;var Vl=[{path:"users",canActivate:[De],data:{userRight:Q.MANAGE_USERS},children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:gr,data:{meta:{title:"\u4F7F\u7528\u8005\u6E05\u55AE"}}},{path:"create",component:mr,data:{meta:{title:"\u5EFA\u7ACB\u4F7F\u7528\u8005"}}},{path:"update/:id",component:ur,data:{meta:{title:"\u66F4\u65B0\u4F7F\u7528\u8005"}}}]}];var Gn=class Gn{constructor(r,e,t,_){this.videoService=r;this.authHttp=e;this.restExtractor=t;this.restService=_;}getAdminVideos(r){let{pagination:e,search:t}=r,_=new Et();return _=this.videoService.buildCommonVideosParams(zt({params:_},r)),_=_.set("start",e.start.toString()).set("count",e.count.toString()),_=this.buildAdminParamsFromSearch(t,_),this.authHttp.get(Mn.BASE_VIDEO_URL,{params:_}).pipe(wn(d=>this.videoService.extractVideos(d)),ge(d=>this.restExtractor.handleError(d)));}buildAdminInputFilter(){return[{title:"\u5F71\u7247\u985E\u578B",children:[{value:"isLive:false",label:"\u96A8\u9078\u8996\u8A0A"},{value:"isLive:true",label:"\u76F4\u64AD"}]},{title:"\u5F71\u7247\u6A94",children:[{value:"webVideos:true isLocal:true",label:"\u5305\u542B\u7DB2\u8DEF\u5F71\u7247"},{value:"webVideos:false isLocal:true",label:"\u4E0D\u5305\u542B\u7DB2\u8DEF\u5F71\u7247"},{value:"hls:true isLocal:true",label:"\u4F7F\u7528 HLS"},{value:"hls:false isLocal:true",label:"\u4E0D\u4F7F\u7528 HLS"}]},{title:"\u5F71\u7247\u7BC4\u570D",children:[{value:"isLocal:false",label:"\u9060\u7AEF\u5F71\u7247"},{value:"isLocal:true",label:"\u672C\u5730\u5F71\u7247"}]},{title:"\u6392\u9664",children:[{value:"excludeMuted",label:"\u6392\u9664\u5DF2\u975C\u97F3\u7684\u5E33\u865F"},{value:"excludePublic",label:"\u6392\u9664\u516C\u958B\u5F71\u7247"}]}];}buildAdminParamsFromSearch(r,e){let t=Tn.BLACKLISTED|Tn.BLOCKED_OWNER|Tn.NOT_PUBLISHED_STATE|Tn.FILES|Tn.SOURCE|Tn.AUTOMATIC_TAGS,_=a_();if(!r)return this.restService.addObjectParams(e,{include:t,privacyOneOf:_});let d=this.restService.parseQueryStringFilter(r,{isLocal:{prefix:"isLocal:",isBoolean:!0},hasHLSFiles:{prefix:"hls:",isBoolean:!0},hasWebVideoFiles:{prefix:"webVideos:",isBoolean:!0},isLive:{prefix:"isLive:",isBoolean:!0},excludeMuted:{prefix:"excludeMuted",handler:()=>!0},excludePublic:{prefix:"excludePublic",handler:()=>!0},autoTagOneOf:{prefix:"autoTag:",multiple:!0}});return d.excludeMuted&&(t&=~Tn.BLOCKED_OWNER,d.excludeMuted=void 0),d.excludePublic&&(_=[Fn.PRIVATE,Fn.UNLISTED,Fn.INTERNAL,Fn.PASSWORD_PROTECTED],d.excludePublic=void 0),this.restService.addObjectParams(e,Yt(zt({},d),{include:t,privacyOneOf:_}));}};c(Gn,"\u0275fac",function(e){return new(e||Gn)(Ee(Mn),Ee(lt),Ee(ct),Ee(vt));}),c(Gn,"\u0275prov",qe({token:Gn,factory:Gn.ɵfac}));var Xo=Gn;var Fg=["videoBlockModal"],hg=n=>({loading:n}),vg=()=>["."],Dg=n=>({search:n});function yg(n,r){if(n&1&&m(0,"my-action-dropdown",35),n&2){let e=p(2);l("actions",e.bulkActions)("entry",e.selectedRows);}}function Lg(n,r){if(n&1){let e=k();i(0,"div",29)(1,"div",30),u(2,yg,1,2,"my-action-dropdown",31),o(),i(3,"div",32)(4,"my-advanced-input-filter",33),M("search",function(_){P(e);let d=p();return A(d.onSearch(_));}),o(),i(5,"my-button",34),M("click",function(){P(e);let _=p();return A(_.reloadData());}),o()()();}if(n&2){let e=p();a(2),l("ngIf",e.isInSelectionMode()),a(2),l("filters",e.inputFilters);}}function $g(n,r){if(n&1&&(i(0,"tr")(1,"th",36),m(2,"p-tableHeaderCheckbox",37),o(),i(3,"th",36)(4,"span",38),s(5,2),o()(),i(6,"th",39)(7,"span",38),s(8,3),o()(),i(9,"th",40),s(10,4),o(),i(11,"th",40),s(12,5),o(),i(13,"th",41),D(14,6),m(15,"p-sortIcon",42),y(),o(),i(16,"th",43),D(17,7),m(18,"p-sortIcon",44),y(),o()()),n&2){let e=p();a(13),l("ngbTooltip",e.sortTooltip),a(3),l("ngbTooltip",e.sortTooltip);}}function xg(n,r){n&1&&(i(0,"span",53),s(1,8),o());}function Gg(n,r){n&1&&(i(0,"span",54),s(1,9),o());}function Ug(n,r){n&1&&(i(0,"span",62),s(1,10),o());}function wg(n,r){if(n&1&&(i(0,"span",63),C(1),o()),n&2){let e=p().$implicit;a(),I(e.state.label);}}function Vg(n,r){n&1&&(i(0,"span",62),s(1,11),o());}function kg(n,r){n&1&&(i(0,"span",62),s(1,12),o());}function zg(n,r){n&1&&(i(0,"span",62),s(1,13),o());}function Xg(n,r){if(n&1&&(i(0,"a",58),C(1),o()),n&2){let e=r.$implicit,t=p(2);l("routerLink",Pt(3,vg))("queryParams",X(4,Dg,t.buildSearchAutoTag(e))),a(),I(e);}}function Bg(n,r){n&1&&(i(0,"span",53),s(1,14),o());}function Wg(n,r){n&1&&(i(0,"span",53),s(1,15),o());}function jg(n,r){if(n&1&&(i(0,"span",53),s(1,16),o()),n&2){let e=p().$implicit;a(),W(e.files.length),j(1);}}function Hg(n,r){n&1&&(i(0,"span",53),s(1,17),o());}function Jg(n,r){n&1&&(i(0,"span",54),s(1,18),o());}function Kg(n,r){if(n&1&&(i(0,"span"),C(1),ie(2,"bytes"),o()),n&2){let e=p().$implicit,t=p();a(),I(_e(2,1,t.getFilesSize(e),1));}}function Yg(n,r){if(n&1){let e=k();i(0,"tr",45),M("onRowExpand",function(){let _=P(e).$implicit,d=p();return A(d.onVideoPanelOpened(_));}),i(1,"td",46),m(2,"p-tableCheckbox",47),o(),i(3,"td",48),m(4,"my-table-expander-icon",49),o(),i(5,"td",50)(6,"my-video-actions-dropdown",51),M("videoRemoved",function(){P(e);let _=p();return A(_.reloadData());})("videoFilesRemoved",function(){P(e);let _=p();return A(_.reloadData());})("transcodingCreated",function(){P(e);let _=p();return A(_.reloadData());}),o()(),i(7,"td"),m(8,"my-video-cell",52),o(),i(9,"td")(10,"div"),u(11,xg,2,0,"span",53)(12,Gg,2,0,"span",54),i(13,"span",55),C(14),o(),u(15,Ug,2,0,"span",56)(16,wg,2,1,"span",57)(17,Vg,2,0,"span",56)(18,kg,2,0,"span",56)(19,zg,2,0,"span",56),o(),i(20,"div"),ka(21,Xg,2,6,"a",58,Va),o()(),i(23,"td"),u(24,Bg,2,0,"span",59)(25,Wg,2,0,"span",59)(26,jg,2,1,"span",59)(27,Hg,2,0,"span",59)(28,Jg,2,0,"span",60)(29,Kg,3,4,"span",61),o(),i(30,"td"),C(31),ie(32,"date"),o()();}if(n&2){let e=r.expanded,t=r.$implicit,_=p();l("pSelectableRow",t),a(2),l("value",t),a(2),l("pRowToggler",t)("expanded",e),a(2),l("video",t)("displayOptions",_.videoActionsOptions),a(2),l("video",t),a(3),Bt(t.isLocal?11:12),a(2),l("ngClass",_.getPrivacyBadgeClass(t)),a(),I(t.privacy.label),a(),l("ngIf",t.nsfw),a(),l("ngIf",_.isUnpublished(t)),a(),l("ngIf",_.isAccountBlocked(t)),a(),l("ngIf",_.isServerBlocked(t)),a(),l("ngIf",_.isVideoBlocked(t)),a(2),za(t.automaticTags),a(3),l("ngIf",_.hasOriginalFile(t)),a(),l("ngIf",_.hasHLS(t)),a(),l("ngIf",_.hasWebVideos(t)),a(),l("ngIf",t.isLive),a(),l("ngIf",_.hasObjectStorage(t)),a(),l("ngIf",!_.isImport(t)&&!t.isLive&&t.isLocal),a(2),w(" ",_e(32,22,t.publishedAt,"short")," ");}}function qg(n,r){if(n&1){let e=k();i(0,"div",67),S(1),s(2,19),E(),i(3,"ul")(4,"li")(5,"a",68),C(6),o(),C(7),ie(8,"bytes"),i(9,"button",69),M("click",function(){P(e);let _=p().$implicit,d=p();return A(d.removeVideoSourceFile(_));}),m(10,"my-global-icon",70),o()()()();}if(n&2){let e=p().$implicit,t=p();a(5),l("href",t.getDownloadUrl(e,e.videoSource.fileDownloadUrl),Xe),a(),I(e.videoSource.inputFilename),a(),w(": ",_e(8,3,e.videoSource.size,1)," ");}}function Qg(n,r){if(n&1){let e=k();i(0,"button",74),M("click",function(){P(e);let _=p().$implicit,d=p(2).$implicit,g=p();return A(g.removeVideoFile(d,_,"web-videos"));}),m(1,"my-global-icon",70),o();}}function Zg(n,r){if(n&1&&(i(0,"li")(1,"a",72),C(2),o(),C(3),ie(4,"bytes"),u(5,Qg,2,0,"button",73),o()),n&2){let e=r.$implicit,t=p(2).$implicit,_=p();a(),l("href",_.getDownloadUrl(t,e.fileDownloadUrl),Xe),a(),I(e.resolution.label),a(),w(": ",_e(4,4,e.size,1)," "),a(2),l("ngIf",_.canRemoveOneFile(t));}}function eC(n,r){if(n&1&&(i(0,"div",67),S(1),s(2,20),E(),i(3,"ul"),u(4,Zg,6,7,"li",71),o()()),n&2){let e=p().$implicit;a(4),l("ngForOf",e.files);}}function tC(n,r){if(n&1){let e=k();i(0,"button",77),M("click",function(){P(e);let _=p().$implicit,d=p(2).$implicit,g=p();return A(g.removeVideoFile(d,_,"hls"));}),m(1,"my-global-icon",70),o();}}function nC(n,r){if(n&1&&(i(0,"li")(1,"a",75),C(2),o(),C(3),ie(4,"bytes"),u(5,tC,2,0,"button",76),o()),n&2){let e=r.$implicit,t=p(2).$implicit,_=p();a(),l("href",_.getDownloadUrl(t,e.fileDownloadUrl),Xe),a(),I(e.resolution.label),a(),w(": ",_e(4,4,e.size,1)," "),a(2),l("ngIf",_.canRemoveOneFile(t));}}function oC(n,r){if(n&1&&(i(0,"div"),S(1),s(2,21),E(),i(3,"ul"),u(4,nC,6,7,"li",71),o()()),n&2){let e=p().$implicit;a(4),l("ngForOf",e.streamingPlaylists[0].files);}}function iC(n,r){if(n&1&&(i(0,"tr")(1,"td",64)(2,"div"),u(3,qg,11,6,"div",65)(4,eC,5,1,"div",65)(5,oC,5,1,"div",61),m(6,"my-embed",66),o()()()),n&2){let e=r.$implicit,t=p();a(3),l("ngIf",t.hasOriginalFile(e)),a(),l("ngIf",t.hasWebVideos(e)),a(),l("ngIf",t.hasHLS(e)),a(),l("video",e);}}var Bo=class Bo extends ze{constructor(e,t,_,d,g,O,R,N,b,G,F){super();this.route=e;this.router=t;this.confirmService=_;this.auth=d;this.notifier=g;this.videoService=O;this.videoAdminService=R;this.videoBlockService=N;this.videoCaptionService=b;this.server=G;this.videoFileTokenService=F;c(this,"videoBlockModal");c(this,"videos",[]);c(this,"totalRecords",0);c(this,"sort",{field:"publishedAt",order:-1});c(this,"pagination",{count:this.rowsPerPage,start:0});c(this,"bulkActions",[]);c(this,"inputFilters");c(this,"videoActionsOptions",{playlist:!1,download:!1,update:!0,blacklist:!0,delete:!0,report:!1,duplicate:!0,mute:!0,liveInfo:!1,removeFiles:!0,transcoding:!0,studio:!0,stats:!0,generateTranscription:!0});c(this,"loading",!0);c(this,"videoFileTokens",{});}get authUser(){return this.auth.getUser();}get serverConfig(){return this.server.getHTMLConfig();}ngOnInit(){this.initialize(),this.inputFilters=this.videoAdminService.buildAdminInputFilter(),this.bulkActions=[[{label:"\u522A\u9664",handler:e=>this.removeVideos(e),isDisplayed:()=>this.authUser.hasRight(Q.REMOVE_ANY_VIDEO),iconName:"delete"},{label:"\u5C01\u9396",handler:e=>this.videoBlockModal.show(e),isDisplayed:e=>this.authUser.hasRight(Q.MANAGE_VIDEO_BLACKLIST)&&e.every(t=>!t.blacklisted),iconName:"no"},{label:"\u89E3\u9664\u5C01\u9396",handler:e=>this.unblockVideos(e),isDisplayed:e=>this.authUser.hasRight(Q.MANAGE_VIDEO_BLACKLIST)&&e.every(t=>t.blacklisted),iconName:"undo"}],[{label:"\u57F7\u884C HLS \u8F49\u63DB\u7DE8\u78BC",handler:e=>this.runTranscoding(e,"hls"),isDisplayed:e=>e.every(t=>t.canRunTranscoding(this.authUser)),iconName:"cog"},{label:"\u57F7\u884C\u7DB2\u8DEF\u5F71\u7247\u8F49\u63DB\u7DE8\u78BC",handler:e=>this.runTranscoding(e,"web-video"),isDisplayed:e=>e.every(t=>t.canRunTranscoding(this.authUser)),iconName:"cog"},{label:"\u522A\u9664 HLS \u6A94\u6848",handler:e=>this.removeVideoFiles(e,"hls"),isDisplayed:e=>e.every(t=>t.canRemoveAllHLSOrWebFiles(this.authUser)),iconName:"delete"},{label:"\u522A\u9664\u7DB2\u8DEF\u5F71\u7247\u6A94\u6848",handler:e=>this.removeVideoFiles(e,"web-videos"),isDisplayed:e=>e.every(t=>t.canRemoveAllHLSOrWebFiles(this.authUser)),iconName:"delete"}],[{label:"\u7522\u751F\u5B57\u5E55",handler:e=>this.generateCaption(e),isDisplayed:e=>e.every(t=>t.canGenerateTranscription(this.authUser,this.serverConfig.videoTranscription.enabled)),iconName:"video-lang"}]];}getIdentifier(){return"VideoListComponent";}getPrivacyBadgeClass(e){return e.privacy.id===Fn.PUBLIC?"badge-green":"badge-yellow";}isUnpublished(e){return e.state.id!==ci.LIVE_ENDED&&e.state.id!==ci.PUBLISHED;}isAccountBlocked(e){return e.blockedOwner;}isServerBlocked(e){return e.blockedServer;}isVideoBlocked(e){return e.blacklisted;}isImport(e){return e.state.id===ci.TO_IMPORT;}hasOriginalFile(e){var t;return!!((t=e.videoSource)!=null&&t.fileDownloadUrl);}hasHLS(e){let t=e.streamingPlaylists.find(_=>_.type===e_.HLS);return t?t.files.length!==0:!1;}hasWebVideos(e){return e.files.length!==0;}hasObjectStorage(e){return e.isLocal?Or(e).some(_=>_.storage===Qa.OBJECT_STORAGE):!1;}canRemoveOneFile(e){return e.canRemoveOneFile(this.authUser);}getFilesSize(e){var _;let t=Or(e).reduce((d,g)=>d+=g.size,0);return(_=e.videoSource)!=null&&_.fileDownloadUrl&&(t+=e.videoSource.size||0),t;}removeVideoFile(e,t,_){return pe(this,null,function*(){let d="\u60A8\u771F\u7684\u60F3\u8981\u522A\u9664\u6B64 "+t.resolution.label+" \u6A94\u6848\u55CE\uFF1F";(yield this.confirmService.confirm(d,"\u522A\u9664\u6A94\u6848"))!==!1&&this.videoService.removeFile(e.uuid,t.id,_).subscribe({next:()=>{this.notifier.success("\u6A94\u6848\u5DF2\u79FB\u9664\u3002"),this.reloadData();},error:O=>this.notifier.error(O.message)});});}removeVideoSourceFile(e){return pe(this,null,function*(){let t="\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u5F71\u7247\u7684\u539F\u59CB\u6A94\u6848\u55CE\uFF1F";(yield this.confirmService.confirm(t,"\u522A\u9664\u539F\u59CB\u6A94\u6848"))!==!1&&this.videoService.removeSourceFile(e.uuid).subscribe({next:()=>{this.notifier.success("\u5DF2\u79FB\u9664\u539F\u59CB\u6A94\u6848\u3002"),this.reloadData();},error:d=>this.notifier.error(d.message)});});}buildSearchAutoTag(e){let t=`autoTag:"${e}"`;return this.search?this.search+" "+t:t;}onVideoPanelOpened(e){var _;let t=e.data;!((_=t.videoSource)!=null&&_.filename)&&!N_(t)||this.videoFileTokenService.getVideoFileToken({videoUUID:t.uuid}).subscribe(({token:d})=>{this.videoFileTokens[t.id]=d;});}getDownloadUrl(e,t){let _=this.videoFileTokens[e.id];return _?t+`?videoFileToken=${_}`:t;}reloadDataInternal(){this.loading=!0,this.videoAdminService.getAdminVideos({pagination:this.pagination,sort:this.sort,nsfw:"both",search:this.search}).pipe($a(()=>this.loading=!1)).subscribe({next:e=>{this.videos=e.data,this.totalRecords=e.total;},error:e=>this.notifier.error(e.message)});}removeVideos(e){return pe(this,null,function*(){let t=me("\u60A8\u78BA\u5B9A\u60A8\u60F3\u8981\u522A\u9664 {count, plural, =1 {\u6B64\u5F71\u7247} other {these {count} \u90E8\u5F71\u7247}}\u55CE\uFF1F",{count:e.length});(yield this.confirmService.confirm(t,"\u522A\u9664"))!==!1&&this.videoService.removeVideo(e.map(d=>d.id)).subscribe({next:()=>{this.notifier.success(me("\u5DF2\u522A\u9664 {count, plural, =1 {1 \u90E8\u5F71\u7247} other {{count} \u90E8\u5F71\u7247}}\u3002",{count:e.length})),this.reloadData();},error:d=>this.notifier.error(d.message)});});}unblockVideos(e){this.videoBlockService.unblockVideo(e.map(t=>t.id)).subscribe({next:()=>{this.notifier.success(me("\u5DF2\u89E3\u9664\u5C01\u9396 {count, plural, =1 {1 \u90E8\u5F71\u7247} other {{count} \u90E8\u5F71\u7247}}\u3002",{count:e.length})),this.reloadData();},error:t=>this.notifier.error(t.message)});}removeVideoFiles(e,t){return pe(this,null,function*(){let _;t==="hls"?_=me("\u60A8\u78BA\u5B9A\u60A8\u60F3\u8981\u522A\u9664 {count, plural, =1 {1 \u500B HLS \u4E32\u6D41\u64AD\u653E\u6E05\u55AE} other {{count} \u500B HLS \u4E32\u6D41\u64AD\u653E\u6E05\u55AE}}?",{count:e.length}):_=me("\u60A8\u78BA\u5B9A\u8981\u522A\u9664 {count, plural, =1 {1 \u90E8\u5F71\u7247} other {{count} \u90E8\u5F71\u7247}}\u7684\u7DB2\u8DEF\u5F71\u7247\u6A94\u6848\u55CE\uFF1F",{count:e.length}),(yield this.confirmService.confirm(_,"\u522A\u9664"))!==!1&&this.videoService.removeVideoFiles(e.map(g=>g.id),t).subscribe({next:()=>{this.notifier.success("\u6A94\u6848\u88AB\u79FB\u9664\u3002"),this.reloadData();},error:g=>this.notifier.error(g.message)});});}runTranscoding(e,t){this.videoService.runTranscoding({videos:e,type:t}).subscribe({next:()=>{this.notifier.success("\u5DF2\u5EFA\u7ACB\u8F49\u63DB\u7DE8\u78BC\u5DE5\u4F5C\u3002"),this.reloadData();},error:_=>this.notifier.error(_.message)});}generateCaption(e){this.videoCaptionService.generateCaption({videos:e}).subscribe({next:t=>{t.success&&this.notifier.success(me("{count, plural, =1 {\u5DF2\u5EFA\u7ACB 1 \u500B\u8F49\u9304\u4F5C\u696D\u3002} other {\u5DF2\u5EFA\u7ACB {count} \u500B\u8F49\u9304\u4F5C\u696D\u3002}}",{count:t.success})),t.alreadyHasCaptions&&this.notifier.info(me("{count, plural, =1 {1 \u90E8\u5F71\u7247\u5DF2\u6709\u5B57\u5E55\u3002} other {{count} \u90E8\u5F71\u7247\u5DF2\u6709\u5B57\u5E55\u3002}}",{count:t.alreadyHasCaptions})),t.alreadyBeingTranscribed&&this.notifier.info(me("{count, plural, =1 {\u5DF2\u8F49\u9304 1 \u90E8\u5F71\u7247\u3002} other {\u5DF2\u8F49\u9304 {count} \u90E8\u5F71\u7247\u3002}}",{count:t.alreadyBeingTranscribed}));},error:t=>this.notifier.error(t.message)});}};c(Bo,"\u0275fac",function(t){return new(t||Bo)(T(Qe),T(Ze),T(xe),T(Zt),T(K),T(Mn),T(Xo),T(jn),T($_),T(Ge),T(L_));}),c(Bo,"\u0275cmp",h({type:Bo,selectors:[["my-video-list"]],viewQuery:function(t,_){if(t&1&&gt(Fg,5),t&2){let d;Ct(d=St())&&(_.videoBlockModal=d.first);}},standalone:!0,features:[ne,v],decls:11,vars:19,consts:()=>{let e;e="\u5F71\u7247";let t;t="\u6279\u6B21\u52D5\u4F5C";let _;_="\u91CD\u65B0\u6574\u7406";let d;d="\u9078\u53D6\u6240\u6709\u5217";let g;g="\u66F4\u591A\u8CC7\u8A0A";let O;O="\u52D5\u4F5C";let R;R="\u5F71\u7247";let N;N="\u8CC7\u8A0A";let b;b="\u6A94\u6848 "+"\uFFFD#15\uFFFD"+""+"\uFFFD/#15\uFFFD"+"";let G;G="\u5DF2\u767C\u4F48 "+"\uFFFD#18\uFFFD"+""+"\uFFFD/#18\uFFFD"+"";let F;F="\u9078\u53D6\u6B64\u5217";let L;L="\u50C5\u986F\u793A\u6709\u6B64\u6A19\u7C64\u7684\u5F71\u7247";let $;$="\u672C\u5730";let H;H="\u9060\u7AEF";let z;z="NSFW";let V;V="\u5E33\u865F\u5DF2\u975C\u97F3";let x;x="\u4F3A\u670D\u5668\u5DF2\u975C\u97F3";let Y;Y="\u5DF2\u5C01\u9396";let oe;oe="\u539F\u59CB\u6A94\u6848";let we;we="HLS";let ae;ae="\u7DB2\u8DEF\u5F71\u7247 ("+"\uFFFD0\uFFFD"+")";let Be;Be="\u76F4\u64AD";let We;We="\u7269\u4EF6\u5132\u5B58";let je;je="\u4E0B\u8F09\u6B64\u6A94\u6848";let He;He="\u522A\u9664\u6B64\u6A94\u6848";let Je;Je="\u539F\u59CB\u6A94\u6848\uFF1A";let Z;Z="\u7DB2\u8DEF\u5F71\u7247\uFF1A";let it;it="\u4E0B\u8F09\u6B64\u6A94\u6848";let Ye;Ye="\u522A\u9664\u6B64\u6A94\u6848";let rt;rt="HLS\uFF1A";let at;at="\u4E0B\u8F09\u6B64\u6A94\u6848";let Ke;return Ke="\u522A\u9664\u6B64\u6A94\u6848",[["videoBlockModal",""],e,g,O,R,N,b,G,$,H,z,V,x,Y,oe,we,ae,Be,We,Je,Z,rt,["iconName","videos","aria-hidden","true"],["dataKey","id",3,"selectionChange","onLazyLoad","onRowExpand","value","paginator","totalRecords","rows","first","rowsPerPageOptions","sortField","sortOrder","resizableColumns","selection","lazy","lazyLoadOnInit","selectionPageOnly","showCurrentPageReport","currentPageReportTemplate","expandedRowKeys","ngClass"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[3,"videoBlocked"],[1,"caption"],[1,"left-buttons"],["label",t,"theme","orange",3,"actions","entry",4,"ngIf"],[1,"ms-auto","right-form"],[3,"search","filters"],["label",_,"icon","refresh",3,"click"],["label",t,"theme","orange",3,"actions","entry"],["scope","col",2,"width","40px"],["ariaLabel",d],[1,"visually-hidden"],["scope","col",2,"width","70px"],["scope","col"],["scope","col","container","body","pSortableColumn","localVideoFilesSize",3,"ngbTooltip"],["field","localVideoFilesSize"],["scope","col","container","body","pSortableColumn","publishedAt",2,"width","150px",3,"ngbTooltip"],["field","publishedAt"],[3,"onRowExpand","pSelectableRow"],[1,"checkbox-cell"],["ariaLabel",F,3,"value"],[1,"expand-cell"],[3,"pRowToggler","expanded"],[1,"action-cell"],["placement","bottom auto","buttonDirection","horizontal","buttonStyled","true",3,"videoRemoved","videoFilesRemoved","transcodingCreated","video","displayOptions"],[3,"video"],[1,"pt-badge","badge-blue"],[1,"pt-badge","badge-purple"],[1,"pt-badge",3,"ngClass"],["class","pt-badge badge-red",4,"ngIf"],["class","pt-badge badge-yellow",4,"ngIf"],["title",L,1,"pt-badge","badge-secondary","me-1",3,"routerLink","queryParams"],["class","pt-badge badge-blue",4,"ngIf"],["class","pt-badge badge-purple",4,"ngIf"],[4,"ngIf"],[1,"pt-badge","badge-red"],[1,"pt-badge","badge-yellow"],["myAutoColspan","",1,"video-info","expand-cell"],["class","me-3",4,"ngIf"],[1,"ms-auto",3,"video"],[1,"me-3"],["title",je,3,"href"],["title",He,1,"border-0","p-0",3,"click"],["iconName","delete"],[4,"ngFor","ngForOf"],["title",it,3,"href"],["class","border-0 p-0","title",Ye,3,"click",4,"ngIf"],["title",Ye,1,"border-0","p-0",3,"click"],["title",at,3,"href"],["class","border-0 p-0","title",Ke,3,"click",4,"ngIf"],["title",Ke,1,"border-0","p-0",3,"click"]];},template:function(t,_){if(t&1){let d=k();i(0,"h1"),m(1,"my-global-icon",22),S(2),s(3,1),E(),o(),i(4,"p-table",23),Oe("selectionChange",function(O){return P(d),Ie(_.selectedRows,O)||(_.selectedRows=O),A(O);}),M("onLazyLoad",function(O){return P(d),A(_.loadLazy(O));})("onRowExpand",function(O){return P(d),A(_.onVideoPanelOpened(O));}),u(5,Lg,6,2,"ng-template",24)(6,$g,19,2,"ng-template",25)(7,Yg,33,25,"ng-template",26)(8,iC,7,4,"ng-template",27),o(),i(9,"my-video-block",28,0),M("videoBlocked",function(){return P(d),A(_.reloadData());}),o();}t&2&&(a(4),l("value",_.videos)("paginator",_.totalRecords>0)("totalRecords",_.totalRecords)("rows",_.rowsPerPage)("first",_.pagination.start)("rowsPerPageOptions",_.rowsPerPageOptions)("sortField",_.sort.field)("sortOrder",_.sort.order)("resizableColumns",!0),Te("selection",_.selectedRows),l("lazy",!0)("lazyLoadOnInit",!1)("selectionPageOnly",!0)("showCurrentPageReport",!0)("currentPageReportTemplate",_.getPaginationTemplate())("expandedRowKeys",_.expandedRows)("ngClass",X(17,hg,_.loading)));},dependencies:[de,ve,be,Ae,Fe,tn,ft,he,Lt,$t,le,Re,B,tt,nt,dt,$e,Mt,x_,Di,Ue,Ne,Ri,D_,ye,Le,Tt],styles:["my-embed[_ngcontent-%COMP%]{display:block;max-width:500px;width:50%}.pt-badge[_ngcontent-%COMP%]{margin-inline-end:.3125rem}.video-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex}.video-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{width:16px;position:relative;top:-2px;margin-inline-start:.1875rem}.loading[_ngcontent-%COMP%]{opacity:.5}.right-form[_ngcontent-%COMP%]{display:flex}.right-form[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(:last-child){margin-inline-end:.625rem}"]}));var Cr=Bo;var kl=[{path:"videos",canActivate:[De],data:{userRight:Q.SEE_ALL_VIDEOS},children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:Cr,data:{meta:{title:"\u5F71\u7247\u6E05\u55AE"}}}]}];var zl=[...Ll,...Vl,...kl];var _2=[{path:"",component:rr,providers:[Fi,jt,nl,Rn,Hn,vi,fo,on,Pn,Ao,Ro,Vt,rn,yi,jt,Xo,jn,Kn,pt,v_,w_,U_,G_,y_,H_],children:[{path:"",redirectTo:"users",pathMatch:"full"},...yl,...zl,...Al,...vl,...Ol,...Fl]}];export{_2 as default};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/