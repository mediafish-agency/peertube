import{a as Io}from"./chunk-VHK64JUH.js";import{b as fo,c as Eo,d as Po}from"./chunk-WLZVZYNX.js";import{a as So}from"./chunk-KXFPPJ76.js";import{a as Jn}from"./chunk-X5HB26GE.js";import{a as To,b as mo,c as uo,d as po,e as Mo,f as Oo,g as Ao,h as Fe}from"./chunk-HSMLP335.js";import"./chunk-XGXRY5NY.js";import{c as Co}from"./chunk-IA75VPMY.js";import{a as go}from"./chunk-OOKZXLTV.js";import{a as co}from"./chunk-RY6C3VVE.js";import{a as yo}from"./chunk-DBRTOSQ5.js";import{a as Ro,b as vo}from"./chunk-4G4LA24F.js";import{a as yt,h as Ut,i as bt,j as Yt,p as $t,q as No}from"./chunk-VPUMNBNK.js";import"./chunk-XIGDB2RN.js";import{e as ro,f as _o,g as lo}from"./chunk-FDM4WNGU.js";import"./chunk-24QQSIIJ.js";import"./chunk-FCT3LKDI.js";import{a as vt}from"./chunk-K67EGD4G.js";import{a as ht}from"./chunk-LQ3CTFST.js";import"./chunk-SPKU4WOP.js";import{a as so}from"./chunk-JPIRBOZL.js";import"./chunk-EBTUWTIZ.js";import{a as qn,b as Qn}from"./chunk-FNNJJWLI.js";import"./chunk-3VYEMMNL.js";import{a as Zn}from"./chunk-FAZZDQFH.js";import"./chunk-XLVZGSUB.js";import{a as jn}from"./chunk-IFUKAL2P.js";import"./chunk-FOKVUJB6.js";import"./chunk-LUFSC2DY.js";import"./chunk-CNM6TRJ3.js";import"./chunk-X6JWC5WV.js";import{c as ao}from"./chunk-GP5LX4CA.js";import{a as Le}from"./chunk-4V7EB4W6.js";import"./chunk-KG4UYECH.js";import{b as Oe}from"./chunk-NO6VG5DO.js";import"./chunk-UDQ7P63C.js";import"./chunk-6C7DPHTS.js";import"./chunk-7HXKHM3O.js";import"./chunk-4XL6BJ7M.js";import{a as Kn}from"./chunk-GOWSOB6U.js";import"./chunk-RBCGTDIC.js";import"./chunk-DPQ4XGHN.js";import{B as $e,r as xn}from"./chunk-XEFO2OX5.js";import{a as w}from"./chunk-WRZZAQTV.js";import{d as eo,f as It,g as to,h as Rt,j as no,n as oo,o as io}from"./chunk-5CNYD3QV.js";import{b as oe,c as Ne}from"./chunk-RZGVOE4L.js";import{A as ne,c as gt,f as G,g as Z,k as pe,l as J,o as ee,r as te,s as Un,t as bn,u as Yn,z as X}from"./chunk-AHXSH3AS.js";import{$ as Ae,$a as Pn,$d as Ln,Ab as Y,B as _e,Bb as K,C as Nn,Ca as a,D as gn,Da as m,Eb as le,Ec as vn,Fb as ce,Gb as Ce,Ib as S,Jb as In,Kb as Se,Kc as Ot,La as H,Ne as St,Oa as p,Oe as ft,Of as we,Pf as Dn,Qf as ie,R as An,Sa as c,Sb as q,T as Sn,Tb as rn,Ub as Te,Ue as Ee,Vf as zn,Wb as Rn,Wf as Bn,Xf as Vn,Y as ut,Ya as me,Za as fn,Ze as Gn,_a as En,_c as yn,ab as r,ad as hn,ae as an,ba as A,bb as i,bd as Nt,cb as d,db as O,eb as N,fg as $,gb as h,gg as Pt,hg as F,i as pn,ib as z,j as mt,jb as B,kb as l,kd as At,la as f,lb as ae,ld as _n,lg as Wn,m as Mn,ma as E,mb as se,md as $n,nd as de,oa as pt,ob as M,pb as T,pc as Ye,qc as Mt,qe as Fn,r as ve,rc as b,rd as wn,rg as Hn,tf as Et,uf as Xn,ug as V,vb as he,vd as fe,vf as kn,wb as Ue,x as On,xb as be,xd as Me,yc as ue,za as ye,zb as I}from"./chunk-4A7FW7VV.js";import"./chunk-BERSDMCF.js";import"./chunk-ONF7AOBQ.js";import{j as s,k as Re}from"./chunk-K6ICEIKK.js";var xe=class xe{};s(xe,"\u0275fac",function(e){return new(e||xe)();}),s(xe,"\u0275cmp",A({type:xe,selectors:[["my-account-abuses-list"]],standalone:!0,features:[S],decls:5,vars:0,consts:()=>{let t;return t="Rapports",[t,["iconName","flag","aria-hidden","true"],["viewType","user"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",1),O(2),l(3,0),N(),i(),d(4,"my-abuse-list-table",2));},dependencies:[w,To],encapsulation:2}));var wt=xe;var Ge=class Ge{constructor(t,e,n,o,C){this.authService=t;this.scopedTokensService=e;this.videoService=n;this.notifier=o;this.confirmService=C;s(this,"feedUrl");s(this,"feedToken");s(this,"baseURL",Ee.originServerUrl||window.location.origin);}ngOnInit(){this.feedUrl=this.baseURL,this.scopedTokensService.getScopedTokens().subscribe({next:t=>this.regenApplications(t),error:t=>this.notifier.error(t.message)});}renewToken(){return Re(this,null,function*(){(yield this.confirmService.confirm("Le renouvellement du jeton emp\xEAchera les clients pr\xE9c\xE9demment configur\xE9s de r\xE9cup\xE9rer le flux tant qu'ils n'auront pas utilis\xE9 le nouveau jeton. Poursuivre ?","Renouveler le jeton"))!==!1&&this.scopedTokensService.renewScopedTokens().subscribe({next:e=>{this.regenApplications(e),this.notifier.success("Token renouvel\xE9. Mettez \xE0 jour la configuration de vos clients en cons\xE9quence.");},error:e=>this.notifier.error(e.message)});});}regenApplications(t){let e=this.authService.getUser(),n=this.videoService.getVideoSubscriptionFeedUrls(e.account.id,t.feedToken);this.feedUrl=this.baseURL+n.find(o=>o.format===$n.RSS).url,this.feedToken=t.feedToken;}};s(Ge,"\u0275fac",function(e){return new(e||Ge)(m(F),m(Wn),m(ao),m($),m(we));}),s(Ge,"\u0275cmp",A({type:Ge,selectors:[["my-account-applications"]],standalone:!0,features:[S],decls:22,vars:8,consts:()=>{let t;t="Renouveler le jeton";let e;e="Les applications";let n;n="FLUX D'ABONNEMENT";let o;o="Utilisez des agr\xE9gateurs de flux tiers pour r\xE9cup\xE9rer la liste des vid\xE9os des cha\xEEnes auxquelles vous \xEAtes abonn\xE9.";let C;C="URL du flux";let u;u="Jeton du flux";let g;return g="\u26A0\uFE0F Ne partagez jamais votre jeton de flux avec qui que ce soit.",[e,n,o,C,u,g,["iconName","codesandbox","aria-hidden","true"],[1,"pt-two-cols"],[1,"title-col"],[1,"applications-description"],[1,"content-col"],[1,"form-group"],["for","feed-url"],[3,"value","withToggle","withCopy","show","readonly"],["for","feed-token"],[3,"value","withCopy","readonly"],[1,"form-group-description"],["type","submit","value",t,1,"peertube-button","orange-button","mt-4",3,"click"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",6),O(2),l(3,0),N(),i(),r(4,"div",7)(5,"div",8)(6,"h2"),l(7,1),i(),r(8,"div",9),l(9,2),i()(),r(10,"div",10)(11,"div",11)(12,"label",12),l(13,3),i(),d(14,"my-input-text",13),i(),r(15,"div",11)(16,"label",14),l(17,4),i(),d(18,"my-input-text",15),r(19,"div",16),l(20,5),i()(),r(21,"input",17),M("click",function(){return n.renewToken();}),i()()()),e&2&&(a(14),c("value",n.feedUrl)("withToggle",!1)("withCopy",!0)("show",!0)("readonly",!0),a(4),c("value",n.feedToken)("withCopy",!0)("readonly",!0));},dependencies:[w,Oe],styles:[".pt-two-cols[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]{max-width:500px}"]}));var Lt=Ge;var Q=class Q{constructor(t,e){this.authHttp=t;this.restExtractor=e;}listAvailable(t){let e=Q.BASE_AUTOMATIC_TAGS_URL+"accounts/"+t.accountName+"/available";return this.authHttp.get(e).pipe(_e(n=>this.restExtractor.handleError(n)));}getCommentPolicies(t){let e=Q.BASE_AUTOMATIC_TAGS_URL+"policies/accounts/"+t.accountName+"/comments";return this.authHttp.get(e).pipe(_e(n=>this.restExtractor.handleError(n)));}updateCommentPolicies(t){let e=Q.BASE_AUTOMATIC_TAGS_URL+"policies/accounts/"+t.accountName+"/comments";return this.authHttp.put(e,{review:t.review}).pipe(_e(n=>this.restExtractor.handleError(n)));}};s(Q,"BASE_AUTOMATIC_TAGS_URL",Ee.apiUrl+"/api/v1/automatic-tags/"),s(Q,"\u0275fac",function(e){return new(e||Q)(Ae(Ot),Ae(Pt));}),s(Q,"\u0275prov",ut({token:Q,factory:Q.ɵfac,providedIn:"root"}));var Ft=Q;function $o(_,t){if(_&1){let e=h();r(0,"div",4)(1,"my-peertube-checkbox",5),Ce("ngModelChange",function(o){let C=f(e).$implicit;return ce(C.review,o)||(C.review=o),E(o);}),M("ngModelChange",function(){f(e);let o=T();return E(o.updatePolicies());}),i()();}if(_&2){let e=t.$implicit,n=t.$index,o=T();a(),c("inputName","tag-"+n),le("ngModel",e.review),c("labelText",o.getLabelText(e));}}var Xe=class Xe{constructor(t,e,n){this.authService=t;this.autoTagsService=e;this.notifier=n;s(this,"tags",[]);}ngOnInit(){this.loadAvailableTags();}getLabelText(t){return t.name==="external-link"?"That contain an external link":"That contain any word from your \""+t.name+"\" watched word list";}updatePolicies(){let t=this.authService.getUser().account.name;this.autoTagsService.updateCommentPolicies({accountName:t,review:this.tags.filter(e=>e.review).map(e=>e.name)}).subscribe({next:()=>{this.notifier.success("Comment policies updated");},error:e=>this.notifier.error(e.message)});}loadAvailableTags(){let t=this.authService.getUser().account.name;ve([this.autoTagsService.listAvailable({accountName:t}),this.autoTagsService.getCommentPolicies({accountName:t})]).subscribe(([e,n])=>{this.tags=e.available.map(o=>({name:o.name,type:o.type,review:n.review.includes(o.name)}));});}};s(Xe,"\u0275fac",function(e){return new(e||Xe)(m(F),m(Ft),m($));}),s(Xe,"\u0275cmp",A({type:Xe,selectors:[["ng-component"]],standalone:!0,features:[S],decls:8,vars:0,consts:()=>{let t;t="Your automatic tag policies";let e;return e="Automatically block comments:",[t,e,["iconName","no","aria-hidden","true"],[1,"d-block","mb-3"],[1,"form-group","ms-3"],[3,"ngModelChange","inputName","ngModel","labelText"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",2),O(2),l(3,0),N(),i(),r(4,"strong",3),l(5,1),i(),En(6,$o,2,3,"div",4,fn)),e&2&&(a(6),Pn(n.tags));},dependencies:[w,X,G,pe,Le],encapsulation:2}));var xt=Xe;function xo(_,t){if(_&1){let e=h();r(0,"div",13)(1,"div",14)(2,"my-advanced-input-filter",15),M("search",function(o){f(e);let C=T();return E(C.onSearch(o));}),i()()();}}function Go(_,t){if(_&1&&(r(0,"tr")(1,"th",16),l(2,1),i(),r(3,"th",17),l(4,2),i(),r(5,"th",18),z(6,3),d(7,"p-sortIcon",19),B(),i()()),_&2){let e=T();a(5),c("ngbTooltip",e.sortTooltip);}}function Xo(_,t){if(_&1){let e=h();r(0,"tr")(1,"td",20)(2,"button",21),M("click",function(){let o=f(e).$implicit,C=T();return E(C.unblockAccount(o));}),l(3,4),i()(),r(4,"td")(5,"a",22)(6,"div",23),d(7,"my-actor-avatar",24),r(8,"div"),I(9),r(10,"span",25),I(11),i()()()()(),r(12,"td"),I(13),q(14,"date"),i()();}if(_&2){let e=t.$implicit;a(5),c("href",e.blockedAccount.url,ye),a(2),c("actor",e.blockedAccount),a(2),K(" ",e.blockedAccount.displayName," "),a(2),Y(e.blockedAccount.nameWithHost),a(2),Y(Te(14,5,e.createdAt,"short"));}}function ko(_,t){_&1&&(O(0),l(1,5),N());}function Do(_,t){_&1&&(O(0),l(1,6),N());}function zo(_,t){if(_&1&&(r(0,"tr")(1,"td",26)(2,"div",27),p(3,ko,2,0,"ng-container",28)(4,Do,2,0,"ng-container",28),i()()()),_&2){let e=T();a(3),c("ngIf",e.search),a(),c("ngIf",!e.search);}}var Pe=class Pe extends mo{constructor(){super(...arguments);s(this,"mode",0);}getIdentifier(){return"MyAccountBlocklistComponent";}};s(Pe,"\u0275fac",(()=>{let e;return function(o){return(e||(e=pt(Pe)))(o||Pe);};})()),s(Pe,"\u0275cmp",A({type:Pe,selectors:[["my-account-blocklist"]],standalone:!0,features:[H,S],decls:9,vars:11,consts:()=>{let e;e="Comptes silenc\xE9s";let n;n="Action";let o;o="Comptes";let C;C="Silenc\xE9 le "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let u;u="Ouvrir le compte dans un nouvel onglet";let g;g="R\xE9tablir";let P;P="Aucun compte ne correspond aux crit\xE8res.";let k;return k="Aucun compte trouv\xE9.",[e,n,o,C,g,P,k,["iconName","user-x","aria-hidden","true"],[3,"onLazyLoad","value","lazy","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"caption"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","grey-button",3,"click"],["title",u,"target","_blank","rel","noopener noreferrer",3,"href"],[1,"chip","two-lines"],["actorType","account","size","32",3,"actor"],[1,"muted"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(n,o){n&1&&(r(0,"h1"),d(1,"my-global-icon",7),O(2),l(3,0),N(),i(),r(4,"p-table",8),M("onLazyLoad",function(u){return o.loadLazy(u);}),p(5,xo,3,0,"ng-template",9)(6,Go,8,1,"ng-template",10)(7,Xo,15,8,"ng-template",11)(8,zo,5,2,"ng-template",12),i()),n&2&&(a(4),c("value",o.blockedAccounts)("lazy",!0)("paginator",o.totalRecords>0)("totalRecords",o.totalRecords)("rows",o.rowsPerPage)("rowsPerPageOptions",o.rowsPerPageOptions)("first",o.pagination.start)("sortField",o.sort.field)("sortOrder",o.sort.order)("showCurrentPageReport",!0)("currentPageReportTemplate",o.getPaginationTemplate()));},dependencies:[w,$t,Ut,St,bt,Yt,ft,ht,$e,Kn,yt,b,ue],encapsulation:2}));var Gt=Pe;function Bo(_,t){if(_&1){let e=h();r(0,"div",16)(1,"div",17)(2,"button",18),M("click",function(){f(e);let o=T();return E(o.addServersToBlock());})("key.enter",function(){f(e);let o=T();return E(o.addServersToBlock());}),d(3,"my-global-icon",19),O(4),l(5,2),N(),i()(),r(6,"div",20)(7,"my-advanced-input-filter",21),M("search",function(o){f(e);let C=T();return E(C.onSearch(o));}),i()()();}}function Vo(_,t){if(_&1&&(r(0,"tr")(1,"th",22),l(2,3),i(),r(3,"th",23),l(4,4),i(),r(5,"th",24),z(6,5),d(7,"p-sortIcon",25),B(),i()()),_&2){let e=T();a(5),c("ngbTooltip",e.sortTooltip);}}function Wo(_,t){if(_&1){let e=h();r(0,"tr")(1,"td",26)(2,"button",27),M("click",function(){let o=f(e).$implicit,C=T();return E(C.unblockServer(o));}),l(3,6),i()(),r(4,"td")(5,"a",28),I(6),d(7,"my-global-icon",29),i()(),r(8,"td"),I(9),q(10,"date"),i()();}if(_&2){let e=t.$implicit;a(5),c("href","https://"+e.blockedServer.host,ye),a(),K(" ",e.blockedServer.host," "),a(3),Y(Te(10,3,e.createdAt,"short"));}}function Ho(_,t){_&1&&(O(0),l(1,7),N());}function Ko(_,t){_&1&&(O(0),l(1,8),N());}function jo(_,t){if(_&1&&(r(0,"tr")(1,"td",30)(2,"div",31),p(3,Ho,2,0,"ng-container",32)(4,Ko,2,0,"ng-container",32),i()()()),_&2){let e=T();a(3),c("ngIf",e.search),a(),c("ngIf",!e.search);}}var Ie=class Ie extends po{constructor(){super(...arguments);s(this,"mode",0);}getIdentifier(){return"MyAccountServerBlocklistComponent";}};s(Ie,"\u0275fac",(()=>{let e;return function(o){return(e||(e=pt(Ie)))(o||Ie);};})()),s(Ie,"\u0275cmp",A({type:Ie,selectors:[["my-account-server-blocklist"]],standalone:!0,features:[H,S],decls:11,vars:12,consts:()=>{let e;e="Masquer des domaines";let n;n="Serveurs ignor\xE9s";let o;o="Masquer un domaine";let C;C="Action";let u;u="Instance";let g;g="Silenc\xE9 le "+"\uFFFD#7\uFFFD"+""+"\uFFFD/#7\uFFFD"+"";let P;P="Ouvrir l'instance dans une nouvelle fen\xEAtre";let k;k="R\xE9tablir";let v;v="Aucun serveur ne correspond aux crit\xE8res actuels.";let j;return j="Aucun serveur trouv\xE9.",[["batchDomainsModal",""],n,o,C,u,g,k,v,j,["iconName","peertube-x","aria-hidden","true"],[3,"onLazyLoad","value","paginator","totalRecords","rows","rowsPerPageOptions","first","sortField","sortOrder","lazy","lazyLoadOnInit","showCurrentPageReport","currentPageReportTemplate"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["action",e,3,"domains"],[1,"caption"],[1,"left-buttons"],[1,"peertube-create-button",3,"click","key.enter"],["iconName","add","aria-hidden","true"],[1,"ms-auto"],[3,"search"],["scope","col",2,"width","150px"],["scope","col"],["scope","col","container","body","pSortableColumn","createdAt",2,"width","150px",3,"ngbTooltip"],["field","createdAt"],[1,"action-cell"],[1,"peertube-button","grey-button",3,"click"],["title",P,"target","_blank","rel","noopener noreferrer",3,"href"],["iconName","external-link"],["myAutoColspan",""],[1,"no-results"],[4,"ngIf"]];},template:function(n,o){if(n&1){let C=h();r(0,"h1"),d(1,"my-global-icon",9),O(2),l(3,1),N(),i(),r(4,"p-table",10),M("onLazyLoad",function(g){return f(C),E(o.loadLazy(g));}),p(5,Bo,8,0,"ng-template",11)(6,Vo,8,1,"ng-template",12)(7,Wo,11,6,"ng-template",13)(8,jo,5,2,"ng-template",14),i(),r(9,"my-batch-domains-modal",15,0),M("domains",function(g){return f(C),E(o.onDomainsToBlock(g));}),i();}n&2&&(a(4),c("value",o.blockedServers)("paginator",o.totalRecords>0)("totalRecords",o.totalRecords)("rows",o.rowsPerPage)("rowsPerPageOptions",o.rowsPerPageOptions)("first",o.pagination.start)("sortField",o.sort.field)("sortOrder",o.sort.order)("lazy",!0)("lazyLoadOnInit",!1)("showCurrentPageReport",!0)("currentPageReportTemplate",o.getPaginationTemplate()));},dependencies:[w,$t,Ut,St,bt,Yt,ft,ht,$e,yt,b,uo,ue],styles:[".moderation-expanded[_ngcontent-%COMP%]{font-size:90%;display:flex;flex-wrap:wrap;justify-content:space-between}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;vertical-align:top;text-align:end;min-width:100px;margin-inline-end:.3125rem}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]{display:inline-flex;word-wrap:break-word}.moderation-expanded[_ngcontent-%COMP%]   .moderation-expanded-text[_ngcontent-%COMP%]     p:last-child{margin-bottom:0!important}.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:50%;max-width:500px}@media screen and (max-width: 960px){.moderation-expanded[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%}}my-action-dropdown.show[_ngcontent-%COMP%]     .dropdown-root{display:block!important}.table-comment-link[_ngcontent-%COMP%], .table-account-link[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}.table-comment-link[_ngcontent-%COMP%]:focus:not(:focus-visible), .table-account-link[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}.table-comment-link[_ngcontent-%COMP%]     p:last-child, .table-account-link[_ngcontent-%COMP%]     p:last-child{margin:0}.table-account-link[_ngcontent-%COMP%]{display:flex;flex-direction:column}my-abuse-details[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 960px){.abuse-messages[_ngcontent-%COMP%]{justify-content:flex-start!important}}","a[_ngcontent-%COMP%]{display:inline-block}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:active{text-decoration:none!important}a[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--mainForegroundColor)}a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:80%;color:var(--inputPlaceholderColor)}"]}));var Xt=Ie;var ke=class ke{};s(ke,"\u0275fac",function(e){return new(e||ke)();}),s(ke,"\u0275cmp",A({type:ke,selectors:[["ng-component"]],standalone:!0,features:[S],decls:5,vars:0,consts:()=>{let t;return t="Comments on your videos",[t,["iconName","message-circle","aria-hidden","true"],["mode","user"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",1),O(2),l(3,0),N(),i(),d(4,"my-video-comment-list-admin-owner",2));},dependencies:[w,Ao],encapsulation:2}));var kt=ke;var W=class W{constructor(t,e,n){this.authHttp=t;this.restExtractor=e;this.server=n;}listUserExports(t){let{userId:e}=t,n=W.BASE_USER_EXPORTS_URL+e+"/exports";return this.authHttp.get(n).pipe(_e(o=>this.restExtractor.handleError(o)));}requestNewUserExport(t){let{userId:e,withVideoFiles:n}=t,o=W.BASE_USER_EXPORTS_URL+e+"/exports/request";return this.authHttp.post(o,{withVideoFiles:n}).pipe(_e(C=>this.restExtractor.handleError(C)));}deleteUserExport(t){let{userId:e,userExportId:n}=t,o=W.BASE_USER_EXPORTS_URL+e+"/exports/"+n;return this.authHttp.delete(o).pipe(_e(C=>this.restExtractor.handleError(C)));}getLatestImport(t){let{userId:e}=t,n=W.BASE_USER_IMPORTS_URL+e+"/imports/latest";return ve([this.authHttp.get(n),this.server.getServerLocale()]).pipe(Mn(([o,C])=>(o.state.label=Fn(o.state.label,C),o)),_e(o=>o.status===de.NOT_FOUND_404?mt(void 0):this.restExtractor.handleError(o)));}};s(W,"BASE_USER_EXPORTS_URL",Ee.apiUrl+"/api/v1/users/"),s(W,"BASE_USER_IMPORTS_URL",Ee.apiUrl+"/api/v1/users/"),s(W,"\u0275fac",function(e){return new(e||W)(Ae(Ot),Ae(Pt),Ae(ie));}),s(W,"\u0275prov",ut({token:W,factory:W.ɵfac}));var re=W;function qo(_,t){_&1&&(r(0,"p"),l(1,16),i());}function Qo(_,t){if(_&1&&(r(0,"div",27)(1,"div")(2,"strong"),I(3,"Latest import on:"),i(),I(4),q(5,"date"),i(),r(6,"div")(7,"strong"),I(8,"Latest import state:"),i(),I(9),i()()),_&2){let e=T(2);a(4),K(" ",Te(5,2,e.latestImport.createdAt,"medium")," "),a(5),K(" ",e.latestImport.state.label," ");}}function Zo(_,t){_&1&&(r(0,"div",26),l(1,17),i());}function Jo(_,t){_&1&&(r(0,"div",26),l(1,19),i());}function ei(_,t){if(_&1){let e=h();r(0,"my-upload-progress",28),M("cancel",function(){f(e);let o=T(2);return E(o.cancelUpload());})("retry",function(){f(e);let o=T(2);return E(o.retryUpload());}),i(),p(1,Jo,2,0,"div",29),r(2,"div",30)(3,"span"),l(4,18),i(),r(5,"input",31),M("change",function(o){f(e);let C=T(2);return E(C.onFileChange(o));}),i()();}if(_&2){let e=T(2);c("isUploading",e.uploadingArchive)("uploadPercents",e.uploadPercents)("error",e.error)("uploaded",e.archiveUploadFinished)("enableRetryAfterError",e.enableRetryAfterError),a(),c("ngIf",e.archiveUploadFinished&&!e.error),a(),c("hidden",e.uploadingArchive||e.archiveUploadFinished);}}function ti(_,t){if(_&1&&(r(0,"p"),l(1,1),i(),r(2,"p"),z(3,2),d(4,"strong"),B(),i(),r(5,"p"),l(6,3),i(),r(7,"ul")(8,"li"),l(9,4),i(),r(10,"li"),l(11,5),i(),r(12,"li"),l(13,6),i(),r(14,"li"),l(15,7),i(),r(16,"li"),l(17,8),i(),r(18,"li"),l(19,9),i(),r(20,"li"),l(21,10),i(),r(22,"li"),l(23,11),i(),r(24,"li"),z(25,12),d(26,"strong"),B(),i()(),r(27,"p"),l(28,13),i(),r(29,"ul")(30,"li"),l(31,14),i(),r(32,"li"),l(33,15),i()(),p(34,qo,2,0,"p",24)(35,Qo,10,5,"div",25)(36,Zo,2,0,"div",26)(37,ei,6,7)),_&2){let e=T();a(34),c("ngIf",e.isEmailEnabled()),a(),c("ngIf",e.latestImport),a(),me(e.hasPendingImport()?36:37);}}function ni(_,t){_&1&&(r(0,"p"),l(1,20),i());}var De=class De{constructor(t,e,n,o,C){this.authService=t;this.server=e;this.userImportExportService=n;this.resumableUploadService=o;this.notifier=C;s(this,"videoQuotaUsed");s(this,"uploadingArchive",!1);s(this,"archiveUploadFinished",!1);s(this,"error");s(this,"enableRetryAfterError");s(this,"uploadPercents",0);s(this,"latestImport");s(this,"fileToUpload");s(this,"uploadServiceSubscription");s(this,"alreadyRefreshedToken",!1);}ngOnInit(){this.userImportExportService.getLatestImport({userId:this.authService.getUser().id}).subscribe(t=>this.latestImport=t),this.uploadServiceSubscription=this.resumableUploadService.events.subscribe(t=>this.onUploadOngoing(t));}ngOnDestroy(){this.resumableUploadService.disconnect(),this.uploadServiceSubscription&&this.uploadServiceSubscription.unsubscribe();}canDeactivate(){return{canDeactivate:!this.uploadingArchive,text:"Votre fichier d'archive n'est pas encore t\xE9l\xE9vers\xE9, \xEAtes-vous s\xFBr de vouloir quitter cette page\u202F?"};}isImportEnabled(){return this.server.getHTMLConfig().import.users.enabled;}isEmailEnabled(){return this.server.getHTMLConfig().email.enabled;}onUploadOngoing(t){switch(t.status){case"error":{if(!this.alreadyRefreshedToken&&t.responseStatus===de.UNAUTHORIZED_401)return this.alreadyRefreshedToken=!0,this.refreshTokenAndRetryUpload();this.handleUploadError(kn(t));break;}case"cancelled":this.uploadingArchive=!1,this.uploadPercents=0,this.enableRetryAfterError=!1,this.error="";break;case"uploading":this.uploadPercents=t.progress;break;case"complete":this.archiveUploadFinished=!0,this.uploadPercents=100,this.uploadingArchive=!1;break;}}onFileChange(t){let e=t.target,n=e.files[0];if(!n)return;let o=this.authService.getUser();if(o.videoQuota!==-1&&this.videoQuotaUsed+n.size>o.videoQuota){let C=new vt(),u=C.transform(n.size,0),g=C.transform(this.videoQuotaUsed,0),P=C.transform(o.videoQuota,0);this.notifier.error("Impossible d'importer ce fichier car votre quota de vid\xE9o serait d\xE9pass\xE9 (taille de l'import\u202F: "+u+", quota utilis\xE9: "+g+", quota disponible\u202F: "+P+")"),e.value="";return;}this.fileToUpload=n,this.uploadFile(n);}cancelUpload(){this.resumableUploadService.control({action:"cancel"});}retryUpload(){this.enableRetryAfterError=!1,this.error="",this.uploadFile(this.fileToUpload);}hasPendingImport(){if(!this.latestImport)return!1;let t=this.latestImport.state.id;return t===_n.PENDING||t===_n.PROCESSING;}uploadFile(t){this.resumableUploadService.handleFiles(t,{endpoint:`${re.BASE_USER_IMPORTS_URL}${this.authService.getUser().id}/imports/import-resumable`,multiple:!1,maxChunkSize:this.server.getHTMLConfig().client.videos.resumableUpload.maxChunkSize,token:this.authService.getAccessToken(),uploaderClass:fo,retryConfig:Xn(),metadata:{filename:t.name}}),this.uploadingArchive=!0;}handleUploadError(t){this.uploadPercents=0,this.enableRetryAfterError=!0,this.error=Et({err:t,name:"archive",notifier:this.notifier,sticky:!1}),t.status===de.UNSUPPORTED_MEDIA_TYPE_415&&this.cancelUpload();}refreshTokenAndRetryUpload(){this.authService.refreshAccessToken().subscribe(()=>this.retryUpload());}};s(De,"\u0275fac",function(e){return new(e||De)(m(F),m(ie),m(re),m(Eo),m($));}),s(De,"\u0275cmp",A({type:De,selectors:[["my-account-import"]],inputs:{videoQuotaUsed:"videoQuotaUsed"},standalone:!0,features:[S],decls:7,vars:1,consts:()=>{let t;t="IMPORT";let e;e="Vous pouvez importer une archive cr\xE9\xE9e depuis un autre site web PeerTube.";let n;n="Il s'agit d'un outil "+"\uFFFD#4\uFFFD"+"d'importation"+"\uFFFD/#4\uFFFD"+" et non d'un outil de migration. C'est la raison pour laquelle les donn\xE9es (comme les cha\xEEnes ou les vid\xE9os) sont dupliqu\xE9es et non d\xE9plac\xE9es depuis votre ancien site PeerTube. ";let o;o="Le processus d'importation va automatiquement\u202F:";let C;C="Mettre \xE0 jour les m\xE9tadonn\xE9es de votre compte (nom d'affichage, description, avatar...)";let u;u="Mettre \xE0 jour vos param\xE8tres utilisateur-ice (politique de lecture automatique ou P2P, param\xE8tres de notification...). Elle ne met pas \xE0 jour votre adresse \xE9lectronique, votre nom d'utilisateur ou votre mot de passe.";let g;g="Ajouter les comptes/serveurs \xE0 votre liste de silenci\xE9s";let P;P="Ajouter les J'aime/Je n'aime pas";let k;k="Envoyer une demande de suivi \xE0 vos abonnements";let v;v="Cr\xE9er des cha\xEEnes si elles n'existent pas encore";let j;j="Cr\xE9er des listes de lecture si elles n'existent pas encore";let y;y="Ajouter les vid\xE9os regard\xE9es dans votre historique vid\xE9o";let ot;ot=""+"\uFFFD#26\uFFFD"+"Si l'archive contient des fichiers vid\xE9os"+"\uFFFD/#26\uFFFD"+", cr\xE9er les vid\xE9os si elles n'existent pas encore";let it;it="Les objets de donn\xE9es suivants ne sont pas import\xE9s\u202F:";let rt;rt="Commentaires";let _t;_t="Abonn\xE9s (les comptes devront suivre \xE0 nouveau vos cha\xEEnes)";let at;at="Un courriel sera envoy\xE9 lorsque le processus d'importation sera termin\xE9.";let st;st="Vous ne pouvez pas r\xE9-importer une archive parce que vous avez d\xE9j\xE0 une importation en cours de traitement par PeerTube.";let lt;lt="(extension: .zip)";let ct;ct="S\xE9lectionner le fichier \xE0 importer";let Ct;Ct="S\xE9lectionnez le fichier d'archive \xE0 importer";let Tt;Tt="T\xE9l\xE9versement termin\xE9. Votre importation d'archives sera trait\xE9e d\xE8s que possible.";let dt;return dt="L'importation d'utilisateurs\u22C5ices n'est pas activ\xE9e par votre administrateur\u22C5rice.",[t,e,n,o,C,u,g,P,k,v,j,y,ot,it,rt,_t,at,st,Ct,Tt,dt,[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],[4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"alert","pt-alert-primary"],[1,"mb-3"],[3,"cancel","retry","isUploading","uploadPercents","error","uploaded","enableRetryAfterError"],["class","alert pt-alert-primary",4,"ngIf"],["ngbTooltip",lt,1,"button-file","form-control",3,"hidden"],["aria-label",ct,"accept",".zip","id","importfile","type","file",3,"change"]];},template:function(e,n){e&1&&(r(0,"div",21)(1,"div",22)(2,"h2"),l(3,0),i()(),r(4,"div",23),p(5,ti,38,3)(6,ni,2,0,"p"),i()()),e&2&&(a(5),me(n.isImportEnabled()?5:6));},dependencies:[b,Po,$e,ue],styles:[".button-file[_ngcontent-%COMP%]{width:max-content;position:relative;overflow:hidden;display:inline-block;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}.button-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:100%;height:100%;font-size:100px;text-align:end;filter:alpha(opacity=0);opacity:0;outline:none;background:var(--mainBackgroundColor);cursor:inherit;display:block}.button-file[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}.button-file[_ngcontent-%COMP%]:focus, .button-file[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}.button-file[_ngcontent-%COMP%], .button-file[_ngcontent-%COMP%]:active, .button-file[_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}.button-file[_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}.button-file[disabled][_ngcontent-%COMP%], .button-file.disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}.button-file[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .button-file[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .button-file[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}.pt-alert-primary[_ngcontent-%COMP%]{width:fit-content}"]}));var Dt=De;var oi=["exportModal"];function ii(_,t){_&1&&(r(0,"p"),l(1,17),i());}function ri(_,t){if(_&1&&(O(0),I(1),q(2,"bytes"),N()),_&2){let e=T().$implicit;a(),Y(rn(2,1,e.size));}}function _i(_,t){if(_&1&&(O(0),I(1),q(2,"date"),N()),_&2){let e=T().$implicit;a(),Y(Te(2,1,e.expiresOn,"medium"));}}function ai(_,t){if(_&1&&(r(0,"a",37),l(1,22),i()),_&2){let e=T().$implicit;c("href",e.privateDownloadUrl,ye);}}function si(_,t){if(_&1&&(r(0,"tr")(1,"td"),I(2),q(3,"date"),i(),r(4,"td"),I(5),i(),r(6,"td"),p(7,ri,3,3,"ng-container",31),i(),r(8,"td"),p(9,_i,3,4,"ng-container",31),i(),r(10,"td"),p(11,ai,2,1,"a",36),i()()),_&2){let e=t.$implicit;a(2),Y(Te(3,5,e.createdAt,"medium")),a(3),Y(e.state.label),a(2),c("ngIf",e.size),a(2),c("ngIf",e.expiresOn),a(2),c("ngIf",e.privateDownloadUrl);}}function li(_,t){if(_&1&&(r(0,"table")(1,"tr")(2,"th",34),l(3,18),i(),r(4,"th",34),l(5,19),i(),r(6,"th",34),l(7,20),i(),r(8,"th",34),l(9,21),i(),d(10,"th"),i(),p(11,si,12,8,"tr",35),i()),_&2){let e=T(2);a(11),c("ngForOf",e.userExports);}}function ci(_,t){if(_&1){let e=h();r(0,"p"),l(1,2),i(),r(2,"ul")(3,"li"),l(4,3),i(),r(5,"li"),l(6,4),i(),r(7,"li"),l(8,5),i(),r(9,"li"),l(10,6),i(),r(11,"li"),l(12,7),i(),r(13,"li"),l(14,8),i(),r(15,"li"),l(16,9),i(),r(17,"li"),l(18,10),i(),r(19,"li"),l(20,11),i()(),r(21,"p"),l(22,12),i(),r(23,"ul")(24,"li"),l(25,13),i(),r(26,"li"),l(27,14),i(),r(28,"li"),l(29,15),i()(),r(30,"p"),l(31,16),i(),p(32,ii,2,0,"p")(33,li,12,1,"table",31),r(34,"div",32)(35,"input",33),M("click",function(){f(e);let o=T();return E(o.openNewArchiveModal());}),i()();}if(_&2){let e=T();a(32),me(e.isEmailEnabled()?32:-1),a(),c("ngIf",e.userExports&&e.userExports.length!==0),a(2),c("disabled",e.isRequestArchiveDisabled());}}function Ci(_,t){_&1&&(r(0,"p"),l(1,23),i());}function Ti(_,t){_&1&&(r(0,"div",50),l(1,26),i());}function di(_,t){if(_&1&&(r(0,"div",51),I(1),i()),_&2){let e=T(2);a(),Y(e.errorInModal);}}function mi(_,t){if(_&1&&(r(0,"div"),z(1,27),d(2,"strong"),q(3,"bytes"),B(),i()),_&2){let e=T(2);a(3),ae(rn(3,1,e.archiveWeightEstimation)),se(1);}}function ui(_,t){if(_&1){let e=h();r(0,"div",38)(1,"h4",39),l(2,24),i(),r(3,"button",40),M("click",function(){let o=f(e).close;return E(o());}),d(4,"my-global-icon",41),i()(),r(5,"div",42),p(6,Ti,2,0,"div",43)(7,di,2,1,"div",44),r(8,"my-peertube-checkbox",45),Ce("ngModelChange",function(o){f(e);let C=T();return ce(C.exportWithVideosFiles,o)||(C.exportWithVideosFiles=o),E(o);}),O(9,46),r(10,"div"),l(11,25),i(),p(12,mi,4,3,"div",31),N(),i()(),r(13,"div",47)(14,"input",48),M("click",function(){let o=f(e).close;return E(o());})("key.enter",function(){let o=f(e).close;return E(o());}),i(),r(15,"input",49),M("click",function(){f(e);let o=T();return E(o.requestNewArchive());}),i()();}if(_&2){let e=T();a(6),c("ngIf",e.hasAlreadyACompletedArchive()),a(),c("ngIf",e.errorInModal),a(),le("ngModel",e.exportWithVideosFiles),a(4),c("ngIf",e.archiveWeightEstimation);}}var ze=class ze{constructor(t,e,n,o){this.authService=t;this.server=e;this.userImportExportService=n;this.modalService=o;s(this,"exportModal");s(this,"videoQuotaUsed");s(this,"userExports",[]);s(this,"exportWithVideosFiles");s(this,"errorInModal");s(this,"archiveWeightEstimation");s(this,"exportModalOpened");s(this,"requestingArchive",!1);}ngOnInit(){this.archiveWeightEstimation=this.videoQuotaUsed,this.reloadUserExports();}isExportEnabled(){return this.server.getHTMLConfig().export.users.enabled;}isEmailEnabled(){return this.server.getHTMLConfig().email.enabled;}isRequestArchiveDisabled(){return this.userExports.some(t=>{let e=t.state.id;return e===At.PENDING||e===At.PROCESSING;});}hasAlreadyACompletedArchive(){return this.userExports.some(t=>t.state.id===At.COMPLETED);}openNewArchiveModal(){this.exportWithVideosFiles=!1,this.errorInModal=void 0,this.exportModalOpened=this.modalService.open(this.exportModal,{centered:!0});}requestNewArchive(){if(this.requestingArchive)return;this.requestingArchive=!0;let t=mt(!0);this.userExports.length!==0&&(t=pn(this.userExports.map(e=>e.id)).pipe(gn(e=>this.userImportExportService.deleteUserExport({userId:this.getUserId(),userExportId:e})),Nn())),t.pipe(An(()=>this.userImportExportService.requestNewUserExport({withVideoFiles:this.exportWithVideosFiles,userId:this.getUserId()}))).subscribe({next:()=>{this.reloadUserExports(),this.exportModalOpened.close(),this.requestingArchive=!1;},error:e=>{if(this.requestingArchive=!1,e.body.code===wn.MAX_USER_VIDEO_QUOTA_EXCEEDED_FOR_USER_EXPORT){this.errorInModal="Les fichiers vid\xE9o ne peuvent pas \xEAtre inclus dans l'exportation car vous avez d\xE9pass\xE9 le quota maximum de vid\xE9os autoris\xE9 par votre administrateur\u22C5rice pour exporter cette archive.";return;}this.errorInModal=e.message;}});}reloadUserExports(){this.isExportEnabled()&&this.userImportExportService.listUserExports({userId:this.authService.getUser().id}).subscribe(({data:t})=>this.userExports=t);}getUserId(){return this.authService.getUser().id;}};s(ze,"\u0275fac",function(e){return new(e||ze)(m(F),m(ie),m(re),m(xn));}),s(ze,"\u0275cmp",A({type:ze,selectors:[["my-account-export"]],viewQuery:function(e,n){if(e&1&&he(oi,7),e&2){let o;Ue(o=be())&&(n.exportModal=o.first);}},inputs:{videoQuotaUsed:"videoQuotaUsed"},standalone:!0,features:[S],decls:9,vars:1,consts:()=>{let t;t="EXPORT";let e;e="Demander une nouvelle archive";let n;n="Vous pouvez demander une archive de votre compte contenant\u202F:";let o;o="Les param\xE8tres de votre compte avec le fichier avatar";let C;C="Vos cha\xEEnes avec les fichiers de banni\xE8re et d'avatar";let u;u="Vos comptes et serveurs silenci\xE9s";let g;g="Vos commentaires";let P;P="Vos J'aime et Je n'aime pas";let k;k="Vos abonnements et abonn\xE9s";let v;v="Vos listes de lecture vid\xE9o avec vignettes";let j;j="Vos vid\xE9os avec vignettes et sous-titres. Les fichiers vid\xE9o peuvent \xE9galement \xEAtre inclus dans les archives";let y;y="Votre historique vid\xE9o";let ot;ot="Les donn\xE9es export\xE9es contiennent plusieurs dossiers\u202F:";let it;it="Un dossier contenant une exportation au format ActivityPub, lisible par n'importe quel logiciel compatible";let rt;rt="Un dossier contenant une exportation au format PeerTube JSON personnalis\xE9 qui peut \xEAtre utilis\xE9 pour r\xE9importer votre compte sur une autre instance PeerTube.";let _t;_t="Un dossier contenant des fichiers statiques (vignettes, avatars, fichiers vid\xE9o, etc.)";let at;at="Vous ne pouvez demander qu'une seule archive \xE0 la fois.";let st;st="Un courriel sera envoy\xE9 lorsque l'archive d'exportation sera disponible.";let lt;lt="Date";let ct;ct="Statut";let Ct;Ct="Taille";let Tt;Tt="Expire le";let dt;dt="T\xE9l\xE9chargez votre archive";let U;U="L'export utilisateur\u22C5ice n'est pas activ\xE9 par votre administrateur\u22C5rice.";let sn;sn="Fermer cette fen\xEAtre modale";let ln;ln="Inclure les fichiers vid\xE9os dans l'archive";let cn;cn="Annuler";let Cn;Cn="Demander une archive";let Tn;Tn="Param\xE8tres de l'archive";let dn;dn="L'inclusion des fichiers vid\xE9o est n\xE9cessaire si vous souhaitez r\xE9importer vos vid\xE9os sur un autre site web PeerTube";let mn;mn="Vous avez d\xE9j\xE0 une archive active. La demande d'une nouvelle archive d'exportation supprimera l'archive actuelle.";let un;return un="Si vous incluez les fichiers vid\xE9o, le fichier d'archive va peser "+"\uFFFD#2\uFFFD"+"approximativement "+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+"",[["exportModal",""],t,n,o,C,u,g,P,k,v,j,y,ot,it,rt,_t,at,st,lt,ct,Ct,Tt,dt,U,Tn,dn,mn,un,[1,"pt-two-cols"],[1,"title-col"],[1,"content-col"],[4,"ngIf"],[1,"mt-3"],["type","submit","value",e,1,"peertube-button","orange-button",3,"click","disabled"],["scope","column"],[4,"ngFor","ngForOf"],["class","peertube-button-link grey-button",3,"href",4,"ngIf"],[1,"peertube-button-link","grey-button",3,"href"],[1,"modal-header"],[1,"modal-title"],["title",sn,1,"border-0","p-0",3,"click"],["iconName","cross"],[1,"modal-body"],["class","alert alert-warning",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["inputName","exportWithVideos","labelText",ln,3,"ngModelChange","ngModel"],["ngProjectAs","description",5,["description"]],[1,"modal-footer","inputs"],["type","button","role","button","value",cn,1,"peertube-button","grey-button",3,"click","key.enter"],["type","submit","value",Cn,1,"peertube-button","orange-button",3,"click"],[1,"alert","alert-warning"],[1,"alert","alert-danger"]];},template:function(e,n){e&1&&(r(0,"div",28)(1,"div",29)(2,"h2"),l(3,1),i()(),r(4,"div",30),p(5,ci,36,3)(6,Ci,2,0,"p"),i()(),p(7,ui,16,4,"ng-template",null,0,Rn)),e&2&&(a(5),me(n.isExportEnabled()?5:6));},dependencies:[b,Mt,w,Le,X,G,pe,ue,vt],styles:["table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-inline-end:1rem}"]}));var zt=ze;var pi=["accountImport"],Be=class Be{constructor(t){this.userService=t;s(this,"accountImport");s(this,"videoQuotaUsed");}ngOnInit(){this.userService.getMyVideoQuotaUsed().subscribe(t=>this.videoQuotaUsed=t.videoQuotaUsed);}canDeactivate(){var t;return((t=this.accountImport)==null?void 0:t.canDeactivate())||{canDeactivate:!0};}};s(Be,"\u0275fac",function(e){return new(e||Be)(m(V));}),s(Be,"\u0275cmp",A({type:Be,selectors:[["my-account-import-export"]],viewQuery:function(e,n){if(e&1&&he(pi,5),e&2){let o;Ue(o=be())&&(n.accountImport=o.first);}},standalone:!0,features:[S],decls:7,vars:2,consts:()=>{let t;return t="Import/Export",[["accountImport",""],t,["iconName","cloud-download","aria-hidden","true"],[1,"d-block","mb-5",3,"videoQuotaUsed"],[3,"videoQuotaUsed"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",2),O(2),l(3,1),N(),i(),d(4,"my-account-import",3,0)(6,"my-account-export",4)),e&2&&(a(4),c("videoQuotaUsed",n.videoQuotaUsed),a(2),c("videoQuotaUsed",n.videoQuotaUsed));},dependencies:[w,Dt,zt],encapsulation:2}));var Bt=Be;var Mi=["userNotification"];function Oi(_,t){_&1&&(O(0),d(1,"my-global-icon",19),r(2,"span"),l(3,6),i(),N());}function Ni(_,t){_&1&&(O(0),d(1,"my-global-icon",20),r(2,"span"),l(3,7),i(),N());}var Ve=class Ve{constructor(){s(this,"userNotification");s(this,"_notificationSortType","createdAt");}get notificationSortType(){return this.hasUnreadNotifications()?this._notificationSortType:"createdAt";}set notificationSortType(t){this._notificationSortType=t;}markAllAsRead(){this.userNotification.markAllAsRead();}hasUnreadNotifications(){return this.userNotification.notifications.filter(t=>t.read===!1).length!==0;}onChangeSortColumn(){this.userNotification.changeSortColumn(this.notificationSortType);}};s(Ve,"\u0275fac",function(e){return new(e||Ve)();}),s(Ve,"\u0275cmp",A({type:Ve,selectors:[["ng-component"]],viewQuery:function(e,n){if(e&1&&he(Mi,7),e&2){let o;Ue(o=be())&&(n.userNotification=o.first);}},standalone:!0,features:[S],decls:20,vars:5,consts:()=>{let t;t="Notifications";let e;e="Pr\xE9f\xE9rences de notification";let n;n="Trier par";let o;o="Le plus r\xE9cent en premier";let C;C="Non lu d'abord";let u;u="Marquer tout comme lu";let g;return g="Tous lus",[["userNotification",""],t,e,n,o,C,u,g,[1,"visually-hidden"],[1,"header"],["routerLink","/my-account/settings","fragment","notifications",1,"peertube-button-link","grey-button"],["iconName","cog","aria-hidden","true"],[1,"peertube-select-container","peertube-select-button","ms-2","me-2"],[1,"form-control",3,"ngModelChange","ngModel"],["value","undefined","disabled",""],["value","createdAt"],["value","read",3,"disabled"],[1,"ms-auto","peertube-button","grey-button",3,"click","disabled"],[4,"ngIf"],["iconName","tick","aria-hidden","true"],["iconName","circle-tick","aria-hidden","true"]];},template:function(e,n){if(e&1){let o=h();r(0,"h1",8),l(1,1),i(),r(2,"div",9)(3,"a",10),d(4,"my-global-icon",11),r(5,"span"),l(6,2),i()(),r(7,"div",12)(8,"select",13),Ce("ngModelChange",function(u){return f(o),ce(n.notificationSortType,u)||(n.notificationSortType=u),E(u);}),M("ngModelChange",function(){return f(o),E(n.onChangeSortColumn());}),r(9,"option",14),l(10,3),i(),r(11,"option",15),l(12,4),i(),r(13,"option",16),l(14,5),i()()(),r(15,"button",17),M("click",function(){return f(o),E(n.markAllAsRead());}),p(16,Oi,4,0,"ng-container",18)(17,Ni,4,0,"ng-container",18),i()(),d(18,"my-user-notifications",null,0);}e&2&&(a(8),le("ngModel",n.notificationSortType),a(5),c("disabled",!n.hasUnreadNotifications()),a(2),c("disabled",!n.hasUnreadNotifications()),a(),c("ngIf",n.hasUnreadNotifications()),a(),c("ngIf",!n.hasUnreadNotifications()));},dependencies:[Nt,w,X,bn,Yn,Un,G,pe,b,Jn],styles:['.header[_ngcontent-%COMP%]{display:flex;margin-bottom:1.25rem}.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;display:inline-block;width:18px;top:-1px;margin-inline-end:.1875rem}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;display:inline-block;width:20px;top:-1px;margin-inline-end:.1875rem}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{padding:0;margin:0;width:auto;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;height:min-content}.header[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.header[_ngcontent-%COMP%]   .peertube-select-container.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{background-color:#f9f9f9}@media screen and (max-width: auto){.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:100%}}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:var(--mainForegroundColor);margin-top:-2px;z-index:100}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:15px;padding:3px 35px 3px 12px;position:relative;border:1px solid var(--inputBorderColor);background:transparent none;-webkit-appearance:none;appearance:none;text-overflow:ellipsis;color:var(--mainForegroundColor);line-height:23px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[value=undefined][_ngcontent-%COMP%]{font-weight:600}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]{background-color:var(--greyBackgroundColor);color:var(--greyForegroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #5858580d}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:hover, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:active, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]:focus, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:var(--greySecondaryBackgroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[disabled][_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.header[_ngcontent-%COMP%]   .peertube-select-container.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0;padding:4px 35px 4px 12px}@media screen and (max-width: 500px){.header[_ngcontent-%COMP%]{flex-direction:column}.header[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child, .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{margin-bottom:15px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{margin-inline-start:0!important}}@media screen and (min-width: 500px) and (max-width: 800px){.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:0;padding:0 13px}.header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:auto!important}}@media screen and (min-width: 500px) and (max-width: 1040px){.main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:0;padding:0 13px}.main-col:not(.expanded)[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .peertube-select-container[_ngcontent-%COMP%]{width:auto!important}}']}));var Vt=Ve;var We=class We{constructor(t,e,n,o,C){this.authService=t;this.notifier=e;this.userService=n;this.confirmService=o;this.redirectService=C;s(this,"user");}deleteMe(){return Re(this,null,function*(){(yield this.confirmService.confirmWithExpectedInput("\xCAtes-vous s\xFBr de vouloir supprimer votre compte ?"+"<br /><br />"+("Cela d\xE9truira toutes vos donn\xE9es, dont les cha\xEEnes, vid\xE9os, commentaires et vous ne pourrez pas cr\xE9er un\xB7e autre utilisateur\xB7e sur cette instance avec l'identifiant "+this.user.username+".")+"<br /><br />"+"Le contenu cach\xE9 par d'autres serveurs et d'autres entit\xE9s externes peut prendre plus de temps \xE0 \xEAtre supprim\xE9.","Tapez votre nom d'utilisateur\xB7ice pour confirmer",this.user.username,"Supprimer votre compte","Supprimer mon compte"))!==!1&&this.userService.deleteMe().subscribe({next:()=>{this.notifier.success("Votre compte est supprim\xE9."),this.authService.logout(),this.redirectService.redirectToHomepage();},error:e=>this.notifier.error(e.message)});});}};s(We,"\u0275fac",function(e){return new(e||We)(m(F),m($),m(V),m(we),m(zn));}),s(We,"\u0275cmp",A({type:We,selectors:[["my-account-danger-zone"]],inputs:{user:"user"},standalone:!0,features:[S],decls:5,vars:0,consts:()=>{let t;t="Une fois votre compte supprim\xE9, aucun retour en arri\xE8re n'est possible. Il vous sera demand\xE9 de confirmer cette action.";let e;return e="Supprimer votre compte",[t,e,[1,"delete-me"],[3,"click"]];},template:function(e,n){e&1&&(r(0,"div",2)(1,"p"),l(2,0),i(),r(3,"button",3),M("click",function(){return n.deleteMe();}),l(4,1),i()());},styles:[".delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px;background-color:#d56253;color:#fff6f5}.delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}.delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem #d562530d}.delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active, .delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .delete-me[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .delete-me[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#df877c}.delete-me[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%], .delete-me[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{cursor:default}.delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff6f5}.delete-me[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none!important}"]}));var Wt=We;var gi=_=>({"input-error":_});function Ai(_,t){if(_&1&&(r(0,"div",14),I(1),i()),_&2){let e=T();a(),Y(e.error);}}function Si(_,t){if(_&1&&(r(0,"div",15),I(1),i()),_&2){let e=T();a(),Y(e.success);}}function fi(_,t){if(_&1&&(r(0,"div",16),z(1,2),d(2,"strong"),B(),i()),_&2){let e=T();a(2),ae(e.user.pendingEmail),se(1);}}function Ei(_,t){if(_&1&&(r(0,"div",17),I(1),i()),_&2){let e=T();a(),K(" ",e.formErrors["new-email"]," ");}}var He=class He extends Ne{constructor(e,n,o,C){super();this.formReactiveService=e;this.authService=n;this.userService=o;this.serverService=C;s(this,"error");s(this,"success");s(this,"user");}ngOnInit(){this.buildForm({"new-email":eo,password:Rt}),this.user=this.authService.getUser();}changeEmail(){this.error=null,this.success=null;let e=this.form.value.password,n=this.form.value["new-email"];ve([this.serverService.getConfig(),this.userService.changeEmail(e,n)]).pipe(Sn(()=>this.authService.refreshUserInformation())).subscribe({next:([o])=>{this.form.reset(),o.signup.requiresEmailVerification?this.success="Veuillez v\xE9rifier vos courriels pour v\xE9rifier votre nouveau courriel.":this.success="Courriel mis \xE0 jour.";},error:o=>{if(o.status===de.UNAUTHORIZED_401){this.error="Votre mot de passe actuel est invalide.";return;}this.error=o.message;}});}};s(He,"\u0275fac",function(n){return new(n||He)(m(oe),m(F),m(V),m(ie));}),s(He,"\u0275cmp",A({type:He,selectors:[["my-account-change-email"]],standalone:!0,features:[H,S],decls:15,vars:11,consts:()=>{let e;e="Nouveau courriel";let n;n="Mot de passe actuel";let o;o="Changer le courriel";let C;C="Changer votre email";let u;u="Votre email actuel est "+"\uFFFD#9\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#9\uFFFD"+". Il n'est jamais montr\xE9 publiquement. ";let g;return g=""+"\uFFFD#2\uFFFD"+""+"\uFFFD0\uFFFD"+""+"\uFFFD/#2\uFFFD"+" est en attente de v\xE9rification d'email ",[C,u,g,["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","pending-email",4,"ngIf"],["role","form",1,"change-email",3,"ngSubmit","formGroup"],[1,"form-group"],["for","new-email"],[1,"form-group-description"],["type","email","id","new-email","placeholder",e,"formControlName","new-email",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["formControlName","password","id","password","placeholder",n,"autocomplete","current-password",3,"formError"],["type","submit","value",o,3,"disabled"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[1,"pending-email"],["role","alert",1,"form-error"]];},template:function(n,o){n&1&&(p(0,Ai,2,1,"div",3)(1,Si,2,1,"div",4)(2,fi,3,1,"div",5),r(3,"form",6),M("ngSubmit",function(){return o.changeEmail();}),r(4,"div",7)(5,"label",8),l(6,0),i(),r(7,"div",9),z(8,1),d(9,"strong"),B(),i(),d(10,"input",10),p(11,Ei,2,1,"div",11),i(),r(12,"div",7),d(13,"my-input-text",12),i(),d(14,"input",13),i()),n&2&&(c("ngIf",o.error),a(),c("ngIf",o.success),a(),c("ngIf",o.user.pendingEmail),a(),c("formGroup",o.form),a(6),ae(o.user.email),se(8),a(),c("ngClass",Se(9,gi,o.formErrors["new-email"])),a(),c("ngIf",o.formErrors["new-email"]),a(2),c("formError",o.formErrors.password),a(),c("disabled",!o.form.valid));},dependencies:[b,X,J,gt,G,Z,ne,ee,te,Ye,Oe],styles:["form[_ngcontent-%COMP%]{max-width:340px}my-input-text[_ngcontent-%COMP%]{display:block;width:100%}input[type=email][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:100%;max-width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=email][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=email][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: calc(100% + 40px)){input[type=email][_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}.pending-email[_ngcontent-%COMP%]{margin-bottom:15px}"]}));var Ht=He;function Pi(_,t){_&1&&(O(0),l(1,0),N());}function Ii(_,t){_&1&&(O(0),l(1,1),N());}var Ke=class Ke extends Ne{constructor(e,n,o){super();this.formReactiveService=e;this.userService=n;this.notifier=o;s(this,"user");}ngOnInit(){this.buildForm({"email-public":null}),this.form.patchValue({"email-public":this.user.emailPublic});}updateEmailPublic(){let e={emailPublic:this.form.value["email-public"]};this.userService.updateMyProfile(e).subscribe({next:()=>{e.emailPublic?this.notifier.success("L'e-mail est d\xE9sormais public"):this.notifier.success("L'e-mail est d\xE9sormais priv\xE9"),this.user.emailPublic=e.emailPublic;},error:n=>this.notifier.error(n.message)});}};s(Ke,"\u0275fac",function(n){return new(n||Ke)(m(oe),m(V),m($));}),s(Ke,"\u0275cmp",A({type:Ke,selectors:[["my-account-email-preferences"]],inputs:{user:"user"},standalone:!0,features:[H,S],decls:8,vars:3,consts:()=>{let e;e="Autoriser l'affichage public des emails";let n;n="Sauvegarder les param\xE8tres du courriel";let o;o="N\xE9cessaire pour demander les flux RSS des podcasts.";let C;return C="\u26A0\uFE0F Votre courriel ne peut pas \xEAtre utilis\xE9 dans les flux RSS des podcasts car il n'a pas encore \xE9t\xE9 v\xE9rifi\xE9.",[o,C,["role","form",3,"ngSubmit","formGroup"],[1,"form-group"],["inputName","email-public","formControlName","email-public","labelText",e],["ngProjectAs","description",5,["description"]],[1,"mb-0"],["type","submit","value",n,1,"peertube-button","orange-button",3,"disabled"]];},template:function(n,o){n&1&&(r(0,"form",2),M("ngSubmit",function(){return o.updateEmailPublic();}),r(1,"div",3)(2,"my-peertube-checkbox",4),O(3,5),r(4,"p",6),p(5,Pi,2,0,"ng-container")(6,Ii,2,0,"ng-container"),i(),N(),i()(),d(7,"input",7),i()),n&2&&(c("formGroup",o.form),a(5),me(o.user.emailVerified?5:6),a(2),c("disabled",!o.form.valid));},dependencies:[X,J,G,Z,ne,ee,te,Le]}));var jt=Ke;var vi=()=>["/my-account/two-factor-auth"];function yi(_,t){_&1&&(O(0),r(1,"p"),l(2,0),i(),r(3,"my-button",5),l(4,1),i(),N()),_&2&&(a(3),c("ptRouterLink",In(1,vi)));}function hi(_,t){if(_&1){let e=h();O(0),r(1,"my-button",6),M("click",function(){f(e);let o=T();return E(o.disableTwoFactor());}),l(2,2),i(),N();}}var je=class je{constructor(t,e,n,o){this.notifier=t;this.twoFactorService=e;this.confirmService=n;this.auth=o;s(this,"user");s(this,"twoFactorEnabled",!1);}ngOnInit(){this.twoFactorEnabled=this.user.twoFactorEnabled;}disableTwoFactor(){return Re(this,null,function*(){let t="\xCAtes-vous certain de vouloir d\xE9sactiver l'authentification \xE0 deux facteurs sur votre compte utilisateur ?",{confirmed:e,password:n}=yield this.confirmService.confirmWithPassword({message:t,title:"D\xE9sactiver le double facteur"});e!==!1&&this.twoFactorService.disableTwoFactor({userId:this.user.id,currentPassword:n}).subscribe({next:()=>{this.twoFactorEnabled=!1,this.auth.refreshUserInformation(),this.notifier.success("Authentification \xE0 deux facteurs d\xE9sactiv\xE9");},error:o=>this.notifier.error(o.message)});});}};s(je,"\u0275fac",function(e){return new(e||je)(m($),m(Fe),m(we),m(F));}),s(je,"\u0275cmp",A({type:je,selectors:[["my-account-two-factor-button"]],inputs:{user:"user"},standalone:!0,features:[S],decls:3,vars:2,consts:()=>{let t;t="L'authentification \xE0 deux facteurs ajoute un niveau de s\xE9curit\xE9 suppl\xE9mentaire lors de la connexion \xE0 votre compte, en n\xE9cessitant un code num\xE9rique g\xE9n\xE9r\xE9 par un autre appareil (en g\xE9n\xE9ral votre smartphone).";let e;e="Activer l'authentification \xE0 deux facteurs";let n;return n="D\xE9sactiver l'authentification \xE0 deux facteurs",[t,e,n,[1,"two-factor"],[4,"ngIf"],["theme","orange",3,"ptRouterLink"],["theme","orange",3,"click"]];},template:function(e,n){e&1&&(r(0,"div",3),p(1,yi,5,2,"ng-container",4)(2,hi,3,0,"ng-container",4),i()),e&2&&(a(),c("ngIf",!n.twoFactorEnabled),a(),c("ngIf",n.twoFactorEnabled));},dependencies:[b,so],encapsulation:2}));var qt=je;function Ui(_,t){if(_&1&&(r(0,"div",8),I(1),i()),_&2){let e=T();a(),Y(e.error);}}var qe=class qe extends Ne{constructor(e,n,o,C){super();this.formReactiveService=e;this.notifier=n;this.authService=o;this.userService=C;s(this,"error");s(this,"user");}ngOnInit(){this.buildForm({"current-password":It,"new-password":Rt,"new-confirmed-password":no}),this.user=this.authService.getUser();let e=this.form.get("new-confirmed-password");e.valueChanges.pipe(On(n=>n!==this.form.value["new-password"])).subscribe(()=>e.setErrors({matchPassword:!0}));}changePassword(){let e=this.form.value["current-password"],n=this.form.value["new-password"];this.userService.changePassword(e,n).subscribe({next:()=>{this.notifier.success("Mot de passe mis \xE0 jour."),this.form.reset(),this.error=null;},error:o=>{if(o.status===de.UNAUTHORIZED_401){this.error="Votre mot de passe actuel est invalide.";return;}this.error=o.message;}});}};s(qe,"\u0275fac",function(n){return new(n||qe)(m(oe),m($),m(F),m(V));}),s(qe,"\u0275cmp",A({type:qe,selectors:[["my-account-change-password"]],standalone:!0,features:[H,S],decls:8,vars:6,consts:()=>{let e;e="Mot de passe actuel";let n;n="Nouveau mot de passe";let o;o="Confirmer le mot de passe";let C;C="Changer le mot de passe";let u;return u="Changer le mot de passe",[u,["class","alert alert-danger",4,"ngIf"],["role","form",3,"ngSubmit","formGroup"],["for","current-password"],["formControlName","current-password","inputId","current-password","placeholder",e,"autocomplete","current-password",3,"formError"],["formControlName","new-password","inputId","new-password","placeholder",n,"autocomplete","new-password",3,"formError"],["formControlName","new-confirmed-password","inputId","new-confirmed-password","placeholder",o,"autocomplete","new-password",3,"formError"],["type","submit","value",C,3,"disabled"],[1,"alert","alert-danger"]];},template:function(n,o){n&1&&(p(0,Ui,2,1,"div",1),r(1,"form",2),M("ngSubmit",function(){return o.changePassword();}),r(2,"label",3),l(3,0),i(),d(4,"my-input-text",4)(5,"my-input-text",5)(6,"my-input-text",6)(7,"input",7),i()),n&2&&(c("ngIf",o.error),a(),c("formGroup",o.form),a(3),c("formError",o.formErrors["current-password"]),a(),c("formError",o.formErrors["new-password"]),a(),c("formError",o.formErrors["new-confirmed-password"]),a(),c("disabled",!o.form.valid));},dependencies:[b,X,J,G,Z,ne,ee,te,Oe],styles:["form[_ngcontent-%COMP%]{max-width:340px}my-input-text[_ngcontent-%COMP%]{display:block;width:100%}my-input-text[_ngcontent-%COMP%] + my-input-text[_ngcontent-%COMP%]{margin-top:15px}input[type=submit][_ngcontent-%COMP%]{margin-top:15px;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}"]}));var Qt=qe;function bi(_,t){_&1&&(r(0,"div"),l(1,2),i());}function Yi(_,t){if(_&1){let e=h();r(0,"div")(1,"my-input-switch",8),Ce("ngModelChange",function(o){f(e);let C=T(2).$implicit,u=T(4);return ce(u.emailNotifications[C],o)||(u.emailNotifications[C]=o),E(o);}),M("ngModelChange",function(){f(e);let o=T(2).$implicit,C=T(4);return E(C.updateEmailSetting(o,C.emailNotifications[o]));}),i()();}if(_&2){let e=T(2).$implicit,n=T(4);a(),c("label",n.getEmailLabel(e))("inputName","email-notification-"+e),le("ngModel",n.emailNotifications[e]);}}function $i(_,t){if(_&1){let e=h();r(0,"div",7)(1,"div"),I(2),i(),r(3,"div")(4,"my-input-switch",8),Ce("ngModelChange",function(o){f(e);let C=T().$implicit,u=T(4);return ce(u.webNotifications[C],o)||(u.webNotifications[C]=o),E(o);}),M("ngModelChange",function(){f(e);let o=T().$implicit,C=T(4);return E(C.updateWebSetting(o,C.webNotifications[o]));}),i()(),p(5,Yi,2,3,"div",3),i();}if(_&2){let e=T().$implicit,n=T(4);a(2),Y(n.labelNotifications[e]),a(2),c("label",n.getWebLabel(e))("inputName","web-notification-"+e),le("ngModel",n.webNotifications[e]),a(),c("ngIf",n.emailEnabled);}}function wi(_,t){if(_&1&&(O(0),p(1,$i,6,5,"div",6),N()),_&2){let e=t.$implicit,n=T(4);a(),c("ngIf",n.hasUserRight(e));}}function Li(_,t){if(_&1&&(O(0),r(1,"div",5)(2,"div"),l(3,0),i(),r(4,"div"),l(5,1),i(),p(6,bi,2,0,"div",3),i(),p(7,wi,2,1,"ng-container",4),N()),_&2){let e=T().$implicit,n=T(2);a(3),ae(e.label),se(3),a(3),c("ngIf",n.emailEnabled),a(),c("ngForOf",e.keys);}}function Fi(_,t){if(_&1&&(O(0),p(1,Li,8,3,"ng-container",3),N()),_&2){let e=t.$implicit,n=T(2);a(),c("ngIf",n.hasNotificationsInGroup(e));}}function xi(_,t){if(_&1&&(r(0,"div"),p(1,Fi,2,1,"ng-container",4),i()),_&2){let e=T();a(),c("ngForOf",e.notificationSettingGroups);}}var Qe=class Qe{constructor(t,e,n){this.userNotificationService=t;this.serverService=e;this.notifier=n;s(this,"user");s(this,"notificationSettingGroups",[]);s(this,"emailNotifications",{});s(this,"webNotifications",{});s(this,"labelNotifications",{});s(this,"rightNotifications",{});s(this,"emailEnabled",!1);s(this,"savePreferences",Gn(this.savePreferencesImpl.bind(this),500));this.labelNotifications={newVideoFromSubscription:"Nouvelle vid\xE9o ou direct de vos abonnements",newCommentOnMyVideo:"Nouveau commentaire sur votre vid\xE9o",abuseAsModerator:"Nouveau signalement",videoAutoBlacklistAsModerator:"Une vid\xE9o bloqu\xE9e automatiquement est en attente de r\xE9vision",blacklistOnMyVideo:"Une de vos vid\xE9os est bloqu\xE9e/d\xE9bloqu\xE9e",myVideoPublished:"Vid\xE9o publi\xE9e (apr\xE8s encodage / mise \xE0 jour programm\xE9e)",myVideoImportFinished:"Import de vid\xE9o termin\xE9",newUserRegistration:"Nouveau compte cr\xE9\xE9 sur votre instance",newFollow:"Vous ou une de vos cha\xEEnes a un\xB7e nouvel\xB7le abonn\xE9\xB7e",commentMention:"Quelqu'un vous a mentionn\xE9 dans les commentaires d'une vid\xE9o",newInstanceFollower:"Votre instance a un nouvel abonn\xE9",autoInstanceFollowing:"Votre instance a automatiquement suivi une autre instance",abuseNewMessage:"Un signalement d'abus a re\xE7u un nouveau message",abuseStateChange:"Un de vos rapports d'abus a \xE9t\xE9 accept\xE9 ou rejet\xE9 par les mod\xE9rateur\xB7ices",newPeerTubeVersion:"Une nouvelle version de PeerTube et disponible",newPluginVersion:"Une nouvelle version d'un de vos plugins/th\xE8mes est disponible",myVideoStudioEditionFinished:"L'\xE9dition par le studio vid\xE9o est termin\xE9",myVideoTranscriptionGenerated:"The transcription of your video has been generated"},this.notificationSettingGroups=[{label:"Social",keys:["newVideoFromSubscription","newFollow","commentMention"]},{label:"Vos vid\xE9os",keys:["newCommentOnMyVideo","blacklistOnMyVideo","myVideoPublished","myVideoImportFinished","myVideoStudioEditionFinished","myVideoTranscriptionGenerated"]},{label:"Mod\xE9ration",keys:["abuseStateChange","abuseNewMessage","abuseAsModerator","videoAutoBlacklistAsModerator","newUserRegistration"]},{label:"Administration",keys:["newInstanceFollower","autoInstanceFollowing","newPeerTubeVersion","newPluginVersion"]}],this.rightNotifications={abuseAsModerator:Me.MANAGE_ABUSES,videoAutoBlacklistAsModerator:Me.MANAGE_VIDEO_BLACKLIST,newUserRegistration:Me.MANAGE_USERS,newInstanceFollower:Me.MANAGE_SERVER_FOLLOW,autoInstanceFollowing:Me.MANAGE_CONFIGURATION,newPeerTubeVersion:Me.MANAGE_DEBUG,newPluginVersion:Me.MANAGE_DEBUG};}ngOnInit(){let t=this.serverService.getHTMLConfig();this.emailEnabled=t.email.enabled,this.loadNotificationSettings();}hasUserRight(t){let e=this.rightNotifications[t];return e?this.user.hasRight(e):!0;}hasNotificationsInGroup(t){return t.keys.some(e=>this.hasUserRight(e));}getWebLabel(t){return`Toggle web notification for "${this.labelNotifications[t]}"`;}getEmailLabel(t){return`Toggle email notification for "${this.labelNotifications[t]}"`;}updateEmailSetting(t,e){e===!0?this.user.notificationSettings[t]|=fe.EMAIL:this.user.notificationSettings[t]&=~fe.EMAIL,this.savePreferences();}updateWebSetting(t,e){e===!0?this.user.notificationSettings[t]|=fe.WEB:this.user.notificationSettings[t]&=~fe.WEB,this.savePreferences();}savePreferencesImpl(){this.userNotificationService.updateNotificationSettings(this.user.notificationSettings).subscribe({next:()=>{this.notifier.success("Pr\xE9f\xE9rences sauvegard\xE9es",void 0,2e3);},error:t=>this.notifier.error(t.message)});}loadNotificationSettings(){for(let t of Ln(this.user.notificationSettings)){let e=this.user.notificationSettings[t];this.emailNotifications[t]=!!(e&fe.EMAIL),this.webNotifications[t]=!!(e&fe.WEB);}}};s(Qe,"\u0275fac",function(e){return new(e||Qe)(m(Zn),m(ie),m($));}),s(Qe,"\u0275cmp",A({type:Qe,selectors:[["my-account-notification-preferences"]],inputs:{user:"user"},standalone:!0,features:[S],decls:1,vars:1,consts:()=>{let t;t=""+"\uFFFD0\uFFFD"+"";let e;e="Web";let n;return n="Courriel",[t,e,n,[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"header","notification-row"],["class","small notification-row",4,"ngIf"],[1,"small","notification-row"],[3,"ngModelChange","label","inputName","ngModel"]];},template:function(e,n){e&1&&p(0,xi,2,1,"div",3),e&2&&c("ngIf",n.webNotifications);},dependencies:[b,Mt,jn,X,G,pe],styles:[".notification-row[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid rgba(0,0,0,.1)}.notification-row.header[_ngcontent-%COMP%]{font-weight:600;margin-top:10px}.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:10px}.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:350px}@media screen and (max-width: breakpoint(sm)){.notification-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:auto;flex-grow:1}}"]}));var Zt=Qe;var Uo=_=>({"input-error":_});function Gi(_,t){if(_&1&&(r(0,"div",16),I(1),i()),_&2){let e=T();a(),Y(e.error);}}function Xi(_,t){if(_&1&&(r(0,"div",17),I(1),i()),_&2){let e=T();a(),K(" ",e.formErrors["display-name"]," ");}}function ki(_,t){if(_&1&&(r(0,"div",17),I(1),i()),_&2){let e=T();a(),K(" ",e.formErrors.description," ");}}var Ze=class Ze extends Ne{constructor(e,n,o){super();this.formReactiveService=e;this.notifier=n;this.userService=o;s(this,"user",null);s(this,"error",null);}ngOnInit(){this.buildForm({username:null,"display-name":oo,description:io}),this.form.controls.username.disable(),this.form.patchValue({username:this.user.username,"display-name":this.user.account.displayName,description:this.user.account.description});}get instanceHost(){return window.location.host;}updateMyProfile(){let e=this.form.value["display-name"],n=this.form.value.description||null;this.error=null,this.userService.updateMyProfile({displayName:e,description:n}).subscribe({next:()=>{this.user.account.displayName=e,this.user.account.description=n,this.notifier.success("Profil mis \xE0 jour.");},error:o=>this.error=o.message});}};s(Ze,"\u0275fac",function(n){return new(n||Ze)(m(oe),m($),m(V));}),s(Ze,"\u0275cmp",A({type:Ze,selectors:[["my-account-profile"]],inputs:{user:"user"},standalone:!0,features:[H,S],decls:19,vars:13,consts:()=>{let e;e="Sauvegarder le profil";let n;n="Identifiant";let o;o="Les gens peuvent vous trouver en utilisant @"+"\uFFFD0\uFFFD"+"@"+"\uFFFD1\uFFFD"+" ";let C;C="Nom affich\xE9";let u;return u="Description",[n,o,C,u,["class","alert alert-danger",4,"ngIf"],["role","form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username","readonly","",1,"form-control"],[1,"form-group-description"],["for","display-name"],["type","text","id","display-name","formControlName","display-name",1,"form-control",3,"ngClass"],["class","form-error","role","alert",4,"ngIf"],["for","description"],["id","description","formControlName","description",1,"form-control",3,"ngClass"],["type","submit","value",e,3,"disabled"],[1,"alert","alert-danger"],["role","alert",1,"form-error"]];},template:function(n,o){n&1&&(p(0,Gi,2,1,"div",4),r(1,"form",5),M("ngSubmit",function(){return o.updateMyProfile();}),r(2,"div",6)(3,"label",7),l(4,0),i(),d(5,"input",8),r(6,"div",9),l(7,1),i()(),r(8,"div",6)(9,"label",10),l(10,2),i(),d(11,"input",11),p(12,Xi,2,1,"div",12),i(),r(13,"div",6)(14,"label",13),l(15,3),i(),d(16,"textarea",14),p(17,ki,2,1,"div",12),i(),d(18,"input",15),i()),n&2&&(c("ngIf",o.error),a(),c("formGroup",o.form),a(6),ae(o.user.username)(o.instanceHost),se(7),a(4),c("ngClass",Se(9,Uo,o.formErrors["display-name"])),a(),c("ngIf",o.formErrors["display-name"]),a(4),c("ngClass",Se(11,Uo,o.formErrors.description)),a(),c("ngIf",o.formErrors.description),a(),c("disabled",!o.form.valid));},dependencies:[b,X,J,gt,G,Z,ne,ee,te,Ye],styles:["input#username[_ngcontent-%COMP%] + .muted[_ngcontent-%COMP%]{margin-top:5px}input[type=text][_ngcontent-%COMP%]{font-size:15px;padding:3px 15px;width:340px;max-width:340px;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}input[type=text][_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}input[type=text][readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: 380px){input[type=text][_ngcontent-%COMP%]{width:100%}}input[type=submit][_ngcontent-%COMP%]{margin-top:15px;padding:4px 13px;border:0;font-weight:600;border-radius:3px!important;text-align:center;cursor:pointer;font-size:15px;line-height:23px}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-inline-end:.25rem;margin-inline-start:.25rem}input[type=submit][_ngcontent-%COMP%]:focus, input[type=submit][_ngcontent-%COMP%]:focus-visible{box-shadow:0 0 0 .2rem var(--mainColorLightest)}input[type=submit][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--mainColor)}input[type=submit][_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--mainHoverColor)}input[type=submit][disabled][_ngcontent-%COMP%], input[type=submit].disabled[_ngcontent-%COMP%]{cursor:default;color:#fff;background-color:var(--inputBorderColor)}input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, input[type=submit][_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:#fff}textarea[_ngcontent-%COMP%]{display:block;color:var(--textareaForegroundColor)!important;background-color:var(--textareaBackgroundColor)!important;height:150px;font-size:15px;padding:3px 15px;width:100%;max-width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid var(--inputBorderColor);border-radius:3px;line-height:23px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width: calc(100% + 40px)){textarea[_ngcontent-%COMP%]{width:100%}}"]}));var Jt=Ze;function Di(_,t){if(_&1){let e=h();r(0,"my-actor-avatar-edit",21),M("avatarChange",function(o){f(e);let C=T();return E(C.onAvatarChange(o));})("avatarDelete",function(){f(e);let o=T();return E(o.onAvatarDelete());}),i();}if(_&2){let e=T();c("avatars",e.user.account.avatars)("displayName",e.user.account.displayName)("username",e.user.username)("subscribers",e.user.account.followersCount);}}function zi(_,t){_&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),l(3,6),i()(),r(4,"div",12),d(5,"my-account-change-password"),i()());}function Bi(_,t){if(_&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),l(3,7),i()(),r(4,"div",12),d(5,"my-account-two-factor-button",14),i()()),_&2){let e=T();a(5),c("user",e.user);}}function Vi(_,t){if(_&1&&(r(0,"div",15)(1,"div",11)(2,"h2"),l(3,8),i()(),r(4,"div",12),d(5,"my-account-email-preferences",22)(6,"my-account-change-email"),i()()),_&2){let e=T();a(5),c("user",e.user);}}var Je=class Je{constructor(t,e,n,o){this.viewportScroller=t;this.userService=e;this.authService=n;this.notifier=o;s(this,"user");s(this,"lastScrollHash");}get userInformationLoaded(){return this.authService.userInformationLoaded;}ngOnInit(){this.user=this.authService.getUser();}ngAfterViewChecked(){window.location.hash&&window.location.hash!==this.lastScrollHash&&(this.viewportScroller.scrollToAnchor(window.location.hash.replace("#","")),this.lastScrollHash=window.location.hash);}onAvatarChange(t){this.userService.changeAvatar(t).subscribe({next:e=>{this.notifier.success("Avatar modifi\xE9."),this.user.updateAccountAvatar(e.avatars),this.user.account=an(this.user.account);},error:e=>Et({err:e,name:"avatar",notifier:this.notifier})});}onAvatarDelete(){this.userService.deleteAvatar().subscribe({next:()=>{this.notifier.success("Avatar supprim\xE9."),this.user.updateAccountAvatar(),this.user.account=an(this.user.account);},error:t=>this.notifier.error(t.message)});}};s(Je,"\u0275fac",function(e){return new(e||Je)(m(vn),m(V),m(F),m($));}),s(Je,"\u0275cmp",A({type:Je,selectors:[["my-account-settings"]],standalone:!0,features:[S],decls:39,vars:11,consts:()=>{let t;t="Param\xE8tres";let e;e="PARAM\xC8TRES DU PROFIL";let n;n="INTERFACE";let o;o="PARAM\xC8TRES DES VID\xC9OS";let C;C="NOTIFICATIONS";let u;u="ZONE\xA0DE\xA0DANGER";let g;g="MOT DE PASSE";let P;P="Authentification \xE0 deux facteurs";let k;return k="COURRIEL",[t,e,n,o,C,u,g,P,k,[1,"visually-hidden"],[1,"pt-two-cols","mt-3"],[1,"title-col"],[1,"content-col"],["class","d-block mb-3","actorType","account",3,"avatars","displayName","username","subscribers","avatarChange","avatarDelete",4,"ngIf"],[3,"user"],[1,"pt-two-cols","mt-5"],[3,"user","userInformationLoaded"],["id","video-settings",1,"anchor"],["id","notifications",1,"anchor"],["class","pt-two-cols mt-5",4,"ngIf"],[1,"pt-title-danger"],["actorType","account",1,"d-block","mb-3",3,"avatarChange","avatarDelete","avatars","displayName","username","subscribers"],[1,"d-block","mb-5",3,"user"]];},template:function(e,n){e&1&&(r(0,"h1",9),l(1,0),i(),r(2,"div",10)(3,"div",11)(4,"h2"),l(5,1),i()(),r(6,"div",12),p(7,Di,1,4,"my-actor-avatar-edit",13),d(8,"my-user-quota")(9,"my-account-profile",14),i()(),r(10,"div",15)(11,"div",11)(12,"h2"),l(13,2),i()(),r(14,"div",12),d(15,"my-user-interface-settings",16),i()(),r(16,"div",15)(17,"div",11),d(18,"div",17),r(19,"h2"),l(20,3),i()(),r(21,"div",12),d(22,"my-user-video-settings",16),i()(),r(23,"div",15)(24,"div",11),d(25,"div",18),r(26,"h2"),l(27,4),i()(),r(28,"div",12),d(29,"my-account-notification-preferences",14),i()(),p(30,zi,6,0,"div",19)(31,Bi,6,1,"div",19)(32,Vi,7,1,"div",19),r(33,"div",15)(34,"div",11)(35,"h2",20),l(36,5),i()(),r(37,"div",12),d(38,"my-account-danger-zone",14),i()()),e&2&&(a(7),c("ngIf",n.user==null?null:n.user.account),a(2),c("user",n.user),a(6),c("user",n.user)("userInformationLoaded",n.userInformationLoaded),a(7),c("user",n.user)("userInformationLoaded",n.userInformationLoaded),a(7),c("user",n.user),a(),c("ngIf",n.user.pluginAuth===null),a(),c("ngIf",n.user.pluginAuth===null),a(),c("ngIf",n.user.pluginAuth===null),a(6),c("user",n.user));},dependencies:[co,Io,Jt,qn,Qn,Zt,b,Qt,qt,jt,Ht,Wt],styles:[".content-col[_ngcontent-%COMP%]{max-width:500px}"]}));var en=Je;function Wi(_,t){_&1&&(r(0,"div",11),l(1,1),i());}function Hi(_,t){if(_&1){let e=h();O(0),r(1,"form",14),M("ngSubmit",function(){f(e);let o=T(2);return E(o.requestTwoFactor());}),r(2,"label",15),l(3,2),i(),r(4,"div",16),l(5,3),i(),d(6,"my-input-text",17)(7,"input",18),i(),N();}if(_&2){let e=T(2);a(),c("formGroup",e.formPassword),a(5),c("formError",e.formErrorsPassword["current-password"]),a(),c("disabled",!e.formPassword.valid);}}function Ki(_,t){if(_&1){let e=h();O(0),r(1,"p"),l(2,4),i(),d(3,"qrcode",19),r(4,"div"),l(5,5),i(),r(6,"div",20),I(7),i(),r(8,"form",21),M("ngSubmit",function(){f(e);let o=T(2);return E(o.confirmTwoFactor());}),r(9,"label",22),l(10,6),i(),r(11,"div",16),l(12,7),i(),d(13,"my-input-text",23)(14,"input",24),i(),N();}if(_&2){let e=T(2);a(3),c("qrdata",e.twoFactorURI)("width",256),a(4),Y(e.twoFactorSecret),a(),c("formGroup",e.formOTP),a(5),c("show",!0)("formError",e.formErrorsOTP["otp-token"]),a(),c("disabled",!e.formOTP.valid);}}function ji(_,t){if(_&1&&(r(0,"div",12),p(1,Hi,8,3,"ng-container",13)(2,Ki,15,7,"ng-container",13),i()),_&2){let e=T();a(),c("ngIf",e.step==="request"),a(),c("ngIf",e.step==="confirm");}}var et=class et{constructor(t,e,n,o,C){this.notifier=t;this.twoFactorService=e;this.formReactiveService=n;this.auth=o;this.router=C;s(this,"twoFactorAlreadyEnabled");s(this,"step","request");s(this,"twoFactorSecret");s(this,"twoFactorURI");s(this,"inPasswordStep",!0);s(this,"formPassword");s(this,"formErrorsPassword");s(this,"formOTP");s(this,"formErrorsOTP");s(this,"user");s(this,"requestToken");}ngOnInit(){this.buildPasswordForm(),this.buildOTPForm(),this.user=this.auth.getUser(),this.twoFactorAlreadyEnabled=this.user.twoFactorEnabled;}requestTwoFactor(){this.twoFactorService.requestTwoFactor({userId:this.user.id,currentPassword:this.formPassword.value["current-password"]}).subscribe({next:({otpRequest:t})=>{this.requestToken=t.requestToken,this.twoFactorURI=t.uri,this.twoFactorSecret=t.secret.replace(/(.{4})/g,"$1 ").trim(),this.step="confirm";},error:t=>this.notifier.error(t.message)});}confirmTwoFactor(){this.twoFactorService.confirmTwoFactorRequest({userId:this.user.id,requestToken:this.requestToken,otpToken:this.formOTP.value["otp-token"]}).subscribe({next:()=>{this.notifier.success("L'authentification \xE0 deux facteurs a \xE9t\xE9 activ\xE9."),this.auth.refreshUserInformation(),this.router.navigateByUrl("/my-account/settings");},error:t=>this.notifier.error(t.message)});}buildPasswordForm(){let{form:t,formErrors:e}=this.formReactiveService.buildForm({"current-password":It});this.formPassword=t,this.formErrorsPassword=e;}buildOTPForm(){let{form:t,formErrors:e}=this.formReactiveService.buildForm({"otp-token":to});this.formOTP=t,this.formErrorsOTP=e;}};s(et,"\u0275fac",function(e){return new(e||et)(m($),m(Fe),m(oe),m(F),m(hn));}),s(et,"\u0275cmp",A({type:et,selectors:[["my-account-two-factor"]],standalone:!0,features:[S],decls:6,vars:2,consts:()=>{let t;t="Authentification \xE0 deux facteurs";let e;e="Authentification \xE0 deux facteurs d\xE9j\xE0 activ\xE9.";let n;n="Mot de passe actuel";let o;o="Confirmer";let C;C="Votre mot de passe";let u;u="Confirmez votre mot de passe pour activer l'authentification \xE0 deux facteurs.";let g;g="Confirmer";let P;P="Scannez ce QR code avec votre application TOTP (mot de passe unique). Votre application g\xE9n\xE9rera ensuite un code num\xE9rique \xE0 indiquer lors de la connexion \xE0 votre compte.";let k;k="Si vous ne pouvez pas scanner le QR code, voici le secret \xE0 retranscrire manuellement :";let v;v="Mot de passe \xE0 usage unique";let j;return j="Pour confirmer, entrez le mot de passe \xE0 usage unique g\xE9n\xE9r\xE9 par votre application d'authentification",[t,e,C,u,P,k,v,j,["iconName","cog","aria-hidden","true"],["class","root already-enabled",4,"ngIf"],["class","root",4,"ngIf"],[1,"root","already-enabled"],[1,"root"],[4,"ngIf"],["role","form",3,"ngSubmit","formGroup"],["for","current-password"],[1,"form-group-description"],["formControlName","current-password","inputId","current-password","placeholder",n,"autocomplete","current-password",3,"formError"],["type","submit","value",o,1,"peertube-button","orange-button","mt-3",3,"disabled"],["level","Q",3,"qrdata","width"],[1,"secret-plain-text"],["role","form",1,"mt-3",3,"ngSubmit","formGroup"],["for","otp-token"],["formControlName","otp-token","inputId","otp-token","autocomplete","otp-token",3,"show","formError"],["type","submit","value",g,1,"peertube-button","orange-button","mt-3",3,"disabled"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",8),O(2),l(3,0),N(),i(),p(4,Wi,2,0,"div",9)(5,ji,3,2,"div",10)),e&2&&(a(4),c("ngIf",n.twoFactorAlreadyEnabled===!0),a(),c("ngIf",n.twoFactorAlreadyEnabled===!1));},dependencies:[w,b,X,J,G,Z,ne,ee,te,Oe,vo,Ro],styles:[".root[_ngcontent-%COMP%]{max-width:600px}.secret-plain-text[_ngcontent-%COMP%]{font-family:monospace;font-size:.9rem}qrcode[_ngcontent-%COMP%]{display:inline-block;margin:auto}"]}));var tn=et;var tt=class tt{};s(tt,"\u0275fac",function(e){return new(e||tt)();}),s(tt,"\u0275cmp",A({type:tt,selectors:[["ng-component"]],standalone:!0,features:[S],decls:10,vars:0,consts:()=>{let t;t="Your watched words lists";let e;e="Comments that contain any of the watched words are automatically tagged with the name of the list.";let n;return n="These automatic tags can be used to filter comments or "+"\uFFFD#8\uFFFD"+"automatically block"+"\uFFFD/#8\uFFFD"+" them.",[t,e,n,["iconName","no","aria-hidden","true"],[1,"d-block"],[1,"d-block","mb-3"],["routerLink","/my-account/auto-tag-policies"],["mode","user"]];},template:function(e,n){e&1&&(r(0,"h1"),d(1,"my-global-icon",3),O(2),l(3,0),N(),i(),r(4,"em",4),l(5,1),i(),r(6,"em",5),z(7,2),d(8,"a",6),B(),i(),d(9,"my-watched-words-list-admin-owner",7));},dependencies:[w,Oo,Nt],encapsulation:2}));var nn=tt;var qi=_=>({"sub-menu-offset-content":_}),nt=class nt{constructor(t,e){this.pluginService=t;this.screenService=e;s(this,"menuEntries",[]);s(this,"user");}get isBroadcastMessageDisplayed(){return this.screenService.isBroadcastMessageDisplayed;}ngOnInit(){this.pluginService.ensurePluginsAreLoaded("my-account").then(()=>this.buildMenu());}buildMenu(){let t=this.pluginService.getAllRegisteredClientRoutesForParent("/my-account")||{};this.menuEntries=[{label:"Param\xE8tres",routerLink:"/my-account/settings"},{label:"Notifications",routerLink:"/my-account/notifications"},{label:"Import/Export",routerLink:"/my-account/import-export"},{label:"Les applications",routerLink:"/my-account/applications"},{label:"Mod\xE9ration",children:[{label:"Comptes silenc\xE9s",routerLink:"/my-account/blocklist/accounts",iconName:"user-x"},{label:"Serveurs ignor\xE9s",routerLink:"/my-account/blocklist/servers",iconName:"peertube-x"},{label:"Rapports des abus",routerLink:"/my-account/abuses",iconName:"flag"},{label:"Comments on your videos",routerLink:"/my-account/videos/comments",iconName:"message-circle"},{label:"Watched words",routerLink:"/my-account/watched-words/list",iconName:"eye-open"},{label:"Auto tag policies",routerLink:"/my-account/auto-tag-policies",iconName:"no"}]},...Object.values(t).map(e=>{var n;return{label:(n=e.menuItem)==null?void 0:n.label,routerLink:"/my-account/p/"+e.route};})];}};s(nt,"\u0275fac",function(e){return new(e||nt)(m(Hn),m(Vn));}),s(nt,"\u0275cmp",A({type:nt,selectors:[["ng-component"]],standalone:!0,features:[S],decls:4,vars:4,consts:[[1,"root"],[3,"menuEntries"],[1,"margin-content","pb-5",3,"ngClass"]],template:function(e,n){e&1&&(r(0,"div",0),d(1,"my-top-menu-dropdown",1),r(2,"div",2),d(3,"router-outlet"),i()()),e&2&&(a(),c("menuEntries",n.menuEntries),a(),c("ngClass",Se(2,qi,!n.isBroadcastMessageDisplayed)));},dependencies:[No,Ye,yn],styles:[".root[_ngcontent-%COMP%]{flex-direction:column;width:100%}.root[_ngcontent-%COMP%]     h1{font-size:1.3rem;border-bottom:2px solid #E5E5E5;padding-bottom:15px;margin-bottom:30px}.root[_ngcontent-%COMP%]     h1>span>my-global-icon, .root[_ngcontent-%COMP%]     h1>my-global-icon{width:24px;height:24px;position:relative;top:-2px;margin-inline-end:.625rem}.root[_ngcontent-%COMP%]     h1 .pt-badge{vertical-align:top;margin-inline-start:.4375rem}.root[_ngcontent-%COMP%] > my-top-menu-dropdown[_ngcontent-%COMP%]:nth-child(1){flex-grow:1}"]}));var on=nt;var Hs=[{path:"",component:on,providers:[re,Fe,lo,ro,Co,_o,go,Mo],resolve:{user:yo},canActivateChild:[Bn],children:[{path:"",redirectTo:"settings",pathMatch:"full"},{path:"settings",component:en,data:{meta:{title:"Param\xE8tres du compte"}}},{path:"two-factor-auth",component:tn,data:{meta:{title:"Authentification \xE0 deux facteurs"}}},{path:"video-channels",redirectTo:"/my-library/video-channels",pathMatch:"full"},{path:"video-playlists",redirectTo:"/my-library/video-playlists",pathMatch:"full"},{path:"video-playlists/create",redirectTo:"/my-library/video-playlists/create",pathMatch:"full"},{path:"video-playlists/:videoPlaylistId",redirectTo:"/my-library/video-playlists/:videoPlaylistId",pathMatch:"full"},{path:"video-playlists/update/:videoPlaylistId",redirectTo:"/my-library/video-playlists/update/:videoPlaylistId",pathMatch:"full"},{path:"videos",redirectTo:"/my-library/videos",pathMatch:"full"},{path:"video-imports",redirectTo:"/my-library/video-imports",pathMatch:"full"},{path:"subscriptions",redirectTo:"/my-library/subscriptions",pathMatch:"full"},{path:"ownership",redirectTo:"/my-library/ownership",pathMatch:"full"},{path:"blocklist/accounts",component:Gt,data:{meta:{title:"Comptes silenc\xE9s"}}},{path:"blocklist/servers",component:Xt,data:{meta:{title:"Serveurs ignor\xE9s"}}},{path:"history/videos",redirectTo:"/my-library/history/videos",pathMatch:"full"},{path:"notifications",component:Vt,data:{meta:{title:"Notifications"}}},{path:"abuses",component:wt,data:{meta:{title:"Mes signalements"}}},{path:"applications",component:Lt,data:{meta:{title:"Les applications"}}},{path:"videos/comments",component:kt,data:{meta:{title:"Comments on your videos"}}},{path:"import-export",component:Bt,canDeactivate:[Dn],data:{meta:{title:"Import/Export"}}},{path:"watched-words/list",component:nn,data:{meta:{title:"Your watched words"}}},{path:"auto-tag-policies",component:xt,data:{meta:{title:"Your automatic tag policies"}}},{path:"p",children:[{path:"**",component:So,data:{parentRoute:"/my-account",pluginScope:"my-account"}}]}]}];export{Hs as default};/**i18n:2f710d33ac9c4f1483429afcadbb48fcf333aac524700807e70179670fe63b48*/